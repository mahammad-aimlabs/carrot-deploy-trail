const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BypnmEhC.js","./CHLuctl-.js","./Scfb2yZ2.js","./C2GHuDhf.js"])))=>i.map(i=>d[i]);
var pS=Object.defineProperty;var mS=(n,t,e)=>t in n?pS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var A=(n,t,e)=>mS(n,typeof t!="symbol"?t+"":t,e);import{i as gS,f as xS,d as ic,g as yS,n as bS,j as _S,k as wS,p as vS,w as SS,t as sc,e as AS,a as Mh}from"./DFC6otmp.js";import{n as CS,E as um,o as TS,aL as Nn,aC as MS,l as Qn,v as PS,aM as IS,Q as kS,X as Ad,aN as ES,aO as RS,O as Cd,aP as FS,aQ as BS,w as LS,g as OS,aR as DS,a7 as YS,y as NS,a8 as Td,a9 as Md,aa as US,aS as XS,aT as WS,aH as zS,aG as GS,p as nc,d as Pd,aF as VS,i as Un,G as Ph,a as rc,A as Ar,F as $S,f as HS,c as zn,r as Gn,s as Xn,t as Ih}from"./CAv8Xiel.js";import{a as Gs,i as qS,r as jS,_ as fm}from"./BnjIxzgJ.js";import{p as KS}from"./CBF_inHC.js";function kh(n,t,...e){var i=n,s=Nn,r;CS(()=>{s!==(s=t())&&(r&&(MS(r),r=null),r=TS(()=>s(i,...e)))},um),Qn&&(i=PS)}function dm(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(t=0;t<s;t++)n[t]&&(e=dm(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function ZS(){for(var n,t,e=0,i="",s=arguments.length;e<s;e++)(n=arguments[e])&&(t=dm(n))&&(i&&(i+=" "),i+=t);return i}function QS(n){return typeof n=="object"?ZS(n):n??""}const Id=[...` 	
\r\f \v\uFEFF`];function JS(n,t,e){var i=n==null?"":""+n;if(t&&(i=i?i+" "+t:t),e){for(var s in e)if(e[s])i=i?i+" "+s:s;else if(i.length)for(var r=s.length,o=0;(o=i.indexOf(s,o))>=0;){var l=o+r;(o===0||Id.includes(i[o-1]))&&(l===i.length||Id.includes(i[l]))?i=(o===0?"":i.substring(0,o))+i.substring(l+1):o=l}}return i===""?null:i}function Qa(n,t,e,i,s,r){var o=n.__className;if(Qn||o!==e){var l=JS(e,i,r);(!Qn||l!==n.getAttribute("class"))&&(l==null?n.removeAttribute("class"):t?n.className=l:n.setAttribute("class",l)),n.__className=e}else if(r)for(var u in r){var c=!!r[u];(s==null||c!==!!s[u])&&n.classList.toggle(u,c)}return r}const ka=Symbol("class");function tA(n){if(Qn){var t=!1,e=()=>{if(!t){if(t=!0,n.hasAttribute("value")){var i=n.value;Ds(n,"value",null),n.value=i}if(n.hasAttribute("checked")){var s=n.checked;Ds(n,"checked",null),n.checked=s}}};n.__on_r=e,ES(e),_S()}}function eA(n,t){var e=n.__attributes??(n.__attributes={});e.checked!==(e.checked=t??void 0)&&(n.checked=t)}function iA(n,t){t?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function Ds(n,t,e,i){var s=n.__attributes??(n.__attributes={});Qn&&(s[t]=n.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&n.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[IS]=e),e==null?n.removeAttribute(t):typeof e!="string"&&pm(n).includes(t)?n[t]=e:n.setAttribute(t,e))}function UI(n,t,e,i,s=!1,r=!1,o=!1){let l=Qn&&r;l&&Ad(!1);var u=t||{},c=n.tagName==="OPTION";for(var f in t)f in e||(e[f]=null);e.class?e.class=QS(e.class):e.class=null;var d=pm(n),g=n.__attributes??(n.__attributes={});for(const _ in e){let S=e[_];if(c&&_==="value"&&S==null){n.value=n.__value="",u[_]=S;continue}if(_==="class"){var p=n.namespaceURI==="http://www.w3.org/1999/xhtml";Qa(n,p,S,i,t==null?void 0:t[ka],e[ka]),u[_]=S,u[ka]=e[ka];continue}var x=u[_];if(S!==x){u[_]=S;var y=_[0]+_[1];if(y!=="$$"){if(y==="on"){const M={},T="$$"+_;let P=_.slice(2);var b=wS(P);if(gS(P)&&(P=P.slice(0,-7),M.capture=!0),!b&&x){if(S!=null)continue;n.removeEventListener(P,u[T],M),u[T]=null}if(S!=null)if(b)n[`__${P}`]=S,ic([P]);else{let B=function(O){u[_].call(this,O)};u[T]=xS(P,n,B,M)}else b&&(n[`__${P}`]=void 0)}else if(_==="style"&&S!=null)n.style.cssText=S+"";else if(_==="autofocus")yS(n,!!S);else if(!r&&(_==="__value"||_==="value"&&S!=null))n.value=n.__value=S;else if(_==="selected"&&c)iA(n,S);else{var v=_;s||(v=bS(v));var C=v==="defaultValue"||v==="defaultChecked";if(S==null&&!r&&!C)if(g[_]=null,v==="value"||v==="checked"){let M=n;const T=t===void 0;if(v==="value"){let P=M.defaultValue;M.removeAttribute(v),M.defaultValue=P,M.value=M.__value=T?P:null}else{let P=M.defaultChecked;M.removeAttribute(v),M.defaultChecked=P,M.checked=T?P:!1}}else n.removeAttribute(_);else C||d.includes(v)&&(r||typeof S!="string")?n[v]=S:typeof S!="function"&&Ds(n,v,S)}_==="style"&&"__styles"in n&&(n.__styles={})}}}return l&&Ad(!0),u}var kd=new Map;function pm(n){var t=kd.get(n.nodeName);if(t)return t;kd.set(n.nodeName,t=[]);for(var e,i=n,s=Element.prototype;s!==i;){e=RS(i);for(var r in e)e[r].set&&t.push(r);i=kS(i)}return t}const sA=()=>performance.now(),ys={tick:n=>requestAnimationFrame(n),now:()=>sA(),tasks:new Set};function mm(){const n=ys.now();ys.tasks.forEach(t=>{t.c(n)||(ys.tasks.delete(t),t.f())}),ys.tasks.size!==0&&ys.tick(mm)}function nA(n){let t;return ys.tasks.size===0&&ys.tick(mm),{promise:new Promise(e=>{ys.tasks.add(t={c:n,f:e})}),abort(){ys.tasks.delete(t)}}}function Ea(n,t){SS(()=>{n.dispatchEvent(new CustomEvent(t))})}function rA(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const t=n.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join("")}function Ed(n){const t={},e=n.split(";");for(const i of e){const[s,r]=i.split(":");if(!s||r===void 0)break;const o=rA(s.trim());t[o]=r.trim()}return t}const aA=n=>n;function oA(n,t,e,i){var s=(n&XS)!==0,r=(n&WS)!==0,o=s&&r,l=(n&DS)!==0,u=o?"both":s?"in":"out",c,f=t.inert,d=t.style.overflow,g,p;function x(){var _=US,S=Cd;Td(null),Md(null);try{return c??(c=e()(t,(i==null?void 0:i())??{},{direction:u}))}finally{Td(_),Md(S)}}var y={is_global:l,in(){var _;if(t.inert=f,!s){p==null||p.abort(),(_=p==null?void 0:p.reset)==null||_.call(p);return}r||g==null||g.abort(),Ea(t,"introstart"),g=Eh(t,x(),p,1,()=>{Ea(t,"introend"),g==null||g.abort(),g=c=void 0,t.style.overflow=d})},out(_){if(!r){_==null||_(),c=void 0;return}t.inert=!0,Ea(t,"outrostart"),p=Eh(t,x(),g,0,()=>{Ea(t,"outroend"),_==null||_()})},stop:()=>{g==null||g.abort(),p==null||p.abort()}},b=Cd;if((b.transitions??(b.transitions=[])).push(y),s&&vS){var v=l;if(!v){for(var C=b.parent;C&&(C.f&um)!==0;)for(;(C=C.parent)&&(C.f&FS)===0;);v=!C||(C.f&BS)!==0}v&&LS(()=>{OS(()=>y.in())})}}function Eh(n,t,e,i,s){var r=i===1;if(YS(t)){var o,l=!1;return NS(()=>{if(!l){var b=t({direction:r?"in":"out"});o=Eh(n,b,e,i,s)}}),{abort:()=>{l=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(e==null||e.deactivate(),!(t!=null&&t.duration))return s(),{abort:Nn,deactivate:Nn,reset:Nn,t:()=>i};const{delay:u=0,css:c,tick:f,easing:d=aA}=t;var g=[];if(r&&e===void 0&&(f&&f(0,1),c)){var p=Ed(c(0,1));g.push(p,p)}var x=()=>1-i,y=n.animate(g,{duration:u});return y.onfinish=()=>{var b=(e==null?void 0:e.t())??1-i;e==null||e.abort();var v=i-b,C=t.duration*Math.abs(v),_=[];if(C>0){var S=!1;if(c)for(var M=Math.ceil(C/16.666666666666668),T=0;T<=M;T+=1){var P=b+v*d(T/M),B=Ed(c(P,1-P));_.push(B),S||(S=B.overflow==="hidden")}S&&(n.style.overflow="hidden"),x=()=>{var O=y.currentTime;return b+v*d(O/C)},f&&nA(()=>{if(y.playState!=="running")return!1;var O=x();return f(O,1-O),!0})}y=n.animate(_,{duration:C,fill:"forwards"}),y.onfinish=()=>{x=()=>i,f==null||f(i,1-i),s()}},{abort:()=>{y&&(y.cancel(),y.effect=null,y.onfinish=Nn)},deactivate:()=>{s=Nn},reset:()=>{i===0&&(f==null||f(1,0))},t:()=>x()}}const lA=n=>n;function hA(n){const t=n-1;return t*t*t+1}function cA(n){return n<.5?4*n*n*n:.5*Math.pow(2*n-2,3)+1}function uA(n){const t=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[n,"px"]}function fA(n,{delay:t=0,duration:e=400,easing:i=cA,amount:s=5,opacity:r=0}={}){const o=getComputedStyle(n),l=+o.opacity,u=o.filter==="none"?"":o.filter,c=l*(1-r),[f,d]=uA(s);return{delay:t,duration:e,easing:i,css:(g,p)=>`opacity: ${l-c*p}; filter: ${u} blur(${p*f}${d});`}}function XI(n,{delay:t=0,duration:e=400,easing:i=lA}={}){const s=+getComputedStyle(n).opacity;return{delay:t,duration:e,easing:i,css:r=>`opacity: ${r*s}`}}function WI(n,{delay:t=0,duration:e=400,easing:i=hA,axis:s="y"}={}){const r=getComputedStyle(n),o=+r.opacity,l=s==="y"?"height":"width",u=parseFloat(r[l]),c=s==="y"?["top","bottom"]:["left","right"],f=c.map(v=>`${v[0].toUpperCase()}${v.slice(1)}`),d=parseFloat(r[`padding${f[0]}`]),g=parseFloat(r[`padding${f[1]}`]),p=parseFloat(r[`margin${f[0]}`]),x=parseFloat(r[`margin${f[1]}`]),y=parseFloat(r[`border${f[0]}Width`]),b=parseFloat(r[`border${f[1]}Width`]);return{delay:t,duration:e,easing:i,css:v=>`overflow: hidden;opacity: ${Math.min(v*20,1)*o};${l}: ${v*u}px;padding-${c[0]}: ${v*d}px;padding-${c[1]}: ${v*g}px;margin-${c[0]}: ${v*p}px;margin-${c[1]}: ${v*x}px;border-${c[0]}-width: ${v*y}px;border-${c[1]}-width: ${v*b}px;min-${l}: 0`}}const zI=n=>new Promise(t=>n(t)),gm=n=>new Promise(t=>{const e=setTimeout(()=>{clearTimeout(e),t()},n)}),xm="@@eventEmitter";function GI(n){GS(xm,n)}function dA(){return zS(xm)}const pA=()=>{let n=[];return{add:r=>new Promise(async o=>{n.push(o),await r(),o({interrupted:!1})}),clear:()=>n=[],getLength:()=>n.length,interrupt:()=>n.forEach(r=>r({interrupted:!0}))}};function mA(n,t){nc(t,!0);const e=dA(),i=pA(),s=400;let r=Ph(!1),o=Ph(!1);const l=async()=>{var g;Ar(o,!0);const{interrupted:d}=await i.add(()=>gm(s));d||(Ar(r,!0),(g=t.onhold)==null||g.call(t))},u=()=>{Ar(o,!1),i.interrupt(),i.clear()},c=()=>{var d;Un(o)||l(),Un(r)||(d=t.onpress)==null||d.call(t)},f=()=>{var d,g;Un(o)&&u(),Un(r)?(d=t.onholdend)==null||d.call(t):(g=t.onpressend)==null||g.call(t),Ar(r,!1)};e.eventEmitter.subscribeOnMount({hotKey:d=>{if(!t.disabled&&d.key===t.hotkey){if(d.action==="keyUp")return f();if(d.action==="keyDown")return c()}}}),Pd(()=>{t.disabled&&f()}),VS(()=>f()),Pd(()=>{var d;Un(r)&&((d=t.onhold)==null||d.call(t))}),rc()}const pn=n=>KS.url.searchParams.get(n),ym=()=>pn("lang")==="br"?"pt":pn("lang")||"en",gA=()=>pn("gameID")||"",xA=()=>pn("sessionID")||"",yA=()=>pn("rgs_url")||"",bA=()=>pn("socialCasino")==="true",_A=()=>pn("force")==="true";console.log(ym()+" from common packages");const VI={lang:ym,gameID:gA,sessionID:xA,rgsUrl:yA,socialCasino:bA,force:_A},wA={BASE:{mode:"BASE",costMultiplier:1,type:"default",parent:"",children:"",assets:{icon:"",dialogImage:"",dialogVolatility:"",volatility:"",button:""},text:{title:"",dialog:"",button:"",betAmountLabel:"",tickerIdle:"",tickerSpin:"",bannerText:""},maxWin:8888},ANTE:{mode:"ANTE",costMultiplier:1.2,type:"activate",parent:"",children:"",assets:{icon:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/icon_doubleboost.webp",dialogImage:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/doubleboost_image.webp",dialogVolatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_01.webp",volatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_white_01.webp",button:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/button_activate.webp",bannerText:"example banner text"},text:{title:"DOUBLE BOOST",dialog:"Double the chance to trigger the FREE SPINS round when activated for 1.2x the player bet amount. DOUBLE BOOST remains active until disabled by the player.",description:"Greatly increase your chance of landing a bonus symbol each spin.",button:"ACTIVATE",betAmountLabel:"DOUBLE BOOST",tickerIdle:"DOUBLE BOOST IS ACTIVE",tickerSpin:"GOOD LUCK",bannerText:"example banner text"}},SUPERANTE:{mode:"SUPERANTE",costMultiplier:5,type:"activate",parent:"",children:"",assets:{icon:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/icon_superboost.webp",dialogImage:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/superboost_image.webp",dialogVolatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_02.webp",volatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_white_02.webp",button:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/button_activate.webp"},text:{title:"SUPER BOOST",dialog:"1 in 20 chance to trigger the FREE SPINS round when activated for 5x the player bet amount. Guarantees 1 or more Scatter symbols every spin. SUPER BOOST remains active until disabled by the player.",description:"Guaranteed to land at least 1+ bonus symbol each spin.",button:"ACTIVATE",betAmountLabel:"SUPER BOOST",tickerIdle:"SUPER BOOST IS ACTIVE",tickerSpin:"GOOD LUCK",bannerText:"example banner text"}},SUPERSPIN:{mode:"SUPERSPIN",costMultiplier:25,type:"activate",parent:"",children:"",assets:{icon:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/icon_superspin.webp",dialogImage:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/superspin_image.webp",dialogVolatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_03.webp",volatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_white_03.webp",button:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/button_activate.webp"},text:{title:"SAMURAI SPIN",dialog:"All game features are boosted when activated for 25x the player bet amount. SAMURAI SPIN remains active until disabled by the player.",description:"SAMURAI SPIN is AWESOME! ",button:"ACTIVATE",betAmountLabel:"SAMURAI SPIN",tickerIdle:"SAMURAI SPIN IS ACTIVE",tickerSpin:"GOOD LUCK",bannerText:"example banner text"}},BONUS:{mode:"BONUS",costMultiplier:100,type:"buy",parent:"",children:"",assets:{icon:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/icon_bonusbuy.webp",dialogImage:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/bonus_image.webp",dialogVolatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_04.webp",volatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_white_04.webp",button:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_8_97/betModes/button_buy.webp"},text:{title:"BONUS",dialog:"Triggers FREE SPINS feature when activated for 100x the player bet amount. The Global Multiplier can reach up to 64x and remains active for the duration of FREE SPINS.",description:"Each spin may have a random multiplier applied to winning lines.",button:"BUY",tickerIdle:"PLACE YOUR BET",tickerSpin:"BONUS BUY ACTIVATED",bannerText:"example banner text"}},SUPER:{mode:"SUPER",costMultiplier:200,type:"buy",parent:"",children:"",assets:{icon:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/icon_superbonusbuy.webp",dialogImage:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/superbonus_image.webp",dialogVolatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_05.webp",volatility:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_9_97/betModes/volatility/volatility_white_05.webp",button:"https://test-fart-cdn-bucket.s3.ap-southeast-2.amazonaws.com/1_8_97/betModes/button_buy.webp"},text:{title:"SUPER BONUS",dialog:"Triggers FREE SPINS feature when activated for 200x the player bet amount. The Global Multiplier can reach up to 256x and remains active for the duration of FREE SPINS.",description:"Enter the mothership! Land values and multiply them with action symbols.",button:"BUY",tickerIdle:"PLACE YOUR BET",tickerSpin:"SUPER BONUS BUY ACTIVATED",bannerText:"example banner text"}}},vA={payTable:[{containers:[{title:"WILD SYMBOL",text:"The Wild symbol substitutes all other symbols except Scatter.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:0,column:0},{title:"FREE SPINS",text:"Scatter Symbols are on all reels. If at least 3 Scatters land in a spin sequence, FREE SPINS is triggered. 3 Scatters award 8 FREE SPINS. 4 Scatters award 12 FREE SPINS. 5 Scatters award 16 FREE SPINS. ",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:1,column:0},{title:"FREE SPINS RETRIGGER",text:"During FREE SPINS, Scatter Symbols are on all reels. If at least 3 Scatters land in a spin sequence, additional FREE SPINS rounds are triggered. 3 Scatters award 4 additional FREE SPINS. 4 Scatters award 6 additional FREE SPINS. 5 Scatters award 8 additional FREE SPINS. ",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:2,column:0}],rows:3,columns:1,title:"PAYTABLE"},{containers:[{title:"",text:`5	|	10x
4	|	5x
3	|	2x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:0,column:0},{title:"",text:`5	|	5x
4	|	2x
3	|	1x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:0,column:1},{title:"",text:`5	|	5x
4	|	2x
3	|	1x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:0,column:2},{title:"",text:`5	|	3x
4	|	1x
3	|	0.5x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:1,column:0},{title:"",text:`5	|	3x
4	|	1x
3	|	0.5x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:1,column:1},{title:"",text:`5	|	2x
4	|	0.8x
3	|	0.4x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:3,column:0},{title:"",text:`5	|	2x
4	|	0.8x
3	|	0.4x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:3,column:1},{title:"",text:`5	|	1.5x
4	|	0.5x
3	|	0.2x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:3,column:2},{title:"",text:`5	|	1.5x
4	|	0.5x
3	|	0.2x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:4,column:0},{title:"",text:`5	|	1x
4	|	0.3x
3	|	0.1x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:4,column:1},{title:"",text:`5	|	1x
4	|	0.3x
3	|	0.1x
`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/wild.ac78fbf6.png",imagePosition:"left",row:4,column:2}],rows:5,columns:3,title:"SYMBOLS"},{containers:[{title:"",text:"All symbols pay from left to right. Starting from the left most reel. Only symbols on adjacent reels will be a valid win way. This does not apply to Scatter. ",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/winWays.be45a8a4.png",imagePosition:"top",row:0,column:0}],rows:1,columns:1,title:"WIN WAYS"}],gameRules:[{containers:[{title:"",text:`The normal mode of this game has a theoretical expected return of 97.0%.

The player also has the option to select an ANTE BET mode. This costs 1.25x the underlying bet. The ANTE BET mode has a theoretical expected return of 97.0%. The ANTE BET doubles the chance of FREE SPINS.

The player also has the option to buy FREE SPINS. This costs 100x the underlying bet. The FREE SPINS buy mode has a theoretical expected return of 97.0%. 

The player has the option to buy a SUPER SPIN. This costs 25x the underlying bet. The SUPER SPIN buy mode has a theoretical expected return of 97.0%. In SUPER SPIN one spin is initially awarded. On each spin stacked Wild Symbols are on Reel Strips

 The maximum win in each Bet Mode is 5000x the underlining bet.`,image:"https://staging-1-0.twist-game.app/_app/immutable/assets/rtp97.d2febd7d.svg",imagePosition:"top",row:0,column:0}],rows:1,columns:1,title:"BET MODES"},{containers:[{title:"",text:"Malfunction voids all pays and plays. A consistent internet connection is required. In the event of a disconnection, reload the game to finish any uncompleted bets. The theoretical expected return is calculated over many spins. Movement of reels are not representative of any physical device, and is for illustrative purposes only. TM and © 2023 Twist Gaming.",image:"",row:0,column:0}],rows:1,columns:1,title:"LEGAL NOTICE"},{containers:[{title:"",text:"SPIN BUTTON | Initiates the Betting Round.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleSpin.daacc43a.webp",imagePosition:"left",row:0,column:0},{title:"",text:"STOP BUTTON | Stops the current Spin.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleStop.30db74c5.webp",imagePosition:"left",row:1,column:0},{title:"",text:"INFORMATION | Provides Game Information.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:2,column:0},{title:"",text:"SETTINGS | Adjust Game Settings.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:4,column:0},{title:"",text:"PAY TABLE | View the Paytable to see Symbol Values.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:6,column:0},{title:"",text:"AUTO SPIN | Open the Auto Spin pop-up menu.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleAutoSpin.d542a3b0.webp",imagePosition:"left",row:7,column:0},{title:"",text:"TURBO | Activate Turbo Mode.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleTurbo.a0fcfd04.webp",imagePosition:"left",row:9,column:0},{title:"",text:"MENU | Expands the Sidebar Menu for more Options.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:10,column:0},{title:"",text:"CLOSE | Exit the pop-up menu.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:11,column:0},{title:"",text:"SOUND | Mute or Unmute Game Audio.",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:12,column:0},{title:"",text:"INCREASE | Increase your Bet Amount",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:13,column:0},{title:"",text:"DECREASE | Decrease your Bet Amount",image:"https://staging-1-0.twist-game.app/_app/immutable/assets/gameRuleDown.716ec429.webp",imagePosition:"left",row:14,column:0}],rows:16,columns:1,title:"USER INTERFACE GUIDE"}],splashScreen:[]},ac=Gs({betModeMeta:wA,gameRuleMeta:vA}),$I={betModeMetaList:()=>Object.values(ac.betModeMeta)},Mi=Gs({currency:"USD",balanceAmount:0,betAmount:1,wageredBetAmount:1,lastBet:null,activeBetModeKey:"BASE",winBookEventAmount:0,autoSpinsLoss:0,autoSpinsCounter:0,autoSpinsLossLimitAmount:1/0,autoSpinsSingleWinLimitAmount:1/0,isSpaceHold:!1,isTurbo:!1}),bm=n=>{if(n<=0)return 0;const t=_m();if(t===0)return 0;const e=Mi.balanceAmount/t;return n>=e?e:n},SA=n=>{Mi.betAmount=bm(n)},AA=n=>{Mi.betAmount=bm(n(Mi.betAmount))};let Rd=!1;const CA=(n,t)=>{const{persistent:e}=t;!e&&Rd||(e&&(Rd=n),Mi.isTurbo=n)},TA=()=>{var n;return((n=ac.betModeMeta)==null?void 0:n[Mi.activeBetModeKey])||null},MA=()=>Mi.autoSpinsCounter>1||Mi.isSpaceHold,PA=()=>Mi.isTurbo?2:1,_m=()=>Fd.activeBetMode().type==="activate"?Fd.activeBetMode().costMultiplier:1,Rh=()=>Mi.betAmount*_m(),IA=()=>Rh()>0&&Rh()<=Mi.balanceAmount,kA=()=>Mi.autoSpinsCounter!==0,Fd={setBetAmount:SA,updateBetAmount:AA,updateIsTurbo:CA,activeBetMode:TA,isContinuousBet:MA,timeScale:PA,betCost:Rh,isBetCostAvailable:IA,hasAutoBetCounter:kA},HI=Gs({jurisdiction:"",betAmountOptions:[1,5,25,50,75,100,200,500,800,1e3],betMenuOptions:[1,5,25,50,75,100,200,500,800,1e3]}),Bd=Gs({selectedPastBetIndex:0,pastBets:[],force:!1,forceType:"api",forceBetModeKey:"BASE",forceSearch:{bookID:void 0,kind:"Any",symbol:"Any",hasWild:"Any",wildMult:"Any",gameType:"Any"},forceJson:""}),qI={selectedPastBet:()=>{var n;return(n=Bd.pastBets)==null?void 0:n[Bd.selectedPastBetIndex]}},jI=Gs({modal:null}),Wl=75,zl=Gs({volumeValueMaster:Wl,volumeValueMusic:Wl,volumeValueSoundEffect:Wl}),Ld={volumeMaster:()=>zl.volumeValueMaster/100,volumeMusic:()=>zl.volumeValueMusic/100*Ld.volumeMaster(),volumeSoundEffect:()=>zl.volumeValueSoundEffect/100*Ld.volumeMaster()},Ws="∞",KI=["10","25","50","75","100","250","500","1000",Ws],ZI={10:10,25:25,50:50,75:75,100:100,250:250,500:500,1e3:1e3,[Ws]:1/0},QI=["5×","10×","25×","50×","100×",Ws],JI={"5×":5,"10×":10,"25×":25,"50×":50,"100×":100,[Ws]:1/0},tk=["5×","10×","25×","50×","100×",Ws],ek={"5×":5,"10×":10,"25×":25,"50×":50,"100×":100,[Ws]:1/0},ik=Gs({autoSpinsText:"10",autoSpinsLossLimitText:Ws,autoSpinsSingleWinLimitText:Ws,freeSpinCounterShow:!1,freeSpinCounterCurrent:0,freeSpinCounterTotal:0,menuOpen:!1,drawerFold:!1,drawerButtonShow:!1}),EA=1e6,sk=100,nk=[0,2,5,7,10,13,15,16,20,23,25,26,28,29,30,32,36,37,38],Od=n=>{const{method:t,endpoint:e,variables:i}=n;return(n.fetch??fetch)(e,{method:t,headers:{"Content-Type":"application/json"},...t==="GET"?{}:{body:JSON.stringify(i)}})},Yr={post:async function(t){const e=await Od({method:"POST",variables:t.variables,endpoint:`https://${t.rgsUrl}${t.url}`});return e.status!==200&&console.error("error",e),await e.json()},get:async function(t){const e=await Od({method:"GET",endpoint:`https://${t.rgsUrl}${t.url}`});return e.status!==200&&console.error("error",e),await e.json()}},rk=async n=>await Yr.post({rgsUrl:n.rgsUrl,url:"/wallet/authenticate",variables:{gameID:n.gameID,sessionID:n.sessionID,language:n.language}}),ak=async n=>await Yr.post({rgsUrl:n.rgsUrl,url:"/wallet/end-round",variables:{gameID:n.gameID,sessionID:n.sessionID}}),ok=async n=>await Yr.post({rgsUrl:n.rgsUrl,url:"/bet/event",variables:{gameID:n.gameID,sessionID:n.sessionID,event:`${n.eventIndex}`}}),lk=async n=>await Yr.post({rgsUrl:n.rgsUrl,url:"/game/search",variables:{gameID:n.gameID,mode:n.mode,search:n.search}}),hk=async n=>await Yr.post({rgsUrl:n.rgsUrl,url:"/wallet/play",variables:{gameID:n.gameID,mode:n.mode,currency:n.currency,sessionID:n.sessionID,amount:n.amount*EA}});var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gl={},Vl={},Dd;function RA(){return Dd||(Dd=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.errorMessages=n.ErrorType=void 0;var t;(function(e){e.MalformedUnicode="MALFORMED_UNICODE",e.MalformedHexadecimal="MALFORMED_HEXADECIMAL",e.CodePointLimit="CODE_POINT_LIMIT",e.OctalDeprecation="OCTAL_DEPRECATION",e.EndOfString="END_OF_STRING"})(t=n.ErrorType||(n.ErrorType={})),n.errorMessages=new Map([[t.MalformedUnicode,"malformed Unicode character escape sequence"],[t.MalformedHexadecimal,"malformed hexadecimal character escape sequence"],[t.CodePointLimit,"Unicode codepoint must not be greater than 0x10FFFF in escape sequence"],[t.OctalDeprecation,'"0"-prefixed octal literals and octal escape sequences are deprecated; for octal literals use the "0o" prefix instead'],[t.EndOfString,"malformed escape sequence at end of string"]])}(Vl)),Vl}var Yd;function FA(){return Yd||(Yd=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.unraw=n.errorMessages=n.ErrorType=void 0;const t=RA();Object.defineProperty(n,"ErrorType",{enumerable:!0,get:function(){return t.ErrorType}}),Object.defineProperty(n,"errorMessages",{enumerable:!0,get:function(){return t.errorMessages}});function e(p){return!p.match(/[^a-f0-9]/i)?parseInt(p,16):NaN}function i(p,x,y){const b=e(p);if(Number.isNaN(b)||y!==void 0&&y!==p.length)throw new SyntaxError(t.errorMessages.get(x));return b}function s(p){const x=i(p,t.ErrorType.MalformedHexadecimal,2);return String.fromCharCode(x)}function r(p,x){const y=i(p,t.ErrorType.MalformedUnicode,4);if(x!==void 0){const b=i(x,t.ErrorType.MalformedUnicode,4);return String.fromCharCode(y,b)}return String.fromCharCode(y)}function o(p){return p.charAt(0)==="{"&&p.charAt(p.length-1)==="}"}function l(p){if(!o(p))throw new SyntaxError(t.errorMessages.get(t.ErrorType.MalformedUnicode));const x=p.slice(1,-1),y=i(x,t.ErrorType.MalformedUnicode);try{return String.fromCodePoint(y)}catch(b){throw b instanceof RangeError?new SyntaxError(t.errorMessages.get(t.ErrorType.CodePointLimit)):b}}function u(p,x=!1){if(x)throw new SyntaxError(t.errorMessages.get(t.ErrorType.OctalDeprecation));const y=parseInt(p,8);return String.fromCharCode(y)}const c=new Map([["b","\b"],["f","\f"],["n",`
`],["r","\r"],["t","	"],["v","\v"],["0","\0"]]);function f(p){return c.get(p)||p}const d=/\\(?:(\\)|x([\s\S]{0,2})|u(\{[^}]*\}?)|u([\s\S]{4})\\u([^{][\s\S]{0,3})|u([\s\S]{0,4})|([0-3]?[0-7]{1,2})|([\s\S])|$)/g;function g(p,x=!1){return p.replace(d,function(y,b,v,C,_,S,M,T,P){if(b!==void 0)return"\\";if(v!==void 0)return s(v);if(C!==void 0)return l(C);if(_!==void 0)return r(_,S);if(M!==void 0)return r(M);if(T==="0")return"\0";if(T!==void 0)return u(T,!x);if(P!==void 0)return f(P);throw new SyntaxError(t.errorMessages.get(t.ErrorType.EndOfString))})}n.unraw=g,n.default=g}(Gl)),Gl}var BA=FA();const Ns=n=>typeof n=="string",LA=n=>typeof n=="function",Nd=new Map,wm="en";function oc(n){return[...Array.isArray(n)?n:[n],wm]}function lc(n,t,e){const i=oc(n);e||(e="default");let s;if(typeof e=="string")switch(s={day:"numeric",month:"short",year:"numeric"},e){case"full":s.weekday="long";case"long":s.month="long";break;case"short":s.month="numeric";break}else s=e;return Ja(()=>to("date",i,e),()=>new Intl.DateTimeFormat(i,s)).format(Ns(t)?new Date(t):t)}function OA(n,t,e){let i;if(e||(e="default"),typeof e=="string")switch(i={second:"numeric",minute:"numeric",hour:"numeric"},e){case"full":case"long":i.timeZoneName="short";break;case"short":delete i.second}else i=e;return lc(n,t,i)}function Fh(n,t,e){const i=oc(n);return Ja(()=>to("number",i,e),()=>new Intl.NumberFormat(i,e)).format(t)}function Ud(n,t,e,{offset:i=0,...s}){const r=oc(n),o=t?Ja(()=>to("plural-ordinal",r),()=>new Intl.PluralRules(r,{type:"ordinal"})):Ja(()=>to("plural-cardinal",r),()=>new Intl.PluralRules(r,{type:"cardinal"}));return s[e]??s[o.select(e-i)]??s.other}function Ja(n,t){const e=n();let i=Nd.get(e);return i||(i=t(),Nd.set(e,i)),i}function to(n,t,e){const i=t.join("-");return`${n}-${i}-${JSON.stringify(e)}`}const vm=/\\u[a-fA-F0-9]{4}|\\x[a-fA-F0-9]{2}/,Sm="%__lingui_octothorpe__%",DA=(n,t,e={})=>{const i=t||n,s=o=>typeof o=="object"?o:e[o],r=(o,l)=>{const u=Object.keys(e).length?s("number"):void 0,c=Fh(i,o,u);return l.replace(new RegExp(Sm,"g"),c)};return{plural:(o,l)=>{const{offset:u=0}=l,c=Ud(i,!1,o,l);return r(o-u,c)},selectordinal:(o,l)=>{const{offset:u=0}=l,c=Ud(i,!0,o,l);return r(o-u,c)},select:YA,number:(o,l)=>Fh(i,o,s(l)||{style:l}),date:(o,l)=>lc(i,o,s(l)||l),time:(o,l)=>OA(i,o,s(l)||l)}},YA=(n,t)=>t[n]??t.other;function NA(n,t,e){return(i={},s)=>{const r=DA(t,e,s),o=(u,c=!1)=>Array.isArray(u)?u.reduce((f,d)=>{if(d==="#"&&c)return f+Sm;if(Ns(d))return f+d;const[g,p,x]=d;let y={};p==="plural"||p==="selectordinal"||p==="select"?Object.entries(x).forEach(([v,C])=>{y[v]=o(C,p==="plural"||p==="selectordinal")}):y=x;let b;if(p){const v=r[p];b=v(i[g],y)}else b=i[g];return b==null?f:f+b},""):u,l=o(n);return Ns(l)&&vm.test(l)?BA.unraw(l):Ns(l)?l:l?String(l):""}}var UA=Object.defineProperty,XA=(n,t,e)=>t in n?UA(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,WA=(n,t,e)=>(XA(n,t+"",e),e);let zA=class{constructor(){WA(this,"_events",{})}on(t,e){var i;return(i=this._events)[t]??(i[t]=[]),this._events[t].push(e),()=>this.removeListener(t,e)}removeListener(t,e){const i=this._getListeners(t);if(!i)return;const s=i.indexOf(e);~s&&i.splice(s,1)}emit(t,...e){const i=this._getListeners(t);i&&i.map(s=>s.apply(this,e))}_getListeners(t){const e=this._events[t];return Array.isArray(e)?e:!1}};var GA=Object.defineProperty,VA=(n,t,e)=>t in n?GA(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,sn=(n,t,e)=>(VA(n,typeof t!="symbol"?t+"":t,e),e);class $A extends zA{constructor(t){super(),sn(this,"_locale",""),sn(this,"_locales"),sn(this,"_localeData",{}),sn(this,"_messages",{}),sn(this,"_missing"),sn(this,"_messageCompiler"),sn(this,"t",this._.bind(this)),t.missing!=null&&(this._missing=t.missing),t.messages!=null&&this.load(t.messages),t.localeData!=null&&this.loadLocaleData(t.localeData),(typeof t.locale=="string"||t.locales)&&this.activate(t.locale??wm,t.locales)}get locale(){return this._locale}get locales(){return this._locales}get messages(){return this._messages[this._locale]??{}}get localeData(){return this._localeData[this._locale]??{}}_loadLocaleData(t,e){const i=this._localeData[t];i?Object.assign(i,e):this._localeData[t]=e}setMessagesCompiler(t){return this._messageCompiler=t,this}loadLocaleData(t,e){typeof t=="string"?this._loadLocaleData(t,e):Object.keys(t).forEach(i=>this._loadLocaleData(i,t[i])),this.emit("change")}_load(t,e){const i=this._messages[t];i?Object.assign(i,e):this._messages[t]=e}load(t,e){typeof t=="string"&&typeof e=="object"?this._load(t,e):Object.entries(t).forEach(([i,s])=>this._load(i,s)),this.emit("change")}loadAndActivate({locale:t,locales:e,messages:i}){this._locale=t,this._locales=e||void 0,this._messages[this._locale]=i,this.emit("change")}activate(t,e){this._locale=t,this._locales=e,this.emit("change")}_(t,e,i){if(!this.locale)throw new Error("Lingui: Attempted to call a translation function without setting a locale.\nMake sure to call `i18n.activate(locale)` before using Lingui functions.\nThis issue may also occur due to a race condition in your initialization logic.");let s=i==null?void 0:i.message;t||(t=""),Ns(t)||(e=t.values||e,s=t.message,t=t.id);const r=this.messages[t],o=r===void 0,l=this._missing;if(l&&o)return LA(l)?l(this._locale,t):l;o&&this.emit("missing",{id:t,locale:this._locale});let u=r||s||t;return Ns(u)&&(this._messageCompiler?u=this._messageCompiler(u):console.warn(`Uncompiled message detected! Message:

> ${u}

That means you use raw catalog or your catalog doesn't have a translation for the message and fallback was used.
ICU features such as interpolation and plurals will not work properly for that message. 

Please compile your catalog first. 
`)),Ns(u)&&vm.test(u)?JSON.parse(`"${u}"`):Ns(u)?u:NA(u,this._locale,this._locales)(e,i==null?void 0:i.formats)}date(t,e){return lc(this._locales||this._locale,t,e)}number(t,e){return Fh(this._locales||this._locale,t,e)}}function HA(n={}){return new $A(n)}const uk=HA();var qA=sc('<div class="close-button-wrap svelte-zvizg7"><button class="close-button svelte-zvizg7" data-test="close-button">×</button></div>'),jA=sc('<div><!></div> <!> <div><div class="blur-layer svelte-zvizg7"></div> <div class="top-layer svelte-zvizg7"><div class="click-to-close-layer svelte-zvizg7" role="button"></div> <!> <!></div></div>',1);function fk(n,t){nc(t,!0);const e={topLayer:2,clickToCloseLayer:2,closeButton:101},i=()=>t.persistent?void 0:t.onclose();let s=Ph(!0);$S(async()=>{await gm(300),Ar(s,!1)});var r=jA(),o=HS(r),l=zn(o);kh(l,()=>t.children),Gn(o);var u=Xn(o,2);mA(u,{hotkey:"Escape",onpress:i});var c=Xn(u,2);let f;var d=Xn(zn(c),2),g=zn(d);Ds(g,"tabindex",0),g.__click=i;var p=Xn(g,2);{var x=b=>{var v=qA(),C=zn(v);C.__click=i,Gn(v),Ih(()=>Ds(v,"style",`--zIndex: ${e.closeButton}`)),Mh(b,v)};qS(p,b=>{t.persistent||b(x)})}var y=Xn(p,2);kh(y,()=>t.children),Gn(d),Gn(c),Ih(()=>{f=Qa(c,1,"pop-up-wrap svelte-zvizg7",null,f,{disabled:Un(s)}),Ds(c,"style",`z-index: ${t.zIndex};`),Ds(d,"style",`--zIndex: ${e.topLayer}`),Ds(g,"style",`--zIndex: ${e.clickToCloseLayer}`)}),AS("keypress",g,i),oA(1,d,()=>fA,()=>({duration:300,opacity:0})),Mh(n,r),rc()}ic(["click"]);var KA=(n,t,e)=>e.onchange(!e.open),ZA=sc('<label><span data-test="drop-down"><!></span> <input class="checkbox svelte-febqom" type="checkbox"></label>');function dk(n,t){nc(t,!0);const e=jS(t,["$$slots","$$events","$$legacy"]);var i=ZA();let s;var r=zn(i);let o;var l=zn(r);kh(l,()=>t.children),Gn(r);var u=Xn(r,2);tA(u),u.__change=[KA,e,t],Gn(i),Ih(()=>{s=Qa(i,1,"toggle svelte-febqom",null,s,{disabled:t.disabled}),o=Qa(r,1,"content svelte-febqom",null,o,{toggled:t.open}),u.disabled=t.disabled,eA(u,t.open)}),Mh(n,i),rc()}ic(["change"]);const QA=Gs({selectedBetModeKey:"BASE"}),pk={selectedBetModeData:()=>ac.betModeMeta[QA.selectedBetModeKey]};var _r={},Fa={},Ba={},Xd;function Am(){if(Xd)return Ba;Xd=1,Object.defineProperty(Ba,"__esModule",{value:!0});var n=function(t){if("getBBox"in t){var e=t.getBBox();return Object.freeze({height:e.height,left:0,top:0,width:e.width})}else{var i=window.getComputedStyle(t);return Object.freeze({height:parseFloat(i.height||"0"),left:parseFloat(i.paddingLeft||"0"),top:parseFloat(i.paddingTop||"0"),width:parseFloat(i.width||"0")})}};return Ba.ContentRect=n,Ba}var Wd;function JA(){if(Wd)return Fa;Wd=1,Object.defineProperty(Fa,"__esModule",{value:!0});var n=Am(),t=function(){function e(i){this.target=i,this.$$broadcastWidth=this.$$broadcastHeight=0}return Object.defineProperty(e.prototype,"broadcastWidth",{get:function(){return this.$$broadcastWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"broadcastHeight",{get:function(){return this.$$broadcastHeight},enumerable:!0,configurable:!0}),e.prototype.isActive=function(){var i=n.ContentRect(this.target);return!!i&&(i.width!==this.broadcastWidth||i.height!==this.broadcastHeight)},e}();return Fa.ResizeObservation=t,Fa}var La={},zd;function tC(){if(zd)return La;zd=1,Object.defineProperty(La,"__esModule",{value:!0});var n=Am(),t=function(){function e(i){this.target=i,this.contentRect=n.ContentRect(i)}return e}();return La.ResizeObserverEntry=t,La}var Gd;function eC(){if(Gd)return _r;Gd=1,Object.defineProperty(_r,"__esModule",{value:!0});var n=JA(),t=tC(),e=[],i=function(){function M(T){this.$$observationTargets=[],this.$$activeTargets=[],this.$$skippedTargets=[];var P=o(T);if(P)throw TypeError(P);this.$$callback=T}return M.prototype.observe=function(T){var P=l("observe",T);if(P)throw TypeError(P);var B=u(this.$$observationTargets,T);B>=0||(this.$$observationTargets.push(new n.ResizeObservation(T)),s(this))},M.prototype.unobserve=function(T){var P=l("unobserve",T);if(P)throw TypeError(P);var B=u(this.$$observationTargets,T);B<0||(this.$$observationTargets.splice(B,1),this.$$observationTargets.length===0&&r(this))},M.prototype.disconnect=function(){this.$$observationTargets=[],this.$$activeTargets=[],r(this)},M}();_r.ResizeObserver=i;function s(M){var T=e.indexOf(M);T<0&&(e.push(M),v())}function r(M){var T=e.indexOf(M);T>=0&&(e.splice(T,1),_())}function o(M){if(typeof M>"u")return"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.";if(typeof M!="function")return"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function."}function l(M,T){if(typeof T>"u")return"Failed to execute '"+M+"' on 'ResizeObserver': 1 argument required, but only 0 present.";if(!(T&&T.nodeType===window.Node.ELEMENT_NODE))return"Failed to execute '"+M+"' on 'ResizeObserver': parameter 1 is not of type 'Element'."}function u(M,T){for(var P=0;P<M.length;P+=1)if(M[P].target===T)return P;return-1}var c=function(M){e.forEach(function(T){T.$$activeTargets=[],T.$$skippedTargets=[],T.$$observationTargets.forEach(function(P){if(P.isActive()){var B=x(P.target);B>M?T.$$activeTargets.push(P):T.$$skippedTargets.push(P)}})})},f=function(){return e.some(function(M){return!!M.$$activeTargets.length})},d=function(){return e.some(function(M){return!!M.$$skippedTargets.length})},g=function(){var M=1/0;return e.forEach(function(T){if(T.$$activeTargets.length){var P=[];T.$$activeTargets.forEach(function(B){var O=new t.ResizeObserverEntry(B.target);P.push(O),B.$$broadcastWidth=O.contentRect.width,B.$$broadcastHeight=O.contentRect.height;var U=x(B.target);U<M&&(M=U)}),T.$$callback(P,T),T.$$activeTargets=[]}}),M},p=function(){var M=new window.ErrorEvent("ResizeLoopError",{message:"ResizeObserver loop completed with undelivered notifications."});window.dispatchEvent(M)},x=function(M){for(var T=0;M.parentNode;)M=M.parentNode,T+=1;return T},y=function(){var M=0;for(c(M);f();)M=g(),c(M);d()&&p()},b,v=function(){b||C()},C=function(){b=window.requestAnimationFrame(function(){y(),C()})},_=function(){b&&!e.some(function(M){return!!M.$$observationTargets.length})&&(window.cancelAnimationFrame(b),b=void 0)},S=function(){return window.ResizeObserver=i};return _r.install=S,_r}var mk=eC(),Cr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var iC=Cr.exports,Vd;function sC(){return Vd||(Vd=1,function(n,t){(function(){var e,i="4.17.21",s=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",l="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",c=500,f="__lodash_placeholder__",d=1,g=2,p=4,x=1,y=2,b=1,v=2,C=4,_=8,S=16,M=32,T=64,P=128,B=256,O=512,U=30,N="...",et=800,K=16,V=1,J=2,E=3,L=1/0,Y=9007199254740991,W=17976931348623157e292,q=NaN,j=4294967295,tt=j-1,Z=j>>>1,ct=[["ary",P],["bind",b],["bindKey",v],["curry",_],["curryRight",S],["flip",O],["partial",M],["partialRight",T],["rearg",B]],lt="[object Arguments]",Pt="[object Array]",Ct="[object AsyncFunction]",gt="[object Boolean]",It="[object Date]",wt="[object DOMException]",ee="[object Error]",ie="[object Function]",Pe="[object GeneratorFunction]",Kt="[object Map]",St="[object Number]",Dt="[object Null]",Le="[object Object]",Ii="[object Promise]",As="[object Proxy]",Vi="[object RegExp]",be="[object Set]",ii="[object String]",rs="[object Symbol]",Cs="[object Undefined]",Vs="[object WeakMap]",Xr="[object WeakSet]",$s="[object ArrayBuffer]",as="[object DataView]",bn="[object Float32Array]",pi="[object Float64Array]",_n="[object Int8Array]",F="[object Int16Array]",z="[object Int32Array]",ot="[object Uint8Array]",st="[object Uint8ClampedArray]",ut="[object Uint16Array]",xt="[object Uint32Array]",vt=/\b__p \+= '';/g,$t=/\b(__p \+=) '' \+/g,Ht=/(__e\(.*?\)|\b__t\)) \+\n'';/g,re=/&(?:amp|lt|gt|quot|#39);/g,ae=/[&<>"']/g,Oe=RegExp(re.source),si=RegExp(ae.source),Ts=/<%-([\s\S]+?)%>/g,Io=/<%([\s\S]+?)%>/g,Kc=/<%=([\s\S]+?)%>/g,W0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,z0=/^\w*$/,G0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ko=/[\\^$.*+?()[\]{}|]/g,V0=RegExp(ko.source),Eo=/^\s+/,$0=/\s/,H0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,q0=/\{\n\/\* \[wrapped with (.+)\] \*/,j0=/,? & /,K0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Z0=/[()=,{}\[\]\/\s]/,Q0=/\\(\\)?/g,J0=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Zc=/\w*$/,tx=/^[-+]0x[0-9a-f]+$/i,ex=/^0b[01]+$/i,ix=/^\[object .+?Constructor\]$/,sx=/^0o[0-7]+$/i,nx=/^(?:0|[1-9]\d*)$/,rx=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,ax=/['\n\r\u2028\u2029\\]/g,zr="\\ud800-\\udfff",ox="\\u0300-\\u036f",lx="\\ufe20-\\ufe2f",hx="\\u20d0-\\u20ff",Qc=ox+lx+hx,Jc="\\u2700-\\u27bf",tu="a-z\\xdf-\\xf6\\xf8-\\xff",cx="\\xac\\xb1\\xd7\\xf7",ux="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fx="\\u2000-\\u206f",dx=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",eu="A-Z\\xc0-\\xd6\\xd8-\\xde",iu="\\ufe0e\\ufe0f",su=cx+ux+fx+dx,Ro="['’]",px="["+zr+"]",nu="["+su+"]",Gr="["+Qc+"]",ru="\\d+",mx="["+Jc+"]",au="["+tu+"]",ou="[^"+zr+su+ru+Jc+tu+eu+"]",Fo="\\ud83c[\\udffb-\\udfff]",gx="(?:"+Gr+"|"+Fo+")",lu="[^"+zr+"]",Bo="(?:\\ud83c[\\udde6-\\uddff]){2}",Lo="[\\ud800-\\udbff][\\udc00-\\udfff]",wn="["+eu+"]",hu="\\u200d",cu="(?:"+au+"|"+ou+")",xx="(?:"+wn+"|"+ou+")",uu="(?:"+Ro+"(?:d|ll|m|re|s|t|ve))?",fu="(?:"+Ro+"(?:D|LL|M|RE|S|T|VE))?",du=gx+"?",pu="["+iu+"]?",yx="(?:"+hu+"(?:"+[lu,Bo,Lo].join("|")+")"+pu+du+")*",bx="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_x="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",mu=pu+du+yx,wx="(?:"+[mx,Bo,Lo].join("|")+")"+mu,vx="(?:"+[lu+Gr+"?",Gr,Bo,Lo,px].join("|")+")",Sx=RegExp(Ro,"g"),Ax=RegExp(Gr,"g"),Oo=RegExp(Fo+"(?="+Fo+")|"+vx+mu,"g"),Cx=RegExp([wn+"?"+au+"+"+uu+"(?="+[nu,wn,"$"].join("|")+")",xx+"+"+fu+"(?="+[nu,wn+cu,"$"].join("|")+")",wn+"?"+cu+"+"+uu,wn+"+"+fu,_x,bx,ru,wx].join("|"),"g"),Tx=RegExp("["+hu+zr+Qc+iu+"]"),Mx=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Px=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ix=-1,oe={};oe[bn]=oe[pi]=oe[_n]=oe[F]=oe[z]=oe[ot]=oe[st]=oe[ut]=oe[xt]=!0,oe[lt]=oe[Pt]=oe[$s]=oe[gt]=oe[as]=oe[It]=oe[ee]=oe[ie]=oe[Kt]=oe[St]=oe[Le]=oe[Vi]=oe[be]=oe[ii]=oe[Vs]=!1;var se={};se[lt]=se[Pt]=se[$s]=se[as]=se[gt]=se[It]=se[bn]=se[pi]=se[_n]=se[F]=se[z]=se[Kt]=se[St]=se[Le]=se[Vi]=se[be]=se[ii]=se[rs]=se[ot]=se[st]=se[ut]=se[xt]=!0,se[ee]=se[ie]=se[Vs]=!1;var kx={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ex={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rx={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Bx=parseFloat,Lx=parseInt,gu=typeof Ra=="object"&&Ra&&Ra.Object===Object&&Ra,Ox=typeof self=="object"&&self&&self.Object===Object&&self,De=gu||Ox||Function("return this")(),Do=t&&!t.nodeType&&t,Hs=Do&&!0&&n&&!n.nodeType&&n,xu=Hs&&Hs.exports===Do,Yo=xu&&gu.process,mi=function(){try{var $=Hs&&Hs.require&&Hs.require("util").types;return $||Yo&&Yo.binding&&Yo.binding("util")}catch{}}(),yu=mi&&mi.isArrayBuffer,bu=mi&&mi.isDate,_u=mi&&mi.isMap,wu=mi&&mi.isRegExp,vu=mi&&mi.isSet,Su=mi&&mi.isTypedArray;function ni($,it,Q){switch(Q.length){case 0:return $.call(it);case 1:return $.call(it,Q[0]);case 2:return $.call(it,Q[0],Q[1]);case 3:return $.call(it,Q[0],Q[1],Q[2])}return $.apply(it,Q)}function Dx($,it,Q,mt){for(var Et=-1,qt=$==null?0:$.length;++Et<qt;){var Ae=$[Et];it(mt,Ae,Q(Ae),$)}return mt}function gi($,it){for(var Q=-1,mt=$==null?0:$.length;++Q<mt&&it($[Q],Q,$)!==!1;);return $}function Yx($,it){for(var Q=$==null?0:$.length;Q--&&it($[Q],Q,$)!==!1;);return $}function Au($,it){for(var Q=-1,mt=$==null?0:$.length;++Q<mt;)if(!it($[Q],Q,$))return!1;return!0}function Ms($,it){for(var Q=-1,mt=$==null?0:$.length,Et=0,qt=[];++Q<mt;){var Ae=$[Q];it(Ae,Q,$)&&(qt[Et++]=Ae)}return qt}function Vr($,it){var Q=$==null?0:$.length;return!!Q&&vn($,it,0)>-1}function No($,it,Q){for(var mt=-1,Et=$==null?0:$.length;++mt<Et;)if(Q(it,$[mt]))return!0;return!1}function ue($,it){for(var Q=-1,mt=$==null?0:$.length,Et=Array(mt);++Q<mt;)Et[Q]=it($[Q],Q,$);return Et}function Ps($,it){for(var Q=-1,mt=it.length,Et=$.length;++Q<mt;)$[Et+Q]=it[Q];return $}function Uo($,it,Q,mt){var Et=-1,qt=$==null?0:$.length;for(mt&&qt&&(Q=$[++Et]);++Et<qt;)Q=it(Q,$[Et],Et,$);return Q}function Nx($,it,Q,mt){var Et=$==null?0:$.length;for(mt&&Et&&(Q=$[--Et]);Et--;)Q=it(Q,$[Et],Et,$);return Q}function Xo($,it){for(var Q=-1,mt=$==null?0:$.length;++Q<mt;)if(it($[Q],Q,$))return!0;return!1}var Ux=Wo("length");function Xx($){return $.split("")}function Wx($){return $.match(K0)||[]}function Cu($,it,Q){var mt;return Q($,function(Et,qt,Ae){if(it(Et,qt,Ae))return mt=qt,!1}),mt}function $r($,it,Q,mt){for(var Et=$.length,qt=Q+(mt?1:-1);mt?qt--:++qt<Et;)if(it($[qt],qt,$))return qt;return-1}function vn($,it,Q){return it===it?ty($,it,Q):$r($,Tu,Q)}function zx($,it,Q,mt){for(var Et=Q-1,qt=$.length;++Et<qt;)if(mt($[Et],it))return Et;return-1}function Tu($){return $!==$}function Mu($,it){var Q=$==null?0:$.length;return Q?Go($,it)/Q:q}function Wo($){return function(it){return it==null?e:it[$]}}function zo($){return function(it){return $==null?e:$[it]}}function Pu($,it,Q,mt,Et){return Et($,function(qt,Ae,te){Q=mt?(mt=!1,qt):it(Q,qt,Ae,te)}),Q}function Gx($,it){var Q=$.length;for($.sort(it);Q--;)$[Q]=$[Q].value;return $}function Go($,it){for(var Q,mt=-1,Et=$.length;++mt<Et;){var qt=it($[mt]);qt!==e&&(Q=Q===e?qt:Q+qt)}return Q}function Vo($,it){for(var Q=-1,mt=Array($);++Q<$;)mt[Q]=it(Q);return mt}function Vx($,it){return ue(it,function(Q){return[Q,$[Q]]})}function Iu($){return $&&$.slice(0,Fu($)+1).replace(Eo,"")}function ri($){return function(it){return $(it)}}function $o($,it){return ue(it,function(Q){return $[Q]})}function rr($,it){return $.has(it)}function ku($,it){for(var Q=-1,mt=$.length;++Q<mt&&vn(it,$[Q],0)>-1;);return Q}function Eu($,it){for(var Q=$.length;Q--&&vn(it,$[Q],0)>-1;);return Q}function $x($,it){for(var Q=$.length,mt=0;Q--;)$[Q]===it&&++mt;return mt}var Hx=zo(kx),qx=zo(Ex);function jx($){return"\\"+Fx[$]}function Kx($,it){return $==null?e:$[it]}function Sn($){return Tx.test($)}function Zx($){return Mx.test($)}function Qx($){for(var it,Q=[];!(it=$.next()).done;)Q.push(it.value);return Q}function Ho($){var it=-1,Q=Array($.size);return $.forEach(function(mt,Et){Q[++it]=[Et,mt]}),Q}function Ru($,it){return function(Q){return $(it(Q))}}function Is($,it){for(var Q=-1,mt=$.length,Et=0,qt=[];++Q<mt;){var Ae=$[Q];(Ae===it||Ae===f)&&($[Q]=f,qt[Et++]=Q)}return qt}function Hr($){var it=-1,Q=Array($.size);return $.forEach(function(mt){Q[++it]=mt}),Q}function Jx($){var it=-1,Q=Array($.size);return $.forEach(function(mt){Q[++it]=[mt,mt]}),Q}function ty($,it,Q){for(var mt=Q-1,Et=$.length;++mt<Et;)if($[mt]===it)return mt;return-1}function ey($,it,Q){for(var mt=Q+1;mt--;)if($[mt]===it)return mt;return mt}function An($){return Sn($)?sy($):Ux($)}function ki($){return Sn($)?ny($):Xx($)}function Fu($){for(var it=$.length;it--&&$0.test($.charAt(it)););return it}var iy=zo(Rx);function sy($){for(var it=Oo.lastIndex=0;Oo.test($);)++it;return it}function ny($){return $.match(Oo)||[]}function ry($){return $.match(Cx)||[]}var ay=function $(it){it=it==null?De:Cn.defaults(De.Object(),it,Cn.pick(De,Px));var Q=it.Array,mt=it.Date,Et=it.Error,qt=it.Function,Ae=it.Math,te=it.Object,qo=it.RegExp,oy=it.String,xi=it.TypeError,qr=Q.prototype,ly=qt.prototype,Tn=te.prototype,jr=it["__core-js_shared__"],Kr=ly.toString,Qt=Tn.hasOwnProperty,hy=0,Bu=function(){var a=/[^.]+$/.exec(jr&&jr.keys&&jr.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Zr=Tn.toString,cy=Kr.call(te),uy=De._,fy=qo("^"+Kr.call(Qt).replace(ko,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qr=xu?it.Buffer:e,ks=it.Symbol,Jr=it.Uint8Array,Lu=Qr?Qr.allocUnsafe:e,ta=Ru(te.getPrototypeOf,te),Ou=te.create,Du=Tn.propertyIsEnumerable,ea=qr.splice,Yu=ks?ks.isConcatSpreadable:e,ar=ks?ks.iterator:e,qs=ks?ks.toStringTag:e,ia=function(){try{var a=Js(te,"defineProperty");return a({},"",{}),a}catch{}}(),dy=it.clearTimeout!==De.clearTimeout&&it.clearTimeout,py=mt&&mt.now!==De.Date.now&&mt.now,my=it.setTimeout!==De.setTimeout&&it.setTimeout,sa=Ae.ceil,na=Ae.floor,jo=te.getOwnPropertySymbols,gy=Qr?Qr.isBuffer:e,Nu=it.isFinite,xy=qr.join,yy=Ru(te.keys,te),Ce=Ae.max,Xe=Ae.min,by=mt.now,_y=it.parseInt,Uu=Ae.random,wy=qr.reverse,Ko=Js(it,"DataView"),or=Js(it,"Map"),Zo=Js(it,"Promise"),Mn=Js(it,"Set"),lr=Js(it,"WeakMap"),hr=Js(te,"create"),ra=lr&&new lr,Pn={},vy=tn(Ko),Sy=tn(or),Ay=tn(Zo),Cy=tn(Mn),Ty=tn(lr),aa=ks?ks.prototype:e,cr=aa?aa.valueOf:e,Xu=aa?aa.toString:e;function k(a){if(xe(a)&&!Rt(a)&&!(a instanceof Ut)){if(a instanceof yi)return a;if(Qt.call(a,"__wrapped__"))return zf(a)}return new yi(a)}var In=function(){function a(){}return function(h){if(!de(h))return{};if(Ou)return Ou(h);a.prototype=h;var m=new a;return a.prototype=e,m}}();function oa(){}function yi(a,h){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=e}k.templateSettings={escape:Ts,evaluate:Io,interpolate:Kc,variable:"",imports:{_:k}},k.prototype=oa.prototype,k.prototype.constructor=k,yi.prototype=In(oa.prototype),yi.prototype.constructor=yi;function Ut(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=j,this.__views__=[]}function My(){var a=new Ut(this.__wrapped__);return a.__actions__=Ke(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Ke(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Ke(this.__views__),a}function Py(){if(this.__filtered__){var a=new Ut(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Iy(){var a=this.__wrapped__.value(),h=this.__dir__,m=Rt(a),w=h<0,I=m?a.length:0,R=Xb(0,I,this.__views__),D=R.start,X=R.end,H=X-D,nt=w?X:D-1,rt=this.__iteratees__,ht=rt.length,pt=0,yt=Xe(H,this.__takeCount__);if(!m||!w&&I==H&&yt==H)return ff(a,this.__actions__);var Tt=[];t:for(;H--&&pt<yt;){nt+=h;for(var Lt=-1,Mt=a[nt];++Lt<ht;){var Nt=rt[Lt],Wt=Nt.iteratee,li=Nt.type,qe=Wt(Mt);if(li==J)Mt=qe;else if(!qe){if(li==V)continue t;break t}}Tt[pt++]=Mt}return Tt}Ut.prototype=In(oa.prototype),Ut.prototype.constructor=Ut;function js(a){var h=-1,m=a==null?0:a.length;for(this.clear();++h<m;){var w=a[h];this.set(w[0],w[1])}}function ky(){this.__data__=hr?hr(null):{},this.size=0}function Ey(a){var h=this.has(a)&&delete this.__data__[a];return this.size-=h?1:0,h}function Ry(a){var h=this.__data__;if(hr){var m=h[a];return m===u?e:m}return Qt.call(h,a)?h[a]:e}function Fy(a){var h=this.__data__;return hr?h[a]!==e:Qt.call(h,a)}function By(a,h){var m=this.__data__;return this.size+=this.has(a)?0:1,m[a]=hr&&h===e?u:h,this}js.prototype.clear=ky,js.prototype.delete=Ey,js.prototype.get=Ry,js.prototype.has=Fy,js.prototype.set=By;function os(a){var h=-1,m=a==null?0:a.length;for(this.clear();++h<m;){var w=a[h];this.set(w[0],w[1])}}function Ly(){this.__data__=[],this.size=0}function Oy(a){var h=this.__data__,m=la(h,a);if(m<0)return!1;var w=h.length-1;return m==w?h.pop():ea.call(h,m,1),--this.size,!0}function Dy(a){var h=this.__data__,m=la(h,a);return m<0?e:h[m][1]}function Yy(a){return la(this.__data__,a)>-1}function Ny(a,h){var m=this.__data__,w=la(m,a);return w<0?(++this.size,m.push([a,h])):m[w][1]=h,this}os.prototype.clear=Ly,os.prototype.delete=Oy,os.prototype.get=Dy,os.prototype.has=Yy,os.prototype.set=Ny;function ls(a){var h=-1,m=a==null?0:a.length;for(this.clear();++h<m;){var w=a[h];this.set(w[0],w[1])}}function Uy(){this.size=0,this.__data__={hash:new js,map:new(or||os),string:new js}}function Xy(a){var h=_a(this,a).delete(a);return this.size-=h?1:0,h}function Wy(a){return _a(this,a).get(a)}function zy(a){return _a(this,a).has(a)}function Gy(a,h){var m=_a(this,a),w=m.size;return m.set(a,h),this.size+=m.size==w?0:1,this}ls.prototype.clear=Uy,ls.prototype.delete=Xy,ls.prototype.get=Wy,ls.prototype.has=zy,ls.prototype.set=Gy;function Ks(a){var h=-1,m=a==null?0:a.length;for(this.__data__=new ls;++h<m;)this.add(a[h])}function Vy(a){return this.__data__.set(a,u),this}function $y(a){return this.__data__.has(a)}Ks.prototype.add=Ks.prototype.push=Vy,Ks.prototype.has=$y;function Ei(a){var h=this.__data__=new os(a);this.size=h.size}function Hy(){this.__data__=new os,this.size=0}function qy(a){var h=this.__data__,m=h.delete(a);return this.size=h.size,m}function jy(a){return this.__data__.get(a)}function Ky(a){return this.__data__.has(a)}function Zy(a,h){var m=this.__data__;if(m instanceof os){var w=m.__data__;if(!or||w.length<s-1)return w.push([a,h]),this.size=++m.size,this;m=this.__data__=new ls(w)}return m.set(a,h),this.size=m.size,this}Ei.prototype.clear=Hy,Ei.prototype.delete=qy,Ei.prototype.get=jy,Ei.prototype.has=Ky,Ei.prototype.set=Zy;function Wu(a,h){var m=Rt(a),w=!m&&en(a),I=!m&&!w&&Ls(a),R=!m&&!w&&!I&&Fn(a),D=m||w||I||R,X=D?Vo(a.length,oy):[],H=X.length;for(var nt in a)(h||Qt.call(a,nt))&&!(D&&(nt=="length"||I&&(nt=="offset"||nt=="parent")||R&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||fs(nt,H)))&&X.push(nt);return X}function zu(a){var h=a.length;return h?a[ll(0,h-1)]:e}function Qy(a,h){return wa(Ke(a),Zs(h,0,a.length))}function Jy(a){return wa(Ke(a))}function Qo(a,h,m){(m!==e&&!Ri(a[h],m)||m===e&&!(h in a))&&hs(a,h,m)}function ur(a,h,m){var w=a[h];(!(Qt.call(a,h)&&Ri(w,m))||m===e&&!(h in a))&&hs(a,h,m)}function la(a,h){for(var m=a.length;m--;)if(Ri(a[m][0],h))return m;return-1}function tb(a,h,m,w){return Es(a,function(I,R,D){h(w,I,m(I),D)}),w}function Gu(a,h){return a&&Hi(h,Ie(h),a)}function eb(a,h){return a&&Hi(h,Qe(h),a)}function hs(a,h,m){h=="__proto__"&&ia?ia(a,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):a[h]=m}function Jo(a,h){for(var m=-1,w=h.length,I=Q(w),R=a==null;++m<w;)I[m]=R?e:Fl(a,h[m]);return I}function Zs(a,h,m){return a===a&&(m!==e&&(a=a<=m?a:m),h!==e&&(a=a>=h?a:h)),a}function bi(a,h,m,w,I,R){var D,X=h&d,H=h&g,nt=h&p;if(m&&(D=I?m(a,w,I,R):m(a)),D!==e)return D;if(!de(a))return a;var rt=Rt(a);if(rt){if(D=zb(a),!X)return Ke(a,D)}else{var ht=We(a),pt=ht==ie||ht==Pe;if(Ls(a))return mf(a,X);if(ht==Le||ht==lt||pt&&!I){if(D=H||pt?{}:Bf(a),!X)return H?Rb(a,eb(D,a)):Eb(a,Gu(D,a))}else{if(!se[ht])return I?a:{};D=Gb(a,ht,X)}}R||(R=new Ei);var yt=R.get(a);if(yt)return yt;R.set(a,D),hd(a)?a.forEach(function(Mt){D.add(bi(Mt,h,m,Mt,a,R))}):od(a)&&a.forEach(function(Mt,Nt){D.set(Nt,bi(Mt,h,m,Nt,a,R))});var Tt=nt?H?bl:yl:H?Qe:Ie,Lt=rt?e:Tt(a);return gi(Lt||a,function(Mt,Nt){Lt&&(Nt=Mt,Mt=a[Nt]),ur(D,Nt,bi(Mt,h,m,Nt,a,R))}),D}function ib(a){var h=Ie(a);return function(m){return Vu(m,a,h)}}function Vu(a,h,m){var w=m.length;if(a==null)return!w;for(a=te(a);w--;){var I=m[w],R=h[I],D=a[I];if(D===e&&!(I in a)||!R(D))return!1}return!0}function $u(a,h,m){if(typeof a!="function")throw new xi(o);return yr(function(){a.apply(e,m)},h)}function fr(a,h,m,w){var I=-1,R=Vr,D=!0,X=a.length,H=[],nt=h.length;if(!X)return H;m&&(h=ue(h,ri(m))),w?(R=No,D=!1):h.length>=s&&(R=rr,D=!1,h=new Ks(h));t:for(;++I<X;){var rt=a[I],ht=m==null?rt:m(rt);if(rt=w||rt!==0?rt:0,D&&ht===ht){for(var pt=nt;pt--;)if(h[pt]===ht)continue t;H.push(rt)}else R(h,ht,w)||H.push(rt)}return H}var Es=_f($i),Hu=_f(el,!0);function sb(a,h){var m=!0;return Es(a,function(w,I,R){return m=!!h(w,I,R),m}),m}function ha(a,h,m){for(var w=-1,I=a.length;++w<I;){var R=a[w],D=h(R);if(D!=null&&(X===e?D===D&&!oi(D):m(D,X)))var X=D,H=R}return H}function nb(a,h,m,w){var I=a.length;for(m=Ft(m),m<0&&(m=-m>I?0:I+m),w=w===e||w>I?I:Ft(w),w<0&&(w+=I),w=m>w?0:ud(w);m<w;)a[m++]=h;return a}function qu(a,h){var m=[];return Es(a,function(w,I,R){h(w,I,R)&&m.push(w)}),m}function Ye(a,h,m,w,I){var R=-1,D=a.length;for(m||(m=$b),I||(I=[]);++R<D;){var X=a[R];h>0&&m(X)?h>1?Ye(X,h-1,m,w,I):Ps(I,X):w||(I[I.length]=X)}return I}var tl=wf(),ju=wf(!0);function $i(a,h){return a&&tl(a,h,Ie)}function el(a,h){return a&&ju(a,h,Ie)}function ca(a,h){return Ms(h,function(m){return ds(a[m])})}function Qs(a,h){h=Fs(h,a);for(var m=0,w=h.length;a!=null&&m<w;)a=a[qi(h[m++])];return m&&m==w?a:e}function Ku(a,h,m){var w=h(a);return Rt(a)?w:Ps(w,m(a))}function $e(a){return a==null?a===e?Cs:Dt:qs&&qs in te(a)?Ub(a):Jb(a)}function il(a,h){return a>h}function rb(a,h){return a!=null&&Qt.call(a,h)}function ab(a,h){return a!=null&&h in te(a)}function ob(a,h,m){return a>=Xe(h,m)&&a<Ce(h,m)}function sl(a,h,m){for(var w=m?No:Vr,I=a[0].length,R=a.length,D=R,X=Q(R),H=1/0,nt=[];D--;){var rt=a[D];D&&h&&(rt=ue(rt,ri(h))),H=Xe(rt.length,H),X[D]=!m&&(h||I>=120&&rt.length>=120)?new Ks(D&&rt):e}rt=a[0];var ht=-1,pt=X[0];t:for(;++ht<I&&nt.length<H;){var yt=rt[ht],Tt=h?h(yt):yt;if(yt=m||yt!==0?yt:0,!(pt?rr(pt,Tt):w(nt,Tt,m))){for(D=R;--D;){var Lt=X[D];if(!(Lt?rr(Lt,Tt):w(a[D],Tt,m)))continue t}pt&&pt.push(Tt),nt.push(yt)}}return nt}function lb(a,h,m,w){return $i(a,function(I,R,D){h(w,m(I),R,D)}),w}function dr(a,h,m){h=Fs(h,a),a=Yf(a,h);var w=a==null?a:a[qi(wi(h))];return w==null?e:ni(w,a,m)}function Zu(a){return xe(a)&&$e(a)==lt}function hb(a){return xe(a)&&$e(a)==$s}function cb(a){return xe(a)&&$e(a)==It}function pr(a,h,m,w,I){return a===h?!0:a==null||h==null||!xe(a)&&!xe(h)?a!==a&&h!==h:ub(a,h,m,w,pr,I)}function ub(a,h,m,w,I,R){var D=Rt(a),X=Rt(h),H=D?Pt:We(a),nt=X?Pt:We(h);H=H==lt?Le:H,nt=nt==lt?Le:nt;var rt=H==Le,ht=nt==Le,pt=H==nt;if(pt&&Ls(a)){if(!Ls(h))return!1;D=!0,rt=!1}if(pt&&!rt)return R||(R=new Ei),D||Fn(a)?Ef(a,h,m,w,I,R):Yb(a,h,H,m,w,I,R);if(!(m&x)){var yt=rt&&Qt.call(a,"__wrapped__"),Tt=ht&&Qt.call(h,"__wrapped__");if(yt||Tt){var Lt=yt?a.value():a,Mt=Tt?h.value():h;return R||(R=new Ei),I(Lt,Mt,m,w,R)}}return pt?(R||(R=new Ei),Nb(a,h,m,w,I,R)):!1}function fb(a){return xe(a)&&We(a)==Kt}function nl(a,h,m,w){var I=m.length,R=I,D=!w;if(a==null)return!R;for(a=te(a);I--;){var X=m[I];if(D&&X[2]?X[1]!==a[X[0]]:!(X[0]in a))return!1}for(;++I<R;){X=m[I];var H=X[0],nt=a[H],rt=X[1];if(D&&X[2]){if(nt===e&&!(H in a))return!1}else{var ht=new Ei;if(w)var pt=w(nt,rt,H,a,h,ht);if(!(pt===e?pr(rt,nt,x|y,w,ht):pt))return!1}}return!0}function Qu(a){if(!de(a)||qb(a))return!1;var h=ds(a)?fy:ix;return h.test(tn(a))}function db(a){return xe(a)&&$e(a)==Vi}function pb(a){return xe(a)&&We(a)==be}function mb(a){return xe(a)&&Ma(a.length)&&!!oe[$e(a)]}function Ju(a){return typeof a=="function"?a:a==null?Je:typeof a=="object"?Rt(a)?sf(a[0],a[1]):ef(a):vd(a)}function rl(a){if(!xr(a))return yy(a);var h=[];for(var m in te(a))Qt.call(a,m)&&m!="constructor"&&h.push(m);return h}function gb(a){if(!de(a))return Qb(a);var h=xr(a),m=[];for(var w in a)w=="constructor"&&(h||!Qt.call(a,w))||m.push(w);return m}function al(a,h){return a<h}function tf(a,h){var m=-1,w=Ze(a)?Q(a.length):[];return Es(a,function(I,R,D){w[++m]=h(I,R,D)}),w}function ef(a){var h=wl(a);return h.length==1&&h[0][2]?Of(h[0][0],h[0][1]):function(m){return m===a||nl(m,a,h)}}function sf(a,h){return Sl(a)&&Lf(h)?Of(qi(a),h):function(m){var w=Fl(m,a);return w===e&&w===h?Bl(m,a):pr(h,w,x|y)}}function ua(a,h,m,w,I){a!==h&&tl(h,function(R,D){if(I||(I=new Ei),de(R))xb(a,h,D,m,ua,w,I);else{var X=w?w(Cl(a,D),R,D+"",a,h,I):e;X===e&&(X=R),Qo(a,D,X)}},Qe)}function xb(a,h,m,w,I,R,D){var X=Cl(a,m),H=Cl(h,m),nt=D.get(H);if(nt){Qo(a,m,nt);return}var rt=R?R(X,H,m+"",a,h,D):e,ht=rt===e;if(ht){var pt=Rt(H),yt=!pt&&Ls(H),Tt=!pt&&!yt&&Fn(H);rt=H,pt||yt||Tt?Rt(X)?rt=X:_e(X)?rt=Ke(X):yt?(ht=!1,rt=mf(H,!0)):Tt?(ht=!1,rt=gf(H,!0)):rt=[]:br(H)||en(H)?(rt=X,en(X)?rt=fd(X):(!de(X)||ds(X))&&(rt=Bf(H))):ht=!1}ht&&(D.set(H,rt),I(rt,H,w,R,D),D.delete(H)),Qo(a,m,rt)}function nf(a,h){var m=a.length;if(m)return h+=h<0?m:0,fs(h,m)?a[h]:e}function rf(a,h,m){h.length?h=ue(h,function(R){return Rt(R)?function(D){return Qs(D,R.length===1?R[0]:R)}:R}):h=[Je];var w=-1;h=ue(h,ri(At()));var I=tf(a,function(R,D,X){var H=ue(h,function(nt){return nt(R)});return{criteria:H,index:++w,value:R}});return Gx(I,function(R,D){return kb(R,D,m)})}function yb(a,h){return af(a,h,function(m,w){return Bl(a,w)})}function af(a,h,m){for(var w=-1,I=h.length,R={};++w<I;){var D=h[w],X=Qs(a,D);m(X,D)&&mr(R,Fs(D,a),X)}return R}function bb(a){return function(h){return Qs(h,a)}}function ol(a,h,m,w){var I=w?zx:vn,R=-1,D=h.length,X=a;for(a===h&&(h=Ke(h)),m&&(X=ue(a,ri(m)));++R<D;)for(var H=0,nt=h[R],rt=m?m(nt):nt;(H=I(X,rt,H,w))>-1;)X!==a&&ea.call(X,H,1),ea.call(a,H,1);return a}function of(a,h){for(var m=a?h.length:0,w=m-1;m--;){var I=h[m];if(m==w||I!==R){var R=I;fs(I)?ea.call(a,I,1):ul(a,I)}}return a}function ll(a,h){return a+na(Uu()*(h-a+1))}function _b(a,h,m,w){for(var I=-1,R=Ce(sa((h-a)/(m||1)),0),D=Q(R);R--;)D[w?R:++I]=a,a+=m;return D}function hl(a,h){var m="";if(!a||h<1||h>Y)return m;do h%2&&(m+=a),h=na(h/2),h&&(a+=a);while(h);return m}function Yt(a,h){return Tl(Df(a,h,Je),a+"")}function wb(a){return zu(Bn(a))}function vb(a,h){var m=Bn(a);return wa(m,Zs(h,0,m.length))}function mr(a,h,m,w){if(!de(a))return a;h=Fs(h,a);for(var I=-1,R=h.length,D=R-1,X=a;X!=null&&++I<R;){var H=qi(h[I]),nt=m;if(H==="__proto__"||H==="constructor"||H==="prototype")return a;if(I!=D){var rt=X[H];nt=w?w(rt,H,X):e,nt===e&&(nt=de(rt)?rt:fs(h[I+1])?[]:{})}ur(X,H,nt),X=X[H]}return a}var lf=ra?function(a,h){return ra.set(a,h),a}:Je,Sb=ia?function(a,h){return ia(a,"toString",{configurable:!0,enumerable:!1,value:Ol(h),writable:!0})}:Je;function Ab(a){return wa(Bn(a))}function _i(a,h,m){var w=-1,I=a.length;h<0&&(h=-h>I?0:I+h),m=m>I?I:m,m<0&&(m+=I),I=h>m?0:m-h>>>0,h>>>=0;for(var R=Q(I);++w<I;)R[w]=a[w+h];return R}function Cb(a,h){var m;return Es(a,function(w,I,R){return m=h(w,I,R),!m}),!!m}function fa(a,h,m){var w=0,I=a==null?w:a.length;if(typeof h=="number"&&h===h&&I<=Z){for(;w<I;){var R=w+I>>>1,D=a[R];D!==null&&!oi(D)&&(m?D<=h:D<h)?w=R+1:I=R}return I}return cl(a,h,Je,m)}function cl(a,h,m,w){var I=0,R=a==null?0:a.length;if(R===0)return 0;h=m(h);for(var D=h!==h,X=h===null,H=oi(h),nt=h===e;I<R;){var rt=na((I+R)/2),ht=m(a[rt]),pt=ht!==e,yt=ht===null,Tt=ht===ht,Lt=oi(ht);if(D)var Mt=w||Tt;else nt?Mt=Tt&&(w||pt):X?Mt=Tt&&pt&&(w||!yt):H?Mt=Tt&&pt&&!yt&&(w||!Lt):yt||Lt?Mt=!1:Mt=w?ht<=h:ht<h;Mt?I=rt+1:R=rt}return Xe(R,tt)}function hf(a,h){for(var m=-1,w=a.length,I=0,R=[];++m<w;){var D=a[m],X=h?h(D):D;if(!m||!Ri(X,H)){var H=X;R[I++]=D===0?0:D}}return R}function cf(a){return typeof a=="number"?a:oi(a)?q:+a}function ai(a){if(typeof a=="string")return a;if(Rt(a))return ue(a,ai)+"";if(oi(a))return Xu?Xu.call(a):"";var h=a+"";return h=="0"&&1/a==-1/0?"-0":h}function Rs(a,h,m){var w=-1,I=Vr,R=a.length,D=!0,X=[],H=X;if(m)D=!1,I=No;else if(R>=s){var nt=h?null:Ob(a);if(nt)return Hr(nt);D=!1,I=rr,H=new Ks}else H=h?[]:X;t:for(;++w<R;){var rt=a[w],ht=h?h(rt):rt;if(rt=m||rt!==0?rt:0,D&&ht===ht){for(var pt=H.length;pt--;)if(H[pt]===ht)continue t;h&&H.push(ht),X.push(rt)}else I(H,ht,m)||(H!==X&&H.push(ht),X.push(rt))}return X}function ul(a,h){return h=Fs(h,a),a=Yf(a,h),a==null||delete a[qi(wi(h))]}function uf(a,h,m,w){return mr(a,h,m(Qs(a,h)),w)}function da(a,h,m,w){for(var I=a.length,R=w?I:-1;(w?R--:++R<I)&&h(a[R],R,a););return m?_i(a,w?0:R,w?R+1:I):_i(a,w?R+1:0,w?I:R)}function ff(a,h){var m=a;return m instanceof Ut&&(m=m.value()),Uo(h,function(w,I){return I.func.apply(I.thisArg,Ps([w],I.args))},m)}function fl(a,h,m){var w=a.length;if(w<2)return w?Rs(a[0]):[];for(var I=-1,R=Q(w);++I<w;)for(var D=a[I],X=-1;++X<w;)X!=I&&(R[I]=fr(R[I]||D,a[X],h,m));return Rs(Ye(R,1),h,m)}function df(a,h,m){for(var w=-1,I=a.length,R=h.length,D={};++w<I;){var X=w<R?h[w]:e;m(D,a[w],X)}return D}function dl(a){return _e(a)?a:[]}function pl(a){return typeof a=="function"?a:Je}function Fs(a,h){return Rt(a)?a:Sl(a,h)?[a]:Wf(Zt(a))}var Tb=Yt;function Bs(a,h,m){var w=a.length;return m=m===e?w:m,!h&&m>=w?a:_i(a,h,m)}var pf=dy||function(a){return De.clearTimeout(a)};function mf(a,h){if(h)return a.slice();var m=a.length,w=Lu?Lu(m):new a.constructor(m);return a.copy(w),w}function ml(a){var h=new a.constructor(a.byteLength);return new Jr(h).set(new Jr(a)),h}function Mb(a,h){var m=h?ml(a.buffer):a.buffer;return new a.constructor(m,a.byteOffset,a.byteLength)}function Pb(a){var h=new a.constructor(a.source,Zc.exec(a));return h.lastIndex=a.lastIndex,h}function Ib(a){return cr?te(cr.call(a)):{}}function gf(a,h){var m=h?ml(a.buffer):a.buffer;return new a.constructor(m,a.byteOffset,a.length)}function xf(a,h){if(a!==h){var m=a!==e,w=a===null,I=a===a,R=oi(a),D=h!==e,X=h===null,H=h===h,nt=oi(h);if(!X&&!nt&&!R&&a>h||R&&D&&H&&!X&&!nt||w&&D&&H||!m&&H||!I)return 1;if(!w&&!R&&!nt&&a<h||nt&&m&&I&&!w&&!R||X&&m&&I||!D&&I||!H)return-1}return 0}function kb(a,h,m){for(var w=-1,I=a.criteria,R=h.criteria,D=I.length,X=m.length;++w<D;){var H=xf(I[w],R[w]);if(H){if(w>=X)return H;var nt=m[w];return H*(nt=="desc"?-1:1)}}return a.index-h.index}function yf(a,h,m,w){for(var I=-1,R=a.length,D=m.length,X=-1,H=h.length,nt=Ce(R-D,0),rt=Q(H+nt),ht=!w;++X<H;)rt[X]=h[X];for(;++I<D;)(ht||I<R)&&(rt[m[I]]=a[I]);for(;nt--;)rt[X++]=a[I++];return rt}function bf(a,h,m,w){for(var I=-1,R=a.length,D=-1,X=m.length,H=-1,nt=h.length,rt=Ce(R-X,0),ht=Q(rt+nt),pt=!w;++I<rt;)ht[I]=a[I];for(var yt=I;++H<nt;)ht[yt+H]=h[H];for(;++D<X;)(pt||I<R)&&(ht[yt+m[D]]=a[I++]);return ht}function Ke(a,h){var m=-1,w=a.length;for(h||(h=Q(w));++m<w;)h[m]=a[m];return h}function Hi(a,h,m,w){var I=!m;m||(m={});for(var R=-1,D=h.length;++R<D;){var X=h[R],H=w?w(m[X],a[X],X,m,a):e;H===e&&(H=a[X]),I?hs(m,X,H):ur(m,X,H)}return m}function Eb(a,h){return Hi(a,vl(a),h)}function Rb(a,h){return Hi(a,Rf(a),h)}function pa(a,h){return function(m,w){var I=Rt(m)?Dx:tb,R=h?h():{};return I(m,a,At(w,2),R)}}function kn(a){return Yt(function(h,m){var w=-1,I=m.length,R=I>1?m[I-1]:e,D=I>2?m[2]:e;for(R=a.length>3&&typeof R=="function"?(I--,R):e,D&&He(m[0],m[1],D)&&(R=I<3?e:R,I=1),h=te(h);++w<I;){var X=m[w];X&&a(h,X,w,R)}return h})}function _f(a,h){return function(m,w){if(m==null)return m;if(!Ze(m))return a(m,w);for(var I=m.length,R=h?I:-1,D=te(m);(h?R--:++R<I)&&w(D[R],R,D)!==!1;);return m}}function wf(a){return function(h,m,w){for(var I=-1,R=te(h),D=w(h),X=D.length;X--;){var H=D[a?X:++I];if(m(R[H],H,R)===!1)break}return h}}function Fb(a,h,m){var w=h&b,I=gr(a);function R(){var D=this&&this!==De&&this instanceof R?I:a;return D.apply(w?m:this,arguments)}return R}function vf(a){return function(h){h=Zt(h);var m=Sn(h)?ki(h):e,w=m?m[0]:h.charAt(0),I=m?Bs(m,1).join(""):h.slice(1);return w[a]()+I}}function En(a){return function(h){return Uo(_d(bd(h).replace(Sx,"")),a,"")}}function gr(a){return function(){var h=arguments;switch(h.length){case 0:return new a;case 1:return new a(h[0]);case 2:return new a(h[0],h[1]);case 3:return new a(h[0],h[1],h[2]);case 4:return new a(h[0],h[1],h[2],h[3]);case 5:return new a(h[0],h[1],h[2],h[3],h[4]);case 6:return new a(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new a(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=In(a.prototype),w=a.apply(m,h);return de(w)?w:m}}function Bb(a,h,m){var w=gr(a);function I(){for(var R=arguments.length,D=Q(R),X=R,H=Rn(I);X--;)D[X]=arguments[X];var nt=R<3&&D[0]!==H&&D[R-1]!==H?[]:Is(D,H);if(R-=nt.length,R<m)return Mf(a,h,ma,I.placeholder,e,D,nt,e,e,m-R);var rt=this&&this!==De&&this instanceof I?w:a;return ni(rt,this,D)}return I}function Sf(a){return function(h,m,w){var I=te(h);if(!Ze(h)){var R=At(m,3);h=Ie(h),m=function(X){return R(I[X],X,I)}}var D=a(h,m,w);return D>-1?I[R?h[D]:D]:e}}function Af(a){return us(function(h){var m=h.length,w=m,I=yi.prototype.thru;for(a&&h.reverse();w--;){var R=h[w];if(typeof R!="function")throw new xi(o);if(I&&!D&&ba(R)=="wrapper")var D=new yi([],!0)}for(w=D?w:m;++w<m;){R=h[w];var X=ba(R),H=X=="wrapper"?_l(R):e;H&&Al(H[0])&&H[1]==(P|_|M|B)&&!H[4].length&&H[9]==1?D=D[ba(H[0])].apply(D,H[3]):D=R.length==1&&Al(R)?D[X]():D.thru(R)}return function(){var nt=arguments,rt=nt[0];if(D&&nt.length==1&&Rt(rt))return D.plant(rt).value();for(var ht=0,pt=m?h[ht].apply(this,nt):rt;++ht<m;)pt=h[ht].call(this,pt);return pt}})}function ma(a,h,m,w,I,R,D,X,H,nt){var rt=h&P,ht=h&b,pt=h&v,yt=h&(_|S),Tt=h&O,Lt=pt?e:gr(a);function Mt(){for(var Nt=arguments.length,Wt=Q(Nt),li=Nt;li--;)Wt[li]=arguments[li];if(yt)var qe=Rn(Mt),hi=$x(Wt,qe);if(w&&(Wt=yf(Wt,w,I,yt)),R&&(Wt=bf(Wt,R,D,yt)),Nt-=hi,yt&&Nt<nt){var we=Is(Wt,qe);return Mf(a,h,ma,Mt.placeholder,m,Wt,we,X,H,nt-Nt)}var Fi=ht?m:this,ms=pt?Fi[a]:a;return Nt=Wt.length,X?Wt=t_(Wt,X):Tt&&Nt>1&&Wt.reverse(),rt&&H<Nt&&(Wt.length=H),this&&this!==De&&this instanceof Mt&&(ms=Lt||gr(ms)),ms.apply(Fi,Wt)}return Mt}function Cf(a,h){return function(m,w){return lb(m,a,h(w),{})}}function ga(a,h){return function(m,w){var I;if(m===e&&w===e)return h;if(m!==e&&(I=m),w!==e){if(I===e)return w;typeof m=="string"||typeof w=="string"?(m=ai(m),w=ai(w)):(m=cf(m),w=cf(w)),I=a(m,w)}return I}}function gl(a){return us(function(h){return h=ue(h,ri(At())),Yt(function(m){var w=this;return a(h,function(I){return ni(I,w,m)})})})}function xa(a,h){h=h===e?" ":ai(h);var m=h.length;if(m<2)return m?hl(h,a):h;var w=hl(h,sa(a/An(h)));return Sn(h)?Bs(ki(w),0,a).join(""):w.slice(0,a)}function Lb(a,h,m,w){var I=h&b,R=gr(a);function D(){for(var X=-1,H=arguments.length,nt=-1,rt=w.length,ht=Q(rt+H),pt=this&&this!==De&&this instanceof D?R:a;++nt<rt;)ht[nt]=w[nt];for(;H--;)ht[nt++]=arguments[++X];return ni(pt,I?m:this,ht)}return D}function Tf(a){return function(h,m,w){return w&&typeof w!="number"&&He(h,m,w)&&(m=w=e),h=ps(h),m===e?(m=h,h=0):m=ps(m),w=w===e?h<m?1:-1:ps(w),_b(h,m,w,a)}}function ya(a){return function(h,m){return typeof h=="string"&&typeof m=="string"||(h=vi(h),m=vi(m)),a(h,m)}}function Mf(a,h,m,w,I,R,D,X,H,nt){var rt=h&_,ht=rt?D:e,pt=rt?e:D,yt=rt?R:e,Tt=rt?e:R;h|=rt?M:T,h&=~(rt?T:M),h&C||(h&=-4);var Lt=[a,h,I,yt,ht,Tt,pt,X,H,nt],Mt=m.apply(e,Lt);return Al(a)&&Nf(Mt,Lt),Mt.placeholder=w,Uf(Mt,a,h)}function xl(a){var h=Ae[a];return function(m,w){if(m=vi(m),w=w==null?0:Xe(Ft(w),292),w&&Nu(m)){var I=(Zt(m)+"e").split("e"),R=h(I[0]+"e"+(+I[1]+w));return I=(Zt(R)+"e").split("e"),+(I[0]+"e"+(+I[1]-w))}return h(m)}}var Ob=Mn&&1/Hr(new Mn([,-0]))[1]==L?function(a){return new Mn(a)}:Nl;function Pf(a){return function(h){var m=We(h);return m==Kt?Ho(h):m==be?Jx(h):Vx(h,a(h))}}function cs(a,h,m,w,I,R,D,X){var H=h&v;if(!H&&typeof a!="function")throw new xi(o);var nt=w?w.length:0;if(nt||(h&=-97,w=I=e),D=D===e?D:Ce(Ft(D),0),X=X===e?X:Ft(X),nt-=I?I.length:0,h&T){var rt=w,ht=I;w=I=e}var pt=H?e:_l(a),yt=[a,h,m,w,I,rt,ht,R,D,X];if(pt&&Zb(yt,pt),a=yt[0],h=yt[1],m=yt[2],w=yt[3],I=yt[4],X=yt[9]=yt[9]===e?H?0:a.length:Ce(yt[9]-nt,0),!X&&h&(_|S)&&(h&=-25),!h||h==b)var Tt=Fb(a,h,m);else h==_||h==S?Tt=Bb(a,h,X):(h==M||h==(b|M))&&!I.length?Tt=Lb(a,h,m,w):Tt=ma.apply(e,yt);var Lt=pt?lf:Nf;return Uf(Lt(Tt,yt),a,h)}function If(a,h,m,w){return a===e||Ri(a,Tn[m])&&!Qt.call(w,m)?h:a}function kf(a,h,m,w,I,R){return de(a)&&de(h)&&(R.set(h,a),ua(a,h,e,kf,R),R.delete(h)),a}function Db(a){return br(a)?e:a}function Ef(a,h,m,w,I,R){var D=m&x,X=a.length,H=h.length;if(X!=H&&!(D&&H>X))return!1;var nt=R.get(a),rt=R.get(h);if(nt&&rt)return nt==h&&rt==a;var ht=-1,pt=!0,yt=m&y?new Ks:e;for(R.set(a,h),R.set(h,a);++ht<X;){var Tt=a[ht],Lt=h[ht];if(w)var Mt=D?w(Lt,Tt,ht,h,a,R):w(Tt,Lt,ht,a,h,R);if(Mt!==e){if(Mt)continue;pt=!1;break}if(yt){if(!Xo(h,function(Nt,Wt){if(!rr(yt,Wt)&&(Tt===Nt||I(Tt,Nt,m,w,R)))return yt.push(Wt)})){pt=!1;break}}else if(!(Tt===Lt||I(Tt,Lt,m,w,R))){pt=!1;break}}return R.delete(a),R.delete(h),pt}function Yb(a,h,m,w,I,R,D){switch(m){case as:if(a.byteLength!=h.byteLength||a.byteOffset!=h.byteOffset)return!1;a=a.buffer,h=h.buffer;case $s:return!(a.byteLength!=h.byteLength||!R(new Jr(a),new Jr(h)));case gt:case It:case St:return Ri(+a,+h);case ee:return a.name==h.name&&a.message==h.message;case Vi:case ii:return a==h+"";case Kt:var X=Ho;case be:var H=w&x;if(X||(X=Hr),a.size!=h.size&&!H)return!1;var nt=D.get(a);if(nt)return nt==h;w|=y,D.set(a,h);var rt=Ef(X(a),X(h),w,I,R,D);return D.delete(a),rt;case rs:if(cr)return cr.call(a)==cr.call(h)}return!1}function Nb(a,h,m,w,I,R){var D=m&x,X=yl(a),H=X.length,nt=yl(h),rt=nt.length;if(H!=rt&&!D)return!1;for(var ht=H;ht--;){var pt=X[ht];if(!(D?pt in h:Qt.call(h,pt)))return!1}var yt=R.get(a),Tt=R.get(h);if(yt&&Tt)return yt==h&&Tt==a;var Lt=!0;R.set(a,h),R.set(h,a);for(var Mt=D;++ht<H;){pt=X[ht];var Nt=a[pt],Wt=h[pt];if(w)var li=D?w(Wt,Nt,pt,h,a,R):w(Nt,Wt,pt,a,h,R);if(!(li===e?Nt===Wt||I(Nt,Wt,m,w,R):li)){Lt=!1;break}Mt||(Mt=pt=="constructor")}if(Lt&&!Mt){var qe=a.constructor,hi=h.constructor;qe!=hi&&"constructor"in a&&"constructor"in h&&!(typeof qe=="function"&&qe instanceof qe&&typeof hi=="function"&&hi instanceof hi)&&(Lt=!1)}return R.delete(a),R.delete(h),Lt}function us(a){return Tl(Df(a,e,$f),a+"")}function yl(a){return Ku(a,Ie,vl)}function bl(a){return Ku(a,Qe,Rf)}var _l=ra?function(a){return ra.get(a)}:Nl;function ba(a){for(var h=a.name+"",m=Pn[h],w=Qt.call(Pn,h)?m.length:0;w--;){var I=m[w],R=I.func;if(R==null||R==a)return I.name}return h}function Rn(a){var h=Qt.call(k,"placeholder")?k:a;return h.placeholder}function At(){var a=k.iteratee||Dl;return a=a===Dl?Ju:a,arguments.length?a(arguments[0],arguments[1]):a}function _a(a,h){var m=a.__data__;return Hb(h)?m[typeof h=="string"?"string":"hash"]:m.map}function wl(a){for(var h=Ie(a),m=h.length;m--;){var w=h[m],I=a[w];h[m]=[w,I,Lf(I)]}return h}function Js(a,h){var m=Kx(a,h);return Qu(m)?m:e}function Ub(a){var h=Qt.call(a,qs),m=a[qs];try{a[qs]=e;var w=!0}catch{}var I=Zr.call(a);return w&&(h?a[qs]=m:delete a[qs]),I}var vl=jo?function(a){return a==null?[]:(a=te(a),Ms(jo(a),function(h){return Du.call(a,h)}))}:Ul,Rf=jo?function(a){for(var h=[];a;)Ps(h,vl(a)),a=ta(a);return h}:Ul,We=$e;(Ko&&We(new Ko(new ArrayBuffer(1)))!=as||or&&We(new or)!=Kt||Zo&&We(Zo.resolve())!=Ii||Mn&&We(new Mn)!=be||lr&&We(new lr)!=Vs)&&(We=function(a){var h=$e(a),m=h==Le?a.constructor:e,w=m?tn(m):"";if(w)switch(w){case vy:return as;case Sy:return Kt;case Ay:return Ii;case Cy:return be;case Ty:return Vs}return h});function Xb(a,h,m){for(var w=-1,I=m.length;++w<I;){var R=m[w],D=R.size;switch(R.type){case"drop":a+=D;break;case"dropRight":h-=D;break;case"take":h=Xe(h,a+D);break;case"takeRight":a=Ce(a,h-D);break}}return{start:a,end:h}}function Wb(a){var h=a.match(q0);return h?h[1].split(j0):[]}function Ff(a,h,m){h=Fs(h,a);for(var w=-1,I=h.length,R=!1;++w<I;){var D=qi(h[w]);if(!(R=a!=null&&m(a,D)))break;a=a[D]}return R||++w!=I?R:(I=a==null?0:a.length,!!I&&Ma(I)&&fs(D,I)&&(Rt(a)||en(a)))}function zb(a){var h=a.length,m=new a.constructor(h);return h&&typeof a[0]=="string"&&Qt.call(a,"index")&&(m.index=a.index,m.input=a.input),m}function Bf(a){return typeof a.constructor=="function"&&!xr(a)?In(ta(a)):{}}function Gb(a,h,m){var w=a.constructor;switch(h){case $s:return ml(a);case gt:case It:return new w(+a);case as:return Mb(a,m);case bn:case pi:case _n:case F:case z:case ot:case st:case ut:case xt:return gf(a,m);case Kt:return new w;case St:case ii:return new w(a);case Vi:return Pb(a);case be:return new w;case rs:return Ib(a)}}function Vb(a,h){var m=h.length;if(!m)return a;var w=m-1;return h[w]=(m>1?"& ":"")+h[w],h=h.join(m>2?", ":" "),a.replace(H0,`{
/* [wrapped with `+h+`] */
`)}function $b(a){return Rt(a)||en(a)||!!(Yu&&a&&a[Yu])}function fs(a,h){var m=typeof a;return h=h??Y,!!h&&(m=="number"||m!="symbol"&&nx.test(a))&&a>-1&&a%1==0&&a<h}function He(a,h,m){if(!de(m))return!1;var w=typeof h;return(w=="number"?Ze(m)&&fs(h,m.length):w=="string"&&h in m)?Ri(m[h],a):!1}function Sl(a,h){if(Rt(a))return!1;var m=typeof a;return m=="number"||m=="symbol"||m=="boolean"||a==null||oi(a)?!0:z0.test(a)||!W0.test(a)||h!=null&&a in te(h)}function Hb(a){var h=typeof a;return h=="string"||h=="number"||h=="symbol"||h=="boolean"?a!=="__proto__":a===null}function Al(a){var h=ba(a),m=k[h];if(typeof m!="function"||!(h in Ut.prototype))return!1;if(a===m)return!0;var w=_l(m);return!!w&&a===w[0]}function qb(a){return!!Bu&&Bu in a}var jb=jr?ds:Xl;function xr(a){var h=a&&a.constructor,m=typeof h=="function"&&h.prototype||Tn;return a===m}function Lf(a){return a===a&&!de(a)}function Of(a,h){return function(m){return m==null?!1:m[a]===h&&(h!==e||a in te(m))}}function Kb(a){var h=Ca(a,function(w){return m.size===c&&m.clear(),w}),m=h.cache;return h}function Zb(a,h){var m=a[1],w=h[1],I=m|w,R=I<(b|v|P),D=w==P&&m==_||w==P&&m==B&&a[7].length<=h[8]||w==(P|B)&&h[7].length<=h[8]&&m==_;if(!(R||D))return a;w&b&&(a[2]=h[2],I|=m&b?0:C);var X=h[3];if(X){var H=a[3];a[3]=H?yf(H,X,h[4]):X,a[4]=H?Is(a[3],f):h[4]}return X=h[5],X&&(H=a[5],a[5]=H?bf(H,X,h[6]):X,a[6]=H?Is(a[5],f):h[6]),X=h[7],X&&(a[7]=X),w&P&&(a[8]=a[8]==null?h[8]:Xe(a[8],h[8])),a[9]==null&&(a[9]=h[9]),a[0]=h[0],a[1]=I,a}function Qb(a){var h=[];if(a!=null)for(var m in te(a))h.push(m);return h}function Jb(a){return Zr.call(a)}function Df(a,h,m){return h=Ce(h===e?a.length-1:h,0),function(){for(var w=arguments,I=-1,R=Ce(w.length-h,0),D=Q(R);++I<R;)D[I]=w[h+I];I=-1;for(var X=Q(h+1);++I<h;)X[I]=w[I];return X[h]=m(D),ni(a,this,X)}}function Yf(a,h){return h.length<2?a:Qs(a,_i(h,0,-1))}function t_(a,h){for(var m=a.length,w=Xe(h.length,m),I=Ke(a);w--;){var R=h[w];a[w]=fs(R,m)?I[R]:e}return a}function Cl(a,h){if(!(h==="constructor"&&typeof a[h]=="function")&&h!="__proto__")return a[h]}var Nf=Xf(lf),yr=my||function(a,h){return De.setTimeout(a,h)},Tl=Xf(Sb);function Uf(a,h,m){var w=h+"";return Tl(a,Vb(w,e_(Wb(w),m)))}function Xf(a){var h=0,m=0;return function(){var w=by(),I=K-(w-m);if(m=w,I>0){if(++h>=et)return arguments[0]}else h=0;return a.apply(e,arguments)}}function wa(a,h){var m=-1,w=a.length,I=w-1;for(h=h===e?w:h;++m<h;){var R=ll(m,I),D=a[R];a[R]=a[m],a[m]=D}return a.length=h,a}var Wf=Kb(function(a){var h=[];return a.charCodeAt(0)===46&&h.push(""),a.replace(G0,function(m,w,I,R){h.push(I?R.replace(Q0,"$1"):w||m)}),h});function qi(a){if(typeof a=="string"||oi(a))return a;var h=a+"";return h=="0"&&1/a==-1/0?"-0":h}function tn(a){if(a!=null){try{return Kr.call(a)}catch{}try{return a+""}catch{}}return""}function e_(a,h){return gi(ct,function(m){var w="_."+m[0];h&m[1]&&!Vr(a,w)&&a.push(w)}),a.sort()}function zf(a){if(a instanceof Ut)return a.clone();var h=new yi(a.__wrapped__,a.__chain__);return h.__actions__=Ke(a.__actions__),h.__index__=a.__index__,h.__values__=a.__values__,h}function i_(a,h,m){(m?He(a,h,m):h===e)?h=1:h=Ce(Ft(h),0);var w=a==null?0:a.length;if(!w||h<1)return[];for(var I=0,R=0,D=Q(sa(w/h));I<w;)D[R++]=_i(a,I,I+=h);return D}function s_(a){for(var h=-1,m=a==null?0:a.length,w=0,I=[];++h<m;){var R=a[h];R&&(I[w++]=R)}return I}function n_(){var a=arguments.length;if(!a)return[];for(var h=Q(a-1),m=arguments[0],w=a;w--;)h[w-1]=arguments[w];return Ps(Rt(m)?Ke(m):[m],Ye(h,1))}var r_=Yt(function(a,h){return _e(a)?fr(a,Ye(h,1,_e,!0)):[]}),a_=Yt(function(a,h){var m=wi(h);return _e(m)&&(m=e),_e(a)?fr(a,Ye(h,1,_e,!0),At(m,2)):[]}),o_=Yt(function(a,h){var m=wi(h);return _e(m)&&(m=e),_e(a)?fr(a,Ye(h,1,_e,!0),e,m):[]});function l_(a,h,m){var w=a==null?0:a.length;return w?(h=m||h===e?1:Ft(h),_i(a,h<0?0:h,w)):[]}function h_(a,h,m){var w=a==null?0:a.length;return w?(h=m||h===e?1:Ft(h),h=w-h,_i(a,0,h<0?0:h)):[]}function c_(a,h){return a&&a.length?da(a,At(h,3),!0,!0):[]}function u_(a,h){return a&&a.length?da(a,At(h,3),!0):[]}function f_(a,h,m,w){var I=a==null?0:a.length;return I?(m&&typeof m!="number"&&He(a,h,m)&&(m=0,w=I),nb(a,h,m,w)):[]}function Gf(a,h,m){var w=a==null?0:a.length;if(!w)return-1;var I=m==null?0:Ft(m);return I<0&&(I=Ce(w+I,0)),$r(a,At(h,3),I)}function Vf(a,h,m){var w=a==null?0:a.length;if(!w)return-1;var I=w-1;return m!==e&&(I=Ft(m),I=m<0?Ce(w+I,0):Xe(I,w-1)),$r(a,At(h,3),I,!0)}function $f(a){var h=a==null?0:a.length;return h?Ye(a,1):[]}function d_(a){var h=a==null?0:a.length;return h?Ye(a,L):[]}function p_(a,h){var m=a==null?0:a.length;return m?(h=h===e?1:Ft(h),Ye(a,h)):[]}function m_(a){for(var h=-1,m=a==null?0:a.length,w={};++h<m;){var I=a[h];w[I[0]]=I[1]}return w}function Hf(a){return a&&a.length?a[0]:e}function g_(a,h,m){var w=a==null?0:a.length;if(!w)return-1;var I=m==null?0:Ft(m);return I<0&&(I=Ce(w+I,0)),vn(a,h,I)}function x_(a){var h=a==null?0:a.length;return h?_i(a,0,-1):[]}var y_=Yt(function(a){var h=ue(a,dl);return h.length&&h[0]===a[0]?sl(h):[]}),b_=Yt(function(a){var h=wi(a),m=ue(a,dl);return h===wi(m)?h=e:m.pop(),m.length&&m[0]===a[0]?sl(m,At(h,2)):[]}),__=Yt(function(a){var h=wi(a),m=ue(a,dl);return h=typeof h=="function"?h:e,h&&m.pop(),m.length&&m[0]===a[0]?sl(m,e,h):[]});function w_(a,h){return a==null?"":xy.call(a,h)}function wi(a){var h=a==null?0:a.length;return h?a[h-1]:e}function v_(a,h,m){var w=a==null?0:a.length;if(!w)return-1;var I=w;return m!==e&&(I=Ft(m),I=I<0?Ce(w+I,0):Xe(I,w-1)),h===h?ey(a,h,I):$r(a,Tu,I,!0)}function S_(a,h){return a&&a.length?nf(a,Ft(h)):e}var A_=Yt(qf);function qf(a,h){return a&&a.length&&h&&h.length?ol(a,h):a}function C_(a,h,m){return a&&a.length&&h&&h.length?ol(a,h,At(m,2)):a}function T_(a,h,m){return a&&a.length&&h&&h.length?ol(a,h,e,m):a}var M_=us(function(a,h){var m=a==null?0:a.length,w=Jo(a,h);return of(a,ue(h,function(I){return fs(I,m)?+I:I}).sort(xf)),w});function P_(a,h){var m=[];if(!(a&&a.length))return m;var w=-1,I=[],R=a.length;for(h=At(h,3);++w<R;){var D=a[w];h(D,w,a)&&(m.push(D),I.push(w))}return of(a,I),m}function Ml(a){return a==null?a:wy.call(a)}function I_(a,h,m){var w=a==null?0:a.length;return w?(m&&typeof m!="number"&&He(a,h,m)?(h=0,m=w):(h=h==null?0:Ft(h),m=m===e?w:Ft(m)),_i(a,h,m)):[]}function k_(a,h){return fa(a,h)}function E_(a,h,m){return cl(a,h,At(m,2))}function R_(a,h){var m=a==null?0:a.length;if(m){var w=fa(a,h);if(w<m&&Ri(a[w],h))return w}return-1}function F_(a,h){return fa(a,h,!0)}function B_(a,h,m){return cl(a,h,At(m,2),!0)}function L_(a,h){var m=a==null?0:a.length;if(m){var w=fa(a,h,!0)-1;if(Ri(a[w],h))return w}return-1}function O_(a){return a&&a.length?hf(a):[]}function D_(a,h){return a&&a.length?hf(a,At(h,2)):[]}function Y_(a){var h=a==null?0:a.length;return h?_i(a,1,h):[]}function N_(a,h,m){return a&&a.length?(h=m||h===e?1:Ft(h),_i(a,0,h<0?0:h)):[]}function U_(a,h,m){var w=a==null?0:a.length;return w?(h=m||h===e?1:Ft(h),h=w-h,_i(a,h<0?0:h,w)):[]}function X_(a,h){return a&&a.length?da(a,At(h,3),!1,!0):[]}function W_(a,h){return a&&a.length?da(a,At(h,3)):[]}var z_=Yt(function(a){return Rs(Ye(a,1,_e,!0))}),G_=Yt(function(a){var h=wi(a);return _e(h)&&(h=e),Rs(Ye(a,1,_e,!0),At(h,2))}),V_=Yt(function(a){var h=wi(a);return h=typeof h=="function"?h:e,Rs(Ye(a,1,_e,!0),e,h)});function $_(a){return a&&a.length?Rs(a):[]}function H_(a,h){return a&&a.length?Rs(a,At(h,2)):[]}function q_(a,h){return h=typeof h=="function"?h:e,a&&a.length?Rs(a,e,h):[]}function Pl(a){if(!(a&&a.length))return[];var h=0;return a=Ms(a,function(m){if(_e(m))return h=Ce(m.length,h),!0}),Vo(h,function(m){return ue(a,Wo(m))})}function jf(a,h){if(!(a&&a.length))return[];var m=Pl(a);return h==null?m:ue(m,function(w){return ni(h,e,w)})}var j_=Yt(function(a,h){return _e(a)?fr(a,h):[]}),K_=Yt(function(a){return fl(Ms(a,_e))}),Z_=Yt(function(a){var h=wi(a);return _e(h)&&(h=e),fl(Ms(a,_e),At(h,2))}),Q_=Yt(function(a){var h=wi(a);return h=typeof h=="function"?h:e,fl(Ms(a,_e),e,h)}),J_=Yt(Pl);function t1(a,h){return df(a||[],h||[],ur)}function e1(a,h){return df(a||[],h||[],mr)}var i1=Yt(function(a){var h=a.length,m=h>1?a[h-1]:e;return m=typeof m=="function"?(a.pop(),m):e,jf(a,m)});function Kf(a){var h=k(a);return h.__chain__=!0,h}function s1(a,h){return h(a),a}function va(a,h){return h(a)}var n1=us(function(a){var h=a.length,m=h?a[0]:0,w=this.__wrapped__,I=function(R){return Jo(R,a)};return h>1||this.__actions__.length||!(w instanceof Ut)||!fs(m)?this.thru(I):(w=w.slice(m,+m+(h?1:0)),w.__actions__.push({func:va,args:[I],thisArg:e}),new yi(w,this.__chain__).thru(function(R){return h&&!R.length&&R.push(e),R}))});function r1(){return Kf(this)}function a1(){return new yi(this.value(),this.__chain__)}function o1(){this.__values__===e&&(this.__values__=cd(this.value()));var a=this.__index__>=this.__values__.length,h=a?e:this.__values__[this.__index__++];return{done:a,value:h}}function l1(){return this}function h1(a){for(var h,m=this;m instanceof oa;){var w=zf(m);w.__index__=0,w.__values__=e,h?I.__wrapped__=w:h=w;var I=w;m=m.__wrapped__}return I.__wrapped__=a,h}function c1(){var a=this.__wrapped__;if(a instanceof Ut){var h=a;return this.__actions__.length&&(h=new Ut(this)),h=h.reverse(),h.__actions__.push({func:va,args:[Ml],thisArg:e}),new yi(h,this.__chain__)}return this.thru(Ml)}function u1(){return ff(this.__wrapped__,this.__actions__)}var f1=pa(function(a,h,m){Qt.call(a,m)?++a[m]:hs(a,m,1)});function d1(a,h,m){var w=Rt(a)?Au:sb;return m&&He(a,h,m)&&(h=e),w(a,At(h,3))}function p1(a,h){var m=Rt(a)?Ms:qu;return m(a,At(h,3))}var m1=Sf(Gf),g1=Sf(Vf);function x1(a,h){return Ye(Sa(a,h),1)}function y1(a,h){return Ye(Sa(a,h),L)}function b1(a,h,m){return m=m===e?1:Ft(m),Ye(Sa(a,h),m)}function Zf(a,h){var m=Rt(a)?gi:Es;return m(a,At(h,3))}function Qf(a,h){var m=Rt(a)?Yx:Hu;return m(a,At(h,3))}var _1=pa(function(a,h,m){Qt.call(a,m)?a[m].push(h):hs(a,m,[h])});function w1(a,h,m,w){a=Ze(a)?a:Bn(a),m=m&&!w?Ft(m):0;var I=a.length;return m<0&&(m=Ce(I+m,0)),Pa(a)?m<=I&&a.indexOf(h,m)>-1:!!I&&vn(a,h,m)>-1}var v1=Yt(function(a,h,m){var w=-1,I=typeof h=="function",R=Ze(a)?Q(a.length):[];return Es(a,function(D){R[++w]=I?ni(h,D,m):dr(D,h,m)}),R}),S1=pa(function(a,h,m){hs(a,m,h)});function Sa(a,h){var m=Rt(a)?ue:tf;return m(a,At(h,3))}function A1(a,h,m,w){return a==null?[]:(Rt(h)||(h=h==null?[]:[h]),m=w?e:m,Rt(m)||(m=m==null?[]:[m]),rf(a,h,m))}var C1=pa(function(a,h,m){a[m?0:1].push(h)},function(){return[[],[]]});function T1(a,h,m){var w=Rt(a)?Uo:Pu,I=arguments.length<3;return w(a,At(h,4),m,I,Es)}function M1(a,h,m){var w=Rt(a)?Nx:Pu,I=arguments.length<3;return w(a,At(h,4),m,I,Hu)}function P1(a,h){var m=Rt(a)?Ms:qu;return m(a,Ta(At(h,3)))}function I1(a){var h=Rt(a)?zu:wb;return h(a)}function k1(a,h,m){(m?He(a,h,m):h===e)?h=1:h=Ft(h);var w=Rt(a)?Qy:vb;return w(a,h)}function E1(a){var h=Rt(a)?Jy:Ab;return h(a)}function R1(a){if(a==null)return 0;if(Ze(a))return Pa(a)?An(a):a.length;var h=We(a);return h==Kt||h==be?a.size:rl(a).length}function F1(a,h,m){var w=Rt(a)?Xo:Cb;return m&&He(a,h,m)&&(h=e),w(a,At(h,3))}var B1=Yt(function(a,h){if(a==null)return[];var m=h.length;return m>1&&He(a,h[0],h[1])?h=[]:m>2&&He(h[0],h[1],h[2])&&(h=[h[0]]),rf(a,Ye(h,1),[])}),Aa=py||function(){return De.Date.now()};function L1(a,h){if(typeof h!="function")throw new xi(o);return a=Ft(a),function(){if(--a<1)return h.apply(this,arguments)}}function Jf(a,h,m){return h=m?e:h,h=a&&h==null?a.length:h,cs(a,P,e,e,e,e,h)}function td(a,h){var m;if(typeof h!="function")throw new xi(o);return a=Ft(a),function(){return--a>0&&(m=h.apply(this,arguments)),a<=1&&(h=e),m}}var Il=Yt(function(a,h,m){var w=b;if(m.length){var I=Is(m,Rn(Il));w|=M}return cs(a,w,h,m,I)}),ed=Yt(function(a,h,m){var w=b|v;if(m.length){var I=Is(m,Rn(ed));w|=M}return cs(h,w,a,m,I)});function id(a,h,m){h=m?e:h;var w=cs(a,_,e,e,e,e,e,h);return w.placeholder=id.placeholder,w}function sd(a,h,m){h=m?e:h;var w=cs(a,S,e,e,e,e,e,h);return w.placeholder=sd.placeholder,w}function nd(a,h,m){var w,I,R,D,X,H,nt=0,rt=!1,ht=!1,pt=!0;if(typeof a!="function")throw new xi(o);h=vi(h)||0,de(m)&&(rt=!!m.leading,ht="maxWait"in m,R=ht?Ce(vi(m.maxWait)||0,h):R,pt="trailing"in m?!!m.trailing:pt);function yt(we){var Fi=w,ms=I;return w=I=e,nt=we,D=a.apply(ms,Fi),D}function Tt(we){return nt=we,X=yr(Nt,h),rt?yt(we):D}function Lt(we){var Fi=we-H,ms=we-nt,Sd=h-Fi;return ht?Xe(Sd,R-ms):Sd}function Mt(we){var Fi=we-H,ms=we-nt;return H===e||Fi>=h||Fi<0||ht&&ms>=R}function Nt(){var we=Aa();if(Mt(we))return Wt(we);X=yr(Nt,Lt(we))}function Wt(we){return X=e,pt&&w?yt(we):(w=I=e,D)}function li(){X!==e&&pf(X),nt=0,w=H=I=X=e}function qe(){return X===e?D:Wt(Aa())}function hi(){var we=Aa(),Fi=Mt(we);if(w=arguments,I=this,H=we,Fi){if(X===e)return Tt(H);if(ht)return pf(X),X=yr(Nt,h),yt(H)}return X===e&&(X=yr(Nt,h)),D}return hi.cancel=li,hi.flush=qe,hi}var O1=Yt(function(a,h){return $u(a,1,h)}),D1=Yt(function(a,h,m){return $u(a,vi(h)||0,m)});function Y1(a){return cs(a,O)}function Ca(a,h){if(typeof a!="function"||h!=null&&typeof h!="function")throw new xi(o);var m=function(){var w=arguments,I=h?h.apply(this,w):w[0],R=m.cache;if(R.has(I))return R.get(I);var D=a.apply(this,w);return m.cache=R.set(I,D)||R,D};return m.cache=new(Ca.Cache||ls),m}Ca.Cache=ls;function Ta(a){if(typeof a!="function")throw new xi(o);return function(){var h=arguments;switch(h.length){case 0:return!a.call(this);case 1:return!a.call(this,h[0]);case 2:return!a.call(this,h[0],h[1]);case 3:return!a.call(this,h[0],h[1],h[2])}return!a.apply(this,h)}}function N1(a){return td(2,a)}var U1=Tb(function(a,h){h=h.length==1&&Rt(h[0])?ue(h[0],ri(At())):ue(Ye(h,1),ri(At()));var m=h.length;return Yt(function(w){for(var I=-1,R=Xe(w.length,m);++I<R;)w[I]=h[I].call(this,w[I]);return ni(a,this,w)})}),kl=Yt(function(a,h){var m=Is(h,Rn(kl));return cs(a,M,e,h,m)}),rd=Yt(function(a,h){var m=Is(h,Rn(rd));return cs(a,T,e,h,m)}),X1=us(function(a,h){return cs(a,B,e,e,e,h)});function W1(a,h){if(typeof a!="function")throw new xi(o);return h=h===e?h:Ft(h),Yt(a,h)}function z1(a,h){if(typeof a!="function")throw new xi(o);return h=h==null?0:Ce(Ft(h),0),Yt(function(m){var w=m[h],I=Bs(m,0,h);return w&&Ps(I,w),ni(a,this,I)})}function G1(a,h,m){var w=!0,I=!0;if(typeof a!="function")throw new xi(o);return de(m)&&(w="leading"in m?!!m.leading:w,I="trailing"in m?!!m.trailing:I),nd(a,h,{leading:w,maxWait:h,trailing:I})}function V1(a){return Jf(a,1)}function $1(a,h){return kl(pl(h),a)}function H1(){if(!arguments.length)return[];var a=arguments[0];return Rt(a)?a:[a]}function q1(a){return bi(a,p)}function j1(a,h){return h=typeof h=="function"?h:e,bi(a,p,h)}function K1(a){return bi(a,d|p)}function Z1(a,h){return h=typeof h=="function"?h:e,bi(a,d|p,h)}function Q1(a,h){return h==null||Vu(a,h,Ie(h))}function Ri(a,h){return a===h||a!==a&&h!==h}var J1=ya(il),tw=ya(function(a,h){return a>=h}),en=Zu(function(){return arguments}())?Zu:function(a){return xe(a)&&Qt.call(a,"callee")&&!Du.call(a,"callee")},Rt=Q.isArray,ew=yu?ri(yu):hb;function Ze(a){return a!=null&&Ma(a.length)&&!ds(a)}function _e(a){return xe(a)&&Ze(a)}function iw(a){return a===!0||a===!1||xe(a)&&$e(a)==gt}var Ls=gy||Xl,sw=bu?ri(bu):cb;function nw(a){return xe(a)&&a.nodeType===1&&!br(a)}function rw(a){if(a==null)return!0;if(Ze(a)&&(Rt(a)||typeof a=="string"||typeof a.splice=="function"||Ls(a)||Fn(a)||en(a)))return!a.length;var h=We(a);if(h==Kt||h==be)return!a.size;if(xr(a))return!rl(a).length;for(var m in a)if(Qt.call(a,m))return!1;return!0}function aw(a,h){return pr(a,h)}function ow(a,h,m){m=typeof m=="function"?m:e;var w=m?m(a,h):e;return w===e?pr(a,h,e,m):!!w}function El(a){if(!xe(a))return!1;var h=$e(a);return h==ee||h==wt||typeof a.message=="string"&&typeof a.name=="string"&&!br(a)}function lw(a){return typeof a=="number"&&Nu(a)}function ds(a){if(!de(a))return!1;var h=$e(a);return h==ie||h==Pe||h==Ct||h==As}function ad(a){return typeof a=="number"&&a==Ft(a)}function Ma(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=Y}function de(a){var h=typeof a;return a!=null&&(h=="object"||h=="function")}function xe(a){return a!=null&&typeof a=="object"}var od=_u?ri(_u):fb;function hw(a,h){return a===h||nl(a,h,wl(h))}function cw(a,h,m){return m=typeof m=="function"?m:e,nl(a,h,wl(h),m)}function uw(a){return ld(a)&&a!=+a}function fw(a){if(jb(a))throw new Et(r);return Qu(a)}function dw(a){return a===null}function pw(a){return a==null}function ld(a){return typeof a=="number"||xe(a)&&$e(a)==St}function br(a){if(!xe(a)||$e(a)!=Le)return!1;var h=ta(a);if(h===null)return!0;var m=Qt.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&Kr.call(m)==cy}var Rl=wu?ri(wu):db;function mw(a){return ad(a)&&a>=-9007199254740991&&a<=Y}var hd=vu?ri(vu):pb;function Pa(a){return typeof a=="string"||!Rt(a)&&xe(a)&&$e(a)==ii}function oi(a){return typeof a=="symbol"||xe(a)&&$e(a)==rs}var Fn=Su?ri(Su):mb;function gw(a){return a===e}function xw(a){return xe(a)&&We(a)==Vs}function yw(a){return xe(a)&&$e(a)==Xr}var bw=ya(al),_w=ya(function(a,h){return a<=h});function cd(a){if(!a)return[];if(Ze(a))return Pa(a)?ki(a):Ke(a);if(ar&&a[ar])return Qx(a[ar]());var h=We(a),m=h==Kt?Ho:h==be?Hr:Bn;return m(a)}function ps(a){if(!a)return a===0?a:0;if(a=vi(a),a===L||a===-1/0){var h=a<0?-1:1;return h*W}return a===a?a:0}function Ft(a){var h=ps(a),m=h%1;return h===h?m?h-m:h:0}function ud(a){return a?Zs(Ft(a),0,j):0}function vi(a){if(typeof a=="number")return a;if(oi(a))return q;if(de(a)){var h=typeof a.valueOf=="function"?a.valueOf():a;a=de(h)?h+"":h}if(typeof a!="string")return a===0?a:+a;a=Iu(a);var m=ex.test(a);return m||sx.test(a)?Lx(a.slice(2),m?2:8):tx.test(a)?q:+a}function fd(a){return Hi(a,Qe(a))}function ww(a){return a?Zs(Ft(a),-9007199254740991,Y):a===0?a:0}function Zt(a){return a==null?"":ai(a)}var vw=kn(function(a,h){if(xr(h)||Ze(h)){Hi(h,Ie(h),a);return}for(var m in h)Qt.call(h,m)&&ur(a,m,h[m])}),dd=kn(function(a,h){Hi(h,Qe(h),a)}),Ia=kn(function(a,h,m,w){Hi(h,Qe(h),a,w)}),Sw=kn(function(a,h,m,w){Hi(h,Ie(h),a,w)}),Aw=us(Jo);function Cw(a,h){var m=In(a);return h==null?m:Gu(m,h)}var Tw=Yt(function(a,h){a=te(a);var m=-1,w=h.length,I=w>2?h[2]:e;for(I&&He(h[0],h[1],I)&&(w=1);++m<w;)for(var R=h[m],D=Qe(R),X=-1,H=D.length;++X<H;){var nt=D[X],rt=a[nt];(rt===e||Ri(rt,Tn[nt])&&!Qt.call(a,nt))&&(a[nt]=R[nt])}return a}),Mw=Yt(function(a){return a.push(e,kf),ni(pd,e,a)});function Pw(a,h){return Cu(a,At(h,3),$i)}function Iw(a,h){return Cu(a,At(h,3),el)}function kw(a,h){return a==null?a:tl(a,At(h,3),Qe)}function Ew(a,h){return a==null?a:ju(a,At(h,3),Qe)}function Rw(a,h){return a&&$i(a,At(h,3))}function Fw(a,h){return a&&el(a,At(h,3))}function Bw(a){return a==null?[]:ca(a,Ie(a))}function Lw(a){return a==null?[]:ca(a,Qe(a))}function Fl(a,h,m){var w=a==null?e:Qs(a,h);return w===e?m:w}function Ow(a,h){return a!=null&&Ff(a,h,rb)}function Bl(a,h){return a!=null&&Ff(a,h,ab)}var Dw=Cf(function(a,h,m){h!=null&&typeof h.toString!="function"&&(h=Zr.call(h)),a[h]=m},Ol(Je)),Yw=Cf(function(a,h,m){h!=null&&typeof h.toString!="function"&&(h=Zr.call(h)),Qt.call(a,h)?a[h].push(m):a[h]=[m]},At),Nw=Yt(dr);function Ie(a){return Ze(a)?Wu(a):rl(a)}function Qe(a){return Ze(a)?Wu(a,!0):gb(a)}function Uw(a,h){var m={};return h=At(h,3),$i(a,function(w,I,R){hs(m,h(w,I,R),w)}),m}function Xw(a,h){var m={};return h=At(h,3),$i(a,function(w,I,R){hs(m,I,h(w,I,R))}),m}var Ww=kn(function(a,h,m){ua(a,h,m)}),pd=kn(function(a,h,m,w){ua(a,h,m,w)}),zw=us(function(a,h){var m={};if(a==null)return m;var w=!1;h=ue(h,function(R){return R=Fs(R,a),w||(w=R.length>1),R}),Hi(a,bl(a),m),w&&(m=bi(m,d|g|p,Db));for(var I=h.length;I--;)ul(m,h[I]);return m});function Gw(a,h){return md(a,Ta(At(h)))}var Vw=us(function(a,h){return a==null?{}:yb(a,h)});function md(a,h){if(a==null)return{};var m=ue(bl(a),function(w){return[w]});return h=At(h),af(a,m,function(w,I){return h(w,I[0])})}function $w(a,h,m){h=Fs(h,a);var w=-1,I=h.length;for(I||(I=1,a=e);++w<I;){var R=a==null?e:a[qi(h[w])];R===e&&(w=I,R=m),a=ds(R)?R.call(a):R}return a}function Hw(a,h,m){return a==null?a:mr(a,h,m)}function qw(a,h,m,w){return w=typeof w=="function"?w:e,a==null?a:mr(a,h,m,w)}var gd=Pf(Ie),xd=Pf(Qe);function jw(a,h,m){var w=Rt(a),I=w||Ls(a)||Fn(a);if(h=At(h,4),m==null){var R=a&&a.constructor;I?m=w?new R:[]:de(a)?m=ds(R)?In(ta(a)):{}:m={}}return(I?gi:$i)(a,function(D,X,H){return h(m,D,X,H)}),m}function Kw(a,h){return a==null?!0:ul(a,h)}function Zw(a,h,m){return a==null?a:uf(a,h,pl(m))}function Qw(a,h,m,w){return w=typeof w=="function"?w:e,a==null?a:uf(a,h,pl(m),w)}function Bn(a){return a==null?[]:$o(a,Ie(a))}function Jw(a){return a==null?[]:$o(a,Qe(a))}function tv(a,h,m){return m===e&&(m=h,h=e),m!==e&&(m=vi(m),m=m===m?m:0),h!==e&&(h=vi(h),h=h===h?h:0),Zs(vi(a),h,m)}function ev(a,h,m){return h=ps(h),m===e?(m=h,h=0):m=ps(m),a=vi(a),ob(a,h,m)}function iv(a,h,m){if(m&&typeof m!="boolean"&&He(a,h,m)&&(h=m=e),m===e&&(typeof h=="boolean"?(m=h,h=e):typeof a=="boolean"&&(m=a,a=e)),a===e&&h===e?(a=0,h=1):(a=ps(a),h===e?(h=a,a=0):h=ps(h)),a>h){var w=a;a=h,h=w}if(m||a%1||h%1){var I=Uu();return Xe(a+I*(h-a+Bx("1e-"+((I+"").length-1))),h)}return ll(a,h)}var sv=En(function(a,h,m){return h=h.toLowerCase(),a+(m?yd(h):h)});function yd(a){return Ll(Zt(a).toLowerCase())}function bd(a){return a=Zt(a),a&&a.replace(rx,Hx).replace(Ax,"")}function nv(a,h,m){a=Zt(a),h=ai(h);var w=a.length;m=m===e?w:Zs(Ft(m),0,w);var I=m;return m-=h.length,m>=0&&a.slice(m,I)==h}function rv(a){return a=Zt(a),a&&si.test(a)?a.replace(ae,qx):a}function av(a){return a=Zt(a),a&&V0.test(a)?a.replace(ko,"\\$&"):a}var ov=En(function(a,h,m){return a+(m?"-":"")+h.toLowerCase()}),lv=En(function(a,h,m){return a+(m?" ":"")+h.toLowerCase()}),hv=vf("toLowerCase");function cv(a,h,m){a=Zt(a),h=Ft(h);var w=h?An(a):0;if(!h||w>=h)return a;var I=(h-w)/2;return xa(na(I),m)+a+xa(sa(I),m)}function uv(a,h,m){a=Zt(a),h=Ft(h);var w=h?An(a):0;return h&&w<h?a+xa(h-w,m):a}function fv(a,h,m){a=Zt(a),h=Ft(h);var w=h?An(a):0;return h&&w<h?xa(h-w,m)+a:a}function dv(a,h,m){return m||h==null?h=0:h&&(h=+h),_y(Zt(a).replace(Eo,""),h||0)}function pv(a,h,m){return(m?He(a,h,m):h===e)?h=1:h=Ft(h),hl(Zt(a),h)}function mv(){var a=arguments,h=Zt(a[0]);return a.length<3?h:h.replace(a[1],a[2])}var gv=En(function(a,h,m){return a+(m?"_":"")+h.toLowerCase()});function xv(a,h,m){return m&&typeof m!="number"&&He(a,h,m)&&(h=m=e),m=m===e?j:m>>>0,m?(a=Zt(a),a&&(typeof h=="string"||h!=null&&!Rl(h))&&(h=ai(h),!h&&Sn(a))?Bs(ki(a),0,m):a.split(h,m)):[]}var yv=En(function(a,h,m){return a+(m?" ":"")+Ll(h)});function bv(a,h,m){return a=Zt(a),m=m==null?0:Zs(Ft(m),0,a.length),h=ai(h),a.slice(m,m+h.length)==h}function _v(a,h,m){var w=k.templateSettings;m&&He(a,h,m)&&(h=e),a=Zt(a),h=Ia({},h,w,If);var I=Ia({},h.imports,w.imports,If),R=Ie(I),D=$o(I,R),X,H,nt=0,rt=h.interpolate||Wr,ht="__p += '",pt=qo((h.escape||Wr).source+"|"+rt.source+"|"+(rt===Kc?J0:Wr).source+"|"+(h.evaluate||Wr).source+"|$","g"),yt="//# sourceURL="+(Qt.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ix+"]")+`
`;a.replace(pt,function(Mt,Nt,Wt,li,qe,hi){return Wt||(Wt=li),ht+=a.slice(nt,hi).replace(ax,jx),Nt&&(X=!0,ht+=`' +
__e(`+Nt+`) +
'`),qe&&(H=!0,ht+=`';
`+qe+`;
__p += '`),Wt&&(ht+=`' +
((__t = (`+Wt+`)) == null ? '' : __t) +
'`),nt=hi+Mt.length,Mt}),ht+=`';
`;var Tt=Qt.call(h,"variable")&&h.variable;if(!Tt)ht=`with (obj) {
`+ht+`
}
`;else if(Z0.test(Tt))throw new Et(l);ht=(H?ht.replace(vt,""):ht).replace($t,"$1").replace(Ht,"$1;"),ht="function("+(Tt||"obj")+`) {
`+(Tt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(X?", __e = _.escape":"")+(H?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ht+`return __p
}`;var Lt=wd(function(){return qt(R,yt+"return "+ht).apply(e,D)});if(Lt.source=ht,El(Lt))throw Lt;return Lt}function wv(a){return Zt(a).toLowerCase()}function vv(a){return Zt(a).toUpperCase()}function Sv(a,h,m){if(a=Zt(a),a&&(m||h===e))return Iu(a);if(!a||!(h=ai(h)))return a;var w=ki(a),I=ki(h),R=ku(w,I),D=Eu(w,I)+1;return Bs(w,R,D).join("")}function Av(a,h,m){if(a=Zt(a),a&&(m||h===e))return a.slice(0,Fu(a)+1);if(!a||!(h=ai(h)))return a;var w=ki(a),I=Eu(w,ki(h))+1;return Bs(w,0,I).join("")}function Cv(a,h,m){if(a=Zt(a),a&&(m||h===e))return a.replace(Eo,"");if(!a||!(h=ai(h)))return a;var w=ki(a),I=ku(w,ki(h));return Bs(w,I).join("")}function Tv(a,h){var m=U,w=N;if(de(h)){var I="separator"in h?h.separator:I;m="length"in h?Ft(h.length):m,w="omission"in h?ai(h.omission):w}a=Zt(a);var R=a.length;if(Sn(a)){var D=ki(a);R=D.length}if(m>=R)return a;var X=m-An(w);if(X<1)return w;var H=D?Bs(D,0,X).join(""):a.slice(0,X);if(I===e)return H+w;if(D&&(X+=H.length-X),Rl(I)){if(a.slice(X).search(I)){var nt,rt=H;for(I.global||(I=qo(I.source,Zt(Zc.exec(I))+"g")),I.lastIndex=0;nt=I.exec(rt);)var ht=nt.index;H=H.slice(0,ht===e?X:ht)}}else if(a.indexOf(ai(I),X)!=X){var pt=H.lastIndexOf(I);pt>-1&&(H=H.slice(0,pt))}return H+w}function Mv(a){return a=Zt(a),a&&Oe.test(a)?a.replace(re,iy):a}var Pv=En(function(a,h,m){return a+(m?" ":"")+h.toUpperCase()}),Ll=vf("toUpperCase");function _d(a,h,m){return a=Zt(a),h=m?e:h,h===e?Zx(a)?ry(a):Wx(a):a.match(h)||[]}var wd=Yt(function(a,h){try{return ni(a,e,h)}catch(m){return El(m)?m:new Et(m)}}),Iv=us(function(a,h){return gi(h,function(m){m=qi(m),hs(a,m,Il(a[m],a))}),a});function kv(a){var h=a==null?0:a.length,m=At();return a=h?ue(a,function(w){if(typeof w[1]!="function")throw new xi(o);return[m(w[0]),w[1]]}):[],Yt(function(w){for(var I=-1;++I<h;){var R=a[I];if(ni(R[0],this,w))return ni(R[1],this,w)}})}function Ev(a){return ib(bi(a,d))}function Ol(a){return function(){return a}}function Rv(a,h){return a==null||a!==a?h:a}var Fv=Af(),Bv=Af(!0);function Je(a){return a}function Dl(a){return Ju(typeof a=="function"?a:bi(a,d))}function Lv(a){return ef(bi(a,d))}function Ov(a,h){return sf(a,bi(h,d))}var Dv=Yt(function(a,h){return function(m){return dr(m,a,h)}}),Yv=Yt(function(a,h){return function(m){return dr(a,m,h)}});function Yl(a,h,m){var w=Ie(h),I=ca(h,w);m==null&&!(de(h)&&(I.length||!w.length))&&(m=h,h=a,a=this,I=ca(h,Ie(h)));var R=!(de(m)&&"chain"in m)||!!m.chain,D=ds(a);return gi(I,function(X){var H=h[X];a[X]=H,D&&(a.prototype[X]=function(){var nt=this.__chain__;if(R||nt){var rt=a(this.__wrapped__),ht=rt.__actions__=Ke(this.__actions__);return ht.push({func:H,args:arguments,thisArg:a}),rt.__chain__=nt,rt}return H.apply(a,Ps([this.value()],arguments))})}),a}function Nv(){return De._===this&&(De._=uy),this}function Nl(){}function Uv(a){return a=Ft(a),Yt(function(h){return nf(h,a)})}var Xv=gl(ue),Wv=gl(Au),zv=gl(Xo);function vd(a){return Sl(a)?Wo(qi(a)):bb(a)}function Gv(a){return function(h){return a==null?e:Qs(a,h)}}var Vv=Tf(),$v=Tf(!0);function Ul(){return[]}function Xl(){return!1}function Hv(){return{}}function qv(){return""}function jv(){return!0}function Kv(a,h){if(a=Ft(a),a<1||a>Y)return[];var m=j,w=Xe(a,j);h=At(h),a-=j;for(var I=Vo(w,h);++m<a;)h(m);return I}function Zv(a){return Rt(a)?ue(a,qi):oi(a)?[a]:Ke(Wf(Zt(a)))}function Qv(a){var h=++hy;return Zt(a)+h}var Jv=ga(function(a,h){return a+h},0),tS=xl("ceil"),eS=ga(function(a,h){return a/h},1),iS=xl("floor");function sS(a){return a&&a.length?ha(a,Je,il):e}function nS(a,h){return a&&a.length?ha(a,At(h,2),il):e}function rS(a){return Mu(a,Je)}function aS(a,h){return Mu(a,At(h,2))}function oS(a){return a&&a.length?ha(a,Je,al):e}function lS(a,h){return a&&a.length?ha(a,At(h,2),al):e}var hS=ga(function(a,h){return a*h},1),cS=xl("round"),uS=ga(function(a,h){return a-h},0);function fS(a){return a&&a.length?Go(a,Je):0}function dS(a,h){return a&&a.length?Go(a,At(h,2)):0}return k.after=L1,k.ary=Jf,k.assign=vw,k.assignIn=dd,k.assignInWith=Ia,k.assignWith=Sw,k.at=Aw,k.before=td,k.bind=Il,k.bindAll=Iv,k.bindKey=ed,k.castArray=H1,k.chain=Kf,k.chunk=i_,k.compact=s_,k.concat=n_,k.cond=kv,k.conforms=Ev,k.constant=Ol,k.countBy=f1,k.create=Cw,k.curry=id,k.curryRight=sd,k.debounce=nd,k.defaults=Tw,k.defaultsDeep=Mw,k.defer=O1,k.delay=D1,k.difference=r_,k.differenceBy=a_,k.differenceWith=o_,k.drop=l_,k.dropRight=h_,k.dropRightWhile=c_,k.dropWhile=u_,k.fill=f_,k.filter=p1,k.flatMap=x1,k.flatMapDeep=y1,k.flatMapDepth=b1,k.flatten=$f,k.flattenDeep=d_,k.flattenDepth=p_,k.flip=Y1,k.flow=Fv,k.flowRight=Bv,k.fromPairs=m_,k.functions=Bw,k.functionsIn=Lw,k.groupBy=_1,k.initial=x_,k.intersection=y_,k.intersectionBy=b_,k.intersectionWith=__,k.invert=Dw,k.invertBy=Yw,k.invokeMap=v1,k.iteratee=Dl,k.keyBy=S1,k.keys=Ie,k.keysIn=Qe,k.map=Sa,k.mapKeys=Uw,k.mapValues=Xw,k.matches=Lv,k.matchesProperty=Ov,k.memoize=Ca,k.merge=Ww,k.mergeWith=pd,k.method=Dv,k.methodOf=Yv,k.mixin=Yl,k.negate=Ta,k.nthArg=Uv,k.omit=zw,k.omitBy=Gw,k.once=N1,k.orderBy=A1,k.over=Xv,k.overArgs=U1,k.overEvery=Wv,k.overSome=zv,k.partial=kl,k.partialRight=rd,k.partition=C1,k.pick=Vw,k.pickBy=md,k.property=vd,k.propertyOf=Gv,k.pull=A_,k.pullAll=qf,k.pullAllBy=C_,k.pullAllWith=T_,k.pullAt=M_,k.range=Vv,k.rangeRight=$v,k.rearg=X1,k.reject=P1,k.remove=P_,k.rest=W1,k.reverse=Ml,k.sampleSize=k1,k.set=Hw,k.setWith=qw,k.shuffle=E1,k.slice=I_,k.sortBy=B1,k.sortedUniq=O_,k.sortedUniqBy=D_,k.split=xv,k.spread=z1,k.tail=Y_,k.take=N_,k.takeRight=U_,k.takeRightWhile=X_,k.takeWhile=W_,k.tap=s1,k.throttle=G1,k.thru=va,k.toArray=cd,k.toPairs=gd,k.toPairsIn=xd,k.toPath=Zv,k.toPlainObject=fd,k.transform=jw,k.unary=V1,k.union=z_,k.unionBy=G_,k.unionWith=V_,k.uniq=$_,k.uniqBy=H_,k.uniqWith=q_,k.unset=Kw,k.unzip=Pl,k.unzipWith=jf,k.update=Zw,k.updateWith=Qw,k.values=Bn,k.valuesIn=Jw,k.without=j_,k.words=_d,k.wrap=$1,k.xor=K_,k.xorBy=Z_,k.xorWith=Q_,k.zip=J_,k.zipObject=t1,k.zipObjectDeep=e1,k.zipWith=i1,k.entries=gd,k.entriesIn=xd,k.extend=dd,k.extendWith=Ia,Yl(k,k),k.add=Jv,k.attempt=wd,k.camelCase=sv,k.capitalize=yd,k.ceil=tS,k.clamp=tv,k.clone=q1,k.cloneDeep=K1,k.cloneDeepWith=Z1,k.cloneWith=j1,k.conformsTo=Q1,k.deburr=bd,k.defaultTo=Rv,k.divide=eS,k.endsWith=nv,k.eq=Ri,k.escape=rv,k.escapeRegExp=av,k.every=d1,k.find=m1,k.findIndex=Gf,k.findKey=Pw,k.findLast=g1,k.findLastIndex=Vf,k.findLastKey=Iw,k.floor=iS,k.forEach=Zf,k.forEachRight=Qf,k.forIn=kw,k.forInRight=Ew,k.forOwn=Rw,k.forOwnRight=Fw,k.get=Fl,k.gt=J1,k.gte=tw,k.has=Ow,k.hasIn=Bl,k.head=Hf,k.identity=Je,k.includes=w1,k.indexOf=g_,k.inRange=ev,k.invoke=Nw,k.isArguments=en,k.isArray=Rt,k.isArrayBuffer=ew,k.isArrayLike=Ze,k.isArrayLikeObject=_e,k.isBoolean=iw,k.isBuffer=Ls,k.isDate=sw,k.isElement=nw,k.isEmpty=rw,k.isEqual=aw,k.isEqualWith=ow,k.isError=El,k.isFinite=lw,k.isFunction=ds,k.isInteger=ad,k.isLength=Ma,k.isMap=od,k.isMatch=hw,k.isMatchWith=cw,k.isNaN=uw,k.isNative=fw,k.isNil=pw,k.isNull=dw,k.isNumber=ld,k.isObject=de,k.isObjectLike=xe,k.isPlainObject=br,k.isRegExp=Rl,k.isSafeInteger=mw,k.isSet=hd,k.isString=Pa,k.isSymbol=oi,k.isTypedArray=Fn,k.isUndefined=gw,k.isWeakMap=xw,k.isWeakSet=yw,k.join=w_,k.kebabCase=ov,k.last=wi,k.lastIndexOf=v_,k.lowerCase=lv,k.lowerFirst=hv,k.lt=bw,k.lte=_w,k.max=sS,k.maxBy=nS,k.mean=rS,k.meanBy=aS,k.min=oS,k.minBy=lS,k.stubArray=Ul,k.stubFalse=Xl,k.stubObject=Hv,k.stubString=qv,k.stubTrue=jv,k.multiply=hS,k.nth=S_,k.noConflict=Nv,k.noop=Nl,k.now=Aa,k.pad=cv,k.padEnd=uv,k.padStart=fv,k.parseInt=dv,k.random=iv,k.reduce=T1,k.reduceRight=M1,k.repeat=pv,k.replace=mv,k.result=$w,k.round=cS,k.runInContext=$,k.sample=I1,k.size=R1,k.snakeCase=gv,k.some=F1,k.sortedIndex=k_,k.sortedIndexBy=E_,k.sortedIndexOf=R_,k.sortedLastIndex=F_,k.sortedLastIndexBy=B_,k.sortedLastIndexOf=L_,k.startCase=yv,k.startsWith=bv,k.subtract=uS,k.sum=fS,k.sumBy=dS,k.template=_v,k.times=Kv,k.toFinite=ps,k.toInteger=Ft,k.toLength=ud,k.toLower=wv,k.toNumber=vi,k.toSafeInteger=ww,k.toString=Zt,k.toUpper=vv,k.trim=Sv,k.trimEnd=Av,k.trimStart=Cv,k.truncate=Tv,k.unescape=Mv,k.uniqueId=Qv,k.upperCase=Pv,k.upperFirst=Ll,k.each=Zf,k.eachRight=Qf,k.first=Hf,Yl(k,function(){var a={};return $i(k,function(h,m){Qt.call(k.prototype,m)||(a[m]=h)}),a}(),{chain:!1}),k.VERSION=i,gi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){k[a].placeholder=k}),gi(["drop","take"],function(a,h){Ut.prototype[a]=function(m){m=m===e?1:Ce(Ft(m),0);var w=this.__filtered__&&!h?new Ut(this):this.clone();return w.__filtered__?w.__takeCount__=Xe(m,w.__takeCount__):w.__views__.push({size:Xe(m,j),type:a+(w.__dir__<0?"Right":"")}),w},Ut.prototype[a+"Right"]=function(m){return this.reverse()[a](m).reverse()}}),gi(["filter","map","takeWhile"],function(a,h){var m=h+1,w=m==V||m==E;Ut.prototype[a]=function(I){var R=this.clone();return R.__iteratees__.push({iteratee:At(I,3),type:m}),R.__filtered__=R.__filtered__||w,R}}),gi(["head","last"],function(a,h){var m="take"+(h?"Right":"");Ut.prototype[a]=function(){return this[m](1).value()[0]}}),gi(["initial","tail"],function(a,h){var m="drop"+(h?"":"Right");Ut.prototype[a]=function(){return this.__filtered__?new Ut(this):this[m](1)}}),Ut.prototype.compact=function(){return this.filter(Je)},Ut.prototype.find=function(a){return this.filter(a).head()},Ut.prototype.findLast=function(a){return this.reverse().find(a)},Ut.prototype.invokeMap=Yt(function(a,h){return typeof a=="function"?new Ut(this):this.map(function(m){return dr(m,a,h)})}),Ut.prototype.reject=function(a){return this.filter(Ta(At(a)))},Ut.prototype.slice=function(a,h){a=Ft(a);var m=this;return m.__filtered__&&(a>0||h<0)?new Ut(m):(a<0?m=m.takeRight(-a):a&&(m=m.drop(a)),h!==e&&(h=Ft(h),m=h<0?m.dropRight(-h):m.take(h-a)),m)},Ut.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Ut.prototype.toArray=function(){return this.take(j)},$i(Ut.prototype,function(a,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),w=/^(?:head|last)$/.test(h),I=k[w?"take"+(h=="last"?"Right":""):h],R=w||/^find/.test(h);I&&(k.prototype[h]=function(){var D=this.__wrapped__,X=w?[1]:arguments,H=D instanceof Ut,nt=X[0],rt=H||Rt(D),ht=function(Nt){var Wt=I.apply(k,Ps([Nt],X));return w&&pt?Wt[0]:Wt};rt&&m&&typeof nt=="function"&&nt.length!=1&&(H=rt=!1);var pt=this.__chain__,yt=!!this.__actions__.length,Tt=R&&!pt,Lt=H&&!yt;if(!R&&rt){D=Lt?D:new Ut(this);var Mt=a.apply(D,X);return Mt.__actions__.push({func:va,args:[ht],thisArg:e}),new yi(Mt,pt)}return Tt&&Lt?a.apply(this,X):(Mt=this.thru(ht),Tt?w?Mt.value()[0]:Mt.value():Mt)})}),gi(["pop","push","shift","sort","splice","unshift"],function(a){var h=qr[a],m=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",w=/^(?:pop|shift)$/.test(a);k.prototype[a]=function(){var I=arguments;if(w&&!this.__chain__){var R=this.value();return h.apply(Rt(R)?R:[],I)}return this[m](function(D){return h.apply(Rt(D)?D:[],I)})}}),$i(Ut.prototype,function(a,h){var m=k[h];if(m){var w=m.name+"";Qt.call(Pn,w)||(Pn[w]=[]),Pn[w].push({name:h,func:m})}}),Pn[ma(e,v).name]=[{name:"wrapper",func:e}],Ut.prototype.clone=My,Ut.prototype.reverse=Py,Ut.prototype.value=Iy,k.prototype.at=n1,k.prototype.chain=r1,k.prototype.commit=a1,k.prototype.next=o1,k.prototype.plant=h1,k.prototype.reverse=c1,k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=u1,k.prototype.first=k.prototype.head,ar&&(k.prototype[ar]=l1),k},Cn=ay();Hs?((Hs.exports=Cn)._=Cn,Do._=Cn):De._=Cn}).call(iC)}(Cr,Cr.exports)),Cr.exports}var nC=sC();const gk=Nr(nC);if(typeof window<"u"&&window.PIXI){const n=window.require;window.require=t=>{if(n)return n(t);if(t.startsWith("@pixi/")||t.startsWith("pixi.js"))return window.PIXI}}var _t=(n=>(n.Application="application",n.WebGLPipes="webgl-pipes",n.WebGLPipesAdaptor="webgl-pipes-adaptor",n.WebGLSystem="webgl-system",n.WebGPUPipes="webgpu-pipes",n.WebGPUPipesAdaptor="webgpu-pipes-adaptor",n.WebGPUSystem="webgpu-system",n.CanvasSystem="canvas-system",n.CanvasPipesAdaptor="canvas-pipes-adaptor",n.CanvasPipes="canvas-pipes",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n.MaskEffect="mask-effect",n.BlendMode="blend-mode",n.TextureSource="texture-source",n.Environment="environment",n.ShapeBuilder="shape-builder",n.Batcher="batcher",n))(_t||{});const Bh=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},Oa=(n,t)=>Bh(n).priority??t,Fe={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(Bh).forEach(t=>{t.type.forEach(e=>{var i,s;return(s=(i=this._removeHandlers)[e])==null?void 0:s.call(i,t)})}),this},add(...n){return n.map(Bh).forEach(t=>{t.type.forEach(e=>{var r,o;const i=this._addHandlers,s=this._queue;i[e]?(o=i[e])==null||o.call(i,t):(s[e]=s[e]||[],(r=s[e])==null||r.push(t))})}),this},handle(n,t,e){var o;const i=this._addHandlers,s=this._removeHandlers;if(i[n]||s[n])throw new Error(`Extension type ${n} already has a handler`);i[n]=t,s[n]=e;const r=this._queue;return r[n]&&((o=r[n])==null||o.forEach(l=>t(l)),delete r[n]),this},handleByMap(n,t){return this.handle(n,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(n,t,e=-1){return this.handle(n,i=>{t.findIndex(r=>r.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((r,o)=>Oa(o.value,e)-Oa(r.value,e)))},i=>{const s=t.findIndex(r=>r.name===i.name);s!==-1&&t.splice(s,1)})},handleByList(n,t,e=-1){return this.handle(n,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,r)=>Oa(r,e)-Oa(s,e)))},i=>{const s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})},mixin(n,...t){for(const e of t)Object.defineProperties(n.prototype,Object.getOwnPropertyDescriptors(e))}},rC={extension:{type:_t.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await fm(()=>import("./BypnmEhC.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)}},aC={extension:{type:_t.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await fm(()=>import("./Scfb2yZ2.js"),__vite__mapDeps([2,3]),import.meta.url)}};class di{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new di(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var $l={exports:{}},$d;function oC(){return $d||($d=1,function(n){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(u,c,f){this.fn=u,this.context=c,this.once=f||!1}function r(u,c,f,d,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var p=new s(f,d||u,g),x=e?e+c:c;return u._events[x]?u._events[x].fn?u._events[x]=[u._events[x],p]:u._events[x].push(p):(u._events[x]=p,u._eventsCount++),u}function o(u,c){--u._eventsCount===0?u._events=new i:delete u._events[c]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],f,d;if(this._eventsCount===0)return c;for(d in f=this._events)t.call(f,d)&&c.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(f)):c},l.prototype.listeners=function(c){var f=e?e+c:c,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var g=0,p=d.length,x=new Array(p);g<p;g++)x[g]=d[g].fn;return x},l.prototype.listenerCount=function(c){var f=e?e+c:c,d=this._events[f];return d?d.fn?1:d.length:0},l.prototype.emit=function(c,f,d,g,p,x){var y=e?e+c:c;if(!this._events[y])return!1;var b=this._events[y],v=arguments.length,C,_;if(b.fn){switch(b.once&&this.removeListener(c,b.fn,void 0,!0),v){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,d),!0;case 4:return b.fn.call(b.context,f,d,g),!0;case 5:return b.fn.call(b.context,f,d,g,p),!0;case 6:return b.fn.call(b.context,f,d,g,p,x),!0}for(_=1,C=new Array(v-1);_<v;_++)C[_-1]=arguments[_];b.fn.apply(b.context,C)}else{var S=b.length,M;for(_=0;_<S;_++)switch(b[_].once&&this.removeListener(c,b[_].fn,void 0,!0),v){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,f);break;case 3:b[_].fn.call(b[_].context,f,d);break;case 4:b[_].fn.call(b[_].context,f,d,g);break;default:if(!C)for(M=1,C=new Array(v-1);M<v;M++)C[M-1]=arguments[M];b[_].fn.apply(b[_].context,C)}}return!0},l.prototype.on=function(c,f,d){return r(this,c,f,d,!1)},l.prototype.once=function(c,f,d){return r(this,c,f,d,!0)},l.prototype.removeListener=function(c,f,d,g){var p=e?e+c:c;if(!this._events[p])return this;if(!f)return o(this,p),this;var x=this._events[p];if(x.fn)x.fn===f&&(!g||x.once)&&(!d||x.context===d)&&o(this,p);else{for(var y=0,b=[],v=x.length;y<v;y++)(x[y].fn!==f||g&&!x[y].once||d&&x[y].context!==d)&&b.push(x[y]);b.length?this._events[p]=b.length===1?b[0]:b:o(this,p)}return this},l.prototype.removeAllListeners=function(c){var f;return c?(f=e?e+c:c,this._events[f]&&o(this,f)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,n.exports=l}($l)),$l.exports}var lC=oC();const is=Nr(lC),hC=Math.PI*2,cC=180/Math.PI,Cm=Math.PI/180;class fe{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new fe(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Hl.x=0,Hl.y=0,Hl}}const Hl=new fe;class Vt{constructor(t=1,e=0,i=0,s=1,r=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=r,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,r,o){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=r,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new fe;const i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new fe;const i=this.a,s=this.b,r=this.c,o=this.d,l=this.tx,u=this.ty,c=1/(i*o+r*-s),f=t.x,d=t.y;return e.x=o*c*f+-r*c*d+(u*r-l*o)*c,e.y=i*c*d+-s*c*f+(-u*i+l*s)*c,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.a,r=this.c,o=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,s=this.c,r=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this}appendFrom(t,e){const i=t.a,s=t.b,r=t.c,o=t.d,l=t.tx,u=t.ty,c=e.a,f=e.b,d=e.c,g=e.d;return this.a=i*c+s*d,this.b=i*f+s*g,this.c=r*c+o*d,this.d=r*f+o*g,this.tx=l*c+u*d+e.tx,this.ty=l*f+u*g+e.ty,this}setTransform(t,e,i,s,r,o,l,u,c){return this.a=Math.cos(l+c)*r,this.b=Math.sin(l+c)*r,this.c=-Math.sin(l-u)*o,this.d=Math.cos(l-u)*o,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,s=this.c,r=this.d,o=t.pivot,l=-Math.atan2(-s,r),u=Math.atan2(i,e),c=Math.abs(l+u);return c<1e-5||Math.abs(hC-c)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=u),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+r*r),t.position.x=this.tx+(o.x*e+o.y*s),t.position.y=this.ty+(o.x*i+o.y*r),t}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,r=this.tx,o=t*s-e*i;return this.a=s/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-s*r)/o,this.ty=-(t*this.ty-e*r)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Vt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return fC.identity()}static get shared(){return uC.identity()}}const uC=new Vt,fC=new Vt,an=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],on=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ln=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],hn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Lh=[],Tm=[],Da=Math.sign;function dC(){for(let n=0;n<16;n++){const t=[];Lh.push(t);for(let e=0;e<16;e++){const i=Da(an[n]*an[e]+ln[n]*on[e]),s=Da(on[n]*an[e]+hn[n]*on[e]),r=Da(an[n]*ln[e]+ln[n]*hn[e]),o=Da(on[n]*ln[e]+hn[n]*hn[e]);for(let l=0;l<16;l++)if(an[l]===i&&on[l]===s&&ln[l]===r&&hn[l]===o){t.push(l);break}}}for(let n=0;n<16;n++){const t=new Vt;t.set(an[n],on[n],ln[n],hn[n],0,0),Tm.push(t)}}dC();const pe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>an[n],uY:n=>on[n],vX:n=>ln[n],vY:n=>hn[n],inv:n=>n&8?n&15:-n&7,add:(n,t)=>Lh[n][t],sub:(n,t)=>Lh[n][pe.inv(t)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,t)=>Math.abs(n)*2<=Math.abs(t)?t>=0?pe.S:pe.N:Math.abs(t)*2<=Math.abs(n)?n>0?pe.E:pe.W:t>0?n>0?pe.SE:pe.SW:n>0?pe.NE:pe.NW,matrixAppendRotationInv:(n,t,e=0,i=0)=>{const s=Tm[pe.inv(t)];s.tx=e,s.ty=i,n.append(s)}},Ya=[new fe,new fe,new fe,new fe];let Ve=class Ha{constructor(t=0,e=0,i=0,s=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Ha(0,0,0,0)}clone(){return new Ha(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i,s=.5){const{width:r,height:o}=this;if(r<=0||o<=0)return!1;const l=this.x,u=this.y,c=i*(1-s),f=i-c,d=l-c,g=l+r+c,p=u-c,x=u+o+c,y=l+f,b=l+r-f,v=u+f,C=u+o-f;return t>=d&&t<=g&&e>=p&&e<=x&&!(t>y&&t<b&&e>v&&e<C)}intersects(t,e){if(!e){const B=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=B)return!1;const U=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>U}const i=this.left,s=this.right,r=this.top,o=this.bottom;if(s<=i||o<=r)return!1;const l=Ya[0].set(t.left,t.top),u=Ya[1].set(t.left,t.bottom),c=Ya[2].set(t.right,t.top),f=Ya[3].set(t.right,t.bottom);if(c.x<=l.x||u.y<=l.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(l,l),e.apply(u,u),e.apply(c,c),e.apply(f,f),Math.max(l.x,u.x,c.x,f.x)<=i||Math.min(l.x,u.x,c.x,f.x)>=s||Math.max(l.y,u.y,c.y,f.y)<=r||Math.min(l.y,u.y,c.y,f.y)>=o))return!1;const g=d*(u.y-l.y),p=d*(l.x-u.x),x=g*i+p*r,y=g*s+p*r,b=g*i+p*o,v=g*s+p*o;if(Math.max(x,y,b,v)<=g*l.x+p*l.y||Math.min(x,y,b,v)>=g*f.x+p*f.y)return!1;const C=d*(l.y-c.y),_=d*(c.x-l.x),S=C*i+_*r,M=C*s+_*r,T=C*i+_*o,P=C*s+_*o;return!(Math.max(S,M,T,P)<=C*l.x+_*l.y||Math.min(S,M,T,P)>=C*f.x+_*f.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(r-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=r-s,this}getBounds(t){return t||(t=new Ha),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,i=t.y,s=t.x+t.width,r=t.y+t.height;return e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height&&s>=this.x&&s<this.x+this.width&&r>=this.y&&r<this.y+this.height}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const ql={default:-1};function Se(n="default"){return ql[n]===void 0&&(ql[n]=-1),++ql[n]}const Hd={},le="8.0.0",pC="8.3.4";function jt(n,t,e=3){if(Hd[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${n}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${n}`),console.warn(i))),Hd[t]=!0}const Mm=()=>{};function eo(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function qd(n){return!(n&n-1)&&!!n}function Pm(n){const t={};for(const e in n)n[e]!==void 0&&(t[e]=n[e]);return t}const jd=Object.create(null);function mC(n){const t=jd[n];return t===void 0&&(jd[n]=Se("resource")),t}const Im=class km extends is{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...km.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){jt(le,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=mC(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Im.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let gC=Im;const Em=class Rm extends is{constructor(t={}){super(),this.options=t,this.uid=Se("textureSource"),this._resourceType="textureSource",this._resourceId=Se("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Rm.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new gC(Pm(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,i;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Se("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i||(i=this._resolution),t||(t=this.width),e||(e=this.height);const s=Math.round(t*i),r=Math.round(e*i);return this.width=s/i,this.height=r/i,this._resolution=i,this.pixelWidth===s&&this.pixelHeight===r?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=r,this.emit("resize",this),this._resourceId=Se("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=qd(this.pixelWidth)&&qd(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Em.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Pi=Em;class hc extends Pi{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}hc.extension=_t.TextureSource;const Kd=new Vt;class xC{constructor(t,e){this.mapCoord=new Vt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let s=0;s<t.length;s+=2){const r=t[s],o=t[s+1];e[s]=r*i.a+o*i.c+i.tx,e[s+1]=r*i.b+o*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,s=t.trim;s&&(Kd.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Kd));const r=t.source,o=this.uClampFrame,l=this.clampMargin/r._resolution,u=this.clampOffset/r._resolution;return o[0]=(t.frame.x+l+u)/r.width,o[1]=(t.frame.y+l+u)/r.height,o[2]=(t.frame.x+t.frame.width-l+u)/r.width,o[3]=(t.frame.y+t.frame.height-l+u)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&t.rotate===0,!0}}let Ot=class extends is{constructor({source:t,label:e,frame:i,orig:s,trim:r,defaultAnchor:o,defaultBorders:l,rotate:u,dynamic:c}={}){if(super(),this.uid=Se("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Ve,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Pi,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:f,height:d}=this._source;this.frame.width=f,this.frame.height=d}this.orig=s||this.frame,this.trim=r,this.rotate=u??0,this.defaultAnchor=o,this.defaultBorders=l,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new xC(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:s}=this._source,r=e.x/i,o=e.y/s,l=e.width/i,u=e.height/s;let c=this.rotate;if(c){const f=l/2,d=u/2,g=r+f,p=o+d;c=pe.add(c,pe.NW),t.x0=g+f*pe.uX(c),t.y0=p+d*pe.uY(c),c=pe.add(c,2),t.x1=g+f*pe.uX(c),t.y1=p+d*pe.uY(c),c=pe.add(c,2),t.x2=g+f*pe.uX(c),t.y2=p+d*pe.uY(c),c=pe.add(c,2),t.x3=g+f*pe.uX(c),t.y3=p+d*pe.uY(c)}else t.x0=r,t.y0=o,t.x1=r+l,t.y1=o,t.x2=r+l,t.y2=o+u,t.x3=r,t.y3=o+u}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return jt(le,"Texture.baseTexture is now Texture.source"),this._source}};Ot.EMPTY=new Ot({label:"EMPTY",source:new Pi({label:"EMPTY"})});Ot.EMPTY.destroy=Mm;Ot.WHITE=new Ot({source:new hc({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ot.WHITE.destroy=Mm;function yC(n,t,e){const{width:i,height:s}=e.orig,r=e.trim;if(r){const o=r.width,l=r.height;n.minX=r.x-t._x*i,n.maxX=n.minX+o,n.minY=r.y-t._y*s,n.maxY=n.minY+l}else n.minX=-t._x*i,n.maxX=n.minX+i,n.minY=-t._y*s,n.maxY=n.minY+s}const Zd=new Vt;class Ui{constructor(t=1/0,e=1/0,i=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Zd,this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Ve);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Zd,this}set(t,e,i,s){this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}addFrame(t,e,i,s,r){r||(r=this.matrix);const o=r.a,l=r.b,u=r.c,c=r.d,f=r.tx,d=r.ty;let g=this.minX,p=this.minY,x=this.maxX,y=this.maxY,b=o*t+u*e+f,v=l*t+c*e+d;b<g&&(g=b),v<p&&(p=v),b>x&&(x=b),v>y&&(y=v),b=o*i+u*e+f,v=l*i+c*e+d,b<g&&(g=b),v<p&&(p=v),b>x&&(x=b),v>y&&(y=v),b=o*t+u*s+f,v=l*t+c*s+d,b<g&&(g=b),v<p&&(p=v),b>x&&(x=b),v>y&&(y=v),b=o*i+u*s+f,v=l*i+c*s+d,b<g&&(g=b),v<p&&(p=v),b>x&&(x=b),v>y&&(y=v),this.minX=g,this.minY=p,this.maxX=x,this.maxY=y}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,s=this.maxX,r=this.maxY,{a:o,b:l,c:u,d:c,tx:f,ty:d}=t;let g=o*e+u*i+f,p=l*e+c*i+d;this.minX=g,this.minY=p,this.maxX=g,this.maxY=p,g=o*s+u*i+f,p=l*s+c*i+d,this.minX=g<this.minX?g:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=g>this.maxX?g:this.maxX,this.maxY=p>this.maxY?p:this.maxY,g=o*e+u*r+f,p=l*e+c*r+d,this.minX=g<this.minX?g:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=g>this.maxX?g:this.maxX,this.maxY=p>this.maxY?p:this.maxY,g=o*s+u*r+f,p=l*s+c*r+d,this.minX=g<this.minX?g:this.minX,this.minY=p<this.minY?p:this.minY,this.maxX=g>this.maxX?g:this.maxX,this.maxY=p>this.maxY?p:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,i,s){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<i&&(this.minY=i),this.maxY>s&&(this.maxY=s),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Ui(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,s){let r=this.minX,o=this.minY,l=this.maxX,u=this.maxY;s||(s=this.matrix);const c=s.a,f=s.b,d=s.c,g=s.d,p=s.tx,x=s.ty;for(let y=e;y<i;y+=2){const b=t[y],v=t[y+1],C=c*b+d*v+p,_=f*b+g*v+x;r=C<r?C:r,o=_<o?_:o,l=C>l?C:l,u=_>u?_:u}this.minX=r,this.minY=o,this.maxX=l,this.maxY=u}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var bC={grad:.9,turn:360,rad:360/(2*Math.PI)},gs=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},Ee=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*n)/e+0},Ci=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),n>e?e:n>t?n:t},Fm=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},Qd=function(n){return{r:Ci(n.r,0,255),g:Ci(n.g,0,255),b:Ci(n.b,0,255),a:Ci(n.a)}},jl=function(n){return{r:Ee(n.r),g:Ee(n.g),b:Ee(n.b),a:Ee(n.a,3)}},_C=/^#([0-9a-f]{3,8})$/i,Na=function(n){var t=n.toString(16);return t.length<2?"0"+t:t},Bm=function(n){var t=n.r,e=n.g,i=n.b,s=n.a,r=Math.max(t,e,i),o=r-Math.min(t,e,i),l=o?r===t?(e-i)/o:r===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(l<0?l+6:l),s:r?o/r*100:0,v:r/255*100,a:s}},Lm=function(n){var t=n.h,e=n.s,i=n.v,s=n.a;t=t/360*6,e/=100,i/=100;var r=Math.floor(t),o=i*(1-e),l=i*(1-(t-r)*e),u=i*(1-(1-t+r)*e),c=r%6;return{r:255*[i,l,o,o,u,i][c],g:255*[u,i,i,l,o,o][c],b:255*[o,o,u,i,i,l][c],a:s}},Jd=function(n){return{h:Fm(n.h),s:Ci(n.s,0,100),l:Ci(n.l,0,100),a:Ci(n.a)}},tp=function(n){return{h:Ee(n.h),s:Ee(n.s),l:Ee(n.l),a:Ee(n.a,3)}},ep=function(n){return Lm((e=(t=n).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},Ir=function(n){return{h:(t=Bm(n)).h,s:(s=(200-(e=t.s))*(i=t.v)/100)>0&&s<200?e*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,i,s},wC=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vC=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,SC=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,AC=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Oh={string:[[function(n){var t=_C.exec(n);return t?(n=t[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Ee(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?Ee(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var t=SC.exec(n)||AC.exec(n);return t?t[2]!==t[4]||t[4]!==t[6]?null:Qd({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(n){var t=wC.exec(n)||vC.exec(n);if(!t)return null;var e,i,s=Jd({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(bC[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ep(s)},"hsl"]],object:[[function(n){var t=n.r,e=n.g,i=n.b,s=n.a,r=s===void 0?1:s;return gs(t)&&gs(e)&&gs(i)?Qd({r:Number(t),g:Number(e),b:Number(i),a:Number(r)}):null},"rgb"],[function(n){var t=n.h,e=n.s,i=n.l,s=n.a,r=s===void 0?1:s;if(!gs(t)||!gs(e)||!gs(i))return null;var o=Jd({h:Number(t),s:Number(e),l:Number(i),a:Number(r)});return ep(o)},"hsl"],[function(n){var t=n.h,e=n.s,i=n.v,s=n.a,r=s===void 0?1:s;if(!gs(t)||!gs(e)||!gs(i))return null;var o=function(l){return{h:Fm(l.h),s:Ci(l.s,0,100),v:Ci(l.v,0,100),a:Ci(l.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(r)});return Lm(o)},"hsv"]]},ip=function(n,t){for(var e=0;e<t.length;e++){var i=t[e][0](n);if(i)return[i,t[e][1]]}return[null,void 0]},CC=function(n){return typeof n=="string"?ip(n.trim(),Oh.string):typeof n=="object"&&n!==null?ip(n,Oh.object):[null,void 0]},Kl=function(n,t){var e=Ir(n);return{h:e.h,s:Ci(e.s+100*t,0,100),l:e.l,a:e.a}},Zl=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},sp=function(n,t){var e=Ir(n);return{h:e.h,s:e.s,l:Ci(e.l+100*t,0,100),a:e.a}},Dh=function(){function n(t){this.parsed=CC(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return Ee(Zl(this.rgba),2)},n.prototype.isDark=function(){return Zl(this.rgba)<.5},n.prototype.isLight=function(){return Zl(this.rgba)>=.5},n.prototype.toHex=function(){return t=jl(this.rgba),e=t.r,i=t.g,s=t.b,o=(r=t.a)<1?Na(Ee(255*r)):"","#"+Na(e)+Na(i)+Na(s)+o;var t,e,i,s,r,o},n.prototype.toRgb=function(){return jl(this.rgba)},n.prototype.toRgbString=function(){return t=jl(this.rgba),e=t.r,i=t.g,s=t.b,(r=t.a)<1?"rgba("+e+", "+i+", "+s+", "+r+")":"rgb("+e+", "+i+", "+s+")";var t,e,i,s,r},n.prototype.toHsl=function(){return tp(Ir(this.rgba))},n.prototype.toHslString=function(){return t=tp(Ir(this.rgba)),e=t.h,i=t.s,s=t.l,(r=t.a)<1?"hsla("+e+", "+i+"%, "+s+"%, "+r+")":"hsl("+e+", "+i+"%, "+s+"%)";var t,e,i,s,r},n.prototype.toHsv=function(){return t=Bm(this.rgba),{h:Ee(t.h),s:Ee(t.s),v:Ee(t.v),a:Ee(t.a,3)};var t},n.prototype.invert=function(){return ji({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},n.prototype.saturate=function(t){return t===void 0&&(t=.1),ji(Kl(this.rgba,t))},n.prototype.desaturate=function(t){return t===void 0&&(t=.1),ji(Kl(this.rgba,-t))},n.prototype.grayscale=function(){return ji(Kl(this.rgba,-1))},n.prototype.lighten=function(t){return t===void 0&&(t=.1),ji(sp(this.rgba,t))},n.prototype.darken=function(t){return t===void 0&&(t=.1),ji(sp(this.rgba,-t))},n.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},n.prototype.alpha=function(t){return typeof t=="number"?ji({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Ee(this.rgba.a,3);var e},n.prototype.hue=function(t){var e=Ir(this.rgba);return typeof t=="number"?ji({h:t,s:e.s,l:e.l,a:e.a}):Ee(e.h)},n.prototype.isEqual=function(t){return this.toHex()===ji(t).toHex()},n}(),ji=function(n){return n instanceof Dh?n:new Dh(n)},np=[],TC=function(n){n.forEach(function(t){np.indexOf(t)<0&&(t(Dh,Oh),np.push(t))})};function MC(n,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in e)i[e[s]]=s;var r={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,u,c=i[this.toHex()];if(c)return c;if(o!=null&&o.closest){var f=this.toRgb(),d=1/0,g="black";if(!r.length)for(var p in e)r[p]=new n(e[p]).toRgb();for(var x in e){var y=(l=f,u=r[x],Math.pow(l.r-u.r,2)+Math.pow(l.g-u.g,2)+Math.pow(l.b-u.b,2));y<d&&(d=y,g=x)}return g}},t.string.push([function(o){var l=o.toLowerCase(),u=l==="transparent"?"#0000":e[l];return u?new n(u).toRgb():null},"name"])}TC([MC]);const Jn=class Tr{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Tr)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,o)=>r===e[o]);if(t!==null&&e!==null){const r=Object.keys(t),o=Object.keys(e);return r.length!==o.length?!1:r.every(l=>t[l]===e[l])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,i,s,r]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,r]=Tr._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,r=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,r=r*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,s,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,s=(o&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,r=255]=t,e/=255,i/=255,s/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const l=Tr.HEX_PATTERN.exec(t);l&&(t=`#${l[2]}`)}const o=ji(t);o.isValid()&&({r:e,g:i,b:s,a:r}=o.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=r,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,r)=>{t[r]=Math.min(Math.max(s,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Tr||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Jn.shared=new Jn;Jn._temp=new Jn;Jn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Be=Jn;const PC={cullArea:null,cullable:!1,cullableChildren:!0};let cc=class{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var i;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(i=e.init)==null||i.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}};class IC{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new cc(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const _s=new IC,kC={get isCachedAsTexture(){var n;return!!((n=this.renderGroup)!=null&&n.isCachedAsTexture)},cacheAsTexture(n){typeof n=="boolean"&&n===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(n===!0?{}:n))},updateCacheTexture(){var n;(n=this.renderGroup)==null||n.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(n){jt("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(n)}};function EC(n,t,e){const i=n.length;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const r=i-e;for(s=t;s<r;++s)n[s]=n[s+e];n.length=r}const RC={allowChildren:!0,removeChildren(n=0,t){const e=t??this.children.length,i=e-n,s=[];if(i>0&&i<=e){for(let o=e-1;o>=n;o--){const l=this.children[o];l&&(s.push(l),l.parent=null)}EC(this.children,n,e);const r=this.renderGroup||this.parentRenderGroup;r&&r.removeChildren(s);for(let o=0;o<s.length;++o)this.emit("childRemoved",s[o],this,o),s[o].emit("removed",this);return s.length>0&&this._didViewChangeTick++,s}else if(i===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(n){const t=this.getChildAt(n);return this.removeChild(t)},getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]},setChildIndex(n,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(n),this.addChildAt(n,t)},getChildIndex(n){const t=this.children.indexOf(n);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(n,t){this.allowChildren||jt(le,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${n}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(n.parent){const s=n.parent.children.indexOf(n);if(n.parent===this&&s===t)return n;s!==-1&&n.parent.children.splice(s,1)}t===e.length?e.push(n):e.splice(t,0,n),n.parent=this,n.didChange=!0,n._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(n),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",n,this,t),n.emit("added",this),n},swapChildren(n,t){if(n===t)return;const e=this.getChildIndex(n),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=n;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var n;(n=this.parent)==null||n.removeChild(this)},reparentChild(...n){return n.length===1?this.reparentChildAt(n[0],this.children.length):(n.forEach(t=>this.reparentChildAt(t,this.children.length)),n[0])},reparentChildAt(n,t){if(n.parent===this)return this.setChildIndex(n,t),n;const e=n.worldTransform.clone();n.removeFromParent(),this.addChildAt(n,t);const i=this.worldTransform.clone();return i.invert(),e.prepend(i),n.setFromMatrix(e),n}},FC={collectRenderables(n,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(n,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,n):this.collectRenderablesWithEffects(n,t,e))},collectRenderablesSimple(n,t,e){const i=this.children,s=i.length;for(let r=0;r<s;r++)i[r].collectRenderables(n,t,e)},collectRenderablesWithEffects(n,t,e){const{renderPipes:i}=t;for(let s=0;s<this.effects.length;s++){const r=this.effects[s];i[r.pipe].push(r,this,n)}this.collectRenderablesSimple(n,t,e);for(let s=this.effects.length-1;s>=0;s--){const r=this.effects[s];i[r.pipe].pop(r,this,n)}}};class rp{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class BC{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return _s.get(i.maskClass,t)}return t}returnMaskEffect(t){_s.return(t)}}const Yh=new BC;Fe.handleByList(_t.MaskEffect,Yh._effectClasses);const LC={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0)},addEffect(n){this.effects.indexOf(n)===-1&&(this.effects.push(n),this.effects.sort((e,i)=>e.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(n){const t=this.effects.indexOf(n);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(n){const t=this._maskEffect;(t==null?void 0:t.mask)!==n&&(t&&(this.removeEffect(t),Yh.returnMaskEffect(t),this._maskEffect=null),n!=null&&(this._maskEffect=Yh.getMaskEffect(n),this.addEffect(this._maskEffect)))},setMask(n){this._maskOptions={...this._maskOptions,...n},n.mask&&(this.mask=n.mask),this._markStructureAsChanged()},get mask(){var n;return(n=this._maskEffect)==null?void 0:n.mask},set filters(n){var r;!Array.isArray(n)&&n&&(n=[n]);const t=this._filterEffect||(this._filterEffect=new rp);n=n;const e=(n==null?void 0:n.length)>0,i=((r=t.filters)==null?void 0:r.length)>0,s=e!==i;n=Array.isArray(n)?n.slice(0):n,t.filters=Object.freeze(n),s&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=n??null))},get filters(){var n;return(n=this._filterEffect)==null?void 0:n.filters},set filterArea(n){this._filterEffect||(this._filterEffect=new rp),this._filterEffect.filterArea=n},get filterArea(){var n;return(n=this._filterEffect)==null?void 0:n.filterArea}},OC={label:null,get name(){return jt(le,"Container.name property has been removed, use Container.label instead"),this.label},set name(n){jt(le,"Container.name property has been removed, use Container.label instead"),this.label=n},getChildByName(n,t=!1){return this.getChildByLabel(n,t)},getChildByLabel(n,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const s=e[i];if(s.label===n||n instanceof RegExp&&n.test(s.label))return s}if(t)for(let i=0;i<e.length;i++){const r=e[i].getChildByLabel(n,!0);if(r)return r}return null},getChildrenByLabel(n,t=!1,e=[]){const i=this.children;for(let s=0;s<i.length;s++){const r=i[s];(r.label===n||n instanceof RegExp&&n.test(r.label))&&e.push(r)}if(t)for(let s=0;s<i.length;s++)i[s].getChildrenByLabel(n,!0,e);return e}},je=new cc(Vt),ws=new cc(Ui),DC=new Vt,YC={getFastGlobalBounds(n,t){t||(t=new Ui),t.clear(),this._getGlobalBoundsRecursive(!!n,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(n,t,e){let i=t;if(n&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const s=!!this.effects.length;if((this.renderGroup||s)&&(i=ws.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;i.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const r=this.children;for(let o=0;o<r.length;o++)r[o]._getGlobalBoundsRecursive(n,i,e)}if(s){let r=!1;const o=this.renderGroup||this.parentRenderGroup;for(let l=0;l<this.effects.length;l++)this.effects[l].addBounds&&(r||(r=!0,i.applyMatrix(o.worldTransform)),this.effects[l].addBounds(i,!0));r&&(i.applyMatrix(o.worldTransform.copyTo(DC).invert()),t.addBounds(i,this.relativeGroupTransform)),t.addBounds(i),ws.return(i)}else this.renderGroup&&(t.addBounds(i,this.relativeGroupTransform),ws.return(i))}};function Om(n,t,e){e.clear();let i,s;return n.parent?t?i=n.parent.worldTransform:(s=je.get().identity(),i=uc(n,s)):i=Vt.IDENTITY,Dm(n,e,i,t),s&&je.return(s),e.isValid||e.set(0,0,0,0),e}function Dm(n,t,e,i){var l,u;if(!n.visible||!n.measurable)return;let s;i?s=n.worldTransform:(n.updateLocalTransform(),s=je.get(),s.appendFrom(n.localTransform,e));const r=t,o=!!n.effects.length;if(o&&(t=ws.get().clear()),n.boundsArea)t.addRect(n.boundsArea,s);else{n.bounds&&(t.matrix=s,t.addBounds(n.bounds));for(let c=0;c<n.children.length;c++)Dm(n.children[c],t,s,i)}if(o){for(let c=0;c<n.effects.length;c++)(u=(l=n.effects[c]).addBounds)==null||u.call(l,t);r.addBounds(t,Vt.IDENTITY),ws.return(t)}i||je.return(s)}function uc(n,t){const e=n.parent;return e&&(uc(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Ym(n,t){if(n===16777215||!t)return t;if(t===16777215||!n)return n;const e=n>>16&255,i=n>>8&255,s=n&255,r=t>>16&255,o=t>>8&255,l=t&255,u=e*r/255|0,c=i*o/255|0,f=s*l/255|0;return(u<<16)+(c<<8)+f}const ap=16777215;function op(n,t){return n===ap?t:t===ap?n:Ym(n,t)}function qa(n){return((n&255)<<16)+(n&65280)+(n>>16&255)}const NC={getGlobalAlpha(n){if(n)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(n,t){if(t)return n.copyFrom(this.worldTransform);this.updateLocalTransform();const e=uc(this,je.get().identity());return n.appendFrom(this.localTransform,e),je.return(e),n},getGlobalTint(n){if(n)return this.renderGroup?qa(this.renderGroup.worldColor):this.parentRenderGroup?qa(op(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=op(t,e.localColor),e=e.parent;return qa(t)}};let Ql=0;const lp=500;function ge(...n){Ql!==lp&&(Ql++,Ql===lp?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...n))}function Nm(n,t,e){return t.clear(),e||(e=Vt.IDENTITY),Um(n,t,e,n,!0),t.isValid||t.set(0,0,0,0),t}function Um(n,t,e,i,s){var u,c;let r;if(s)r=je.get(),r=e.copyTo(r);else{if(!n.visible||!n.measurable)return;n.updateLocalTransform();const f=n.localTransform;r=je.get(),r.appendFrom(f,e)}const o=t,l=!!n.effects.length;if(l&&(t=ws.get().clear()),n.boundsArea)t.addRect(n.boundsArea,r);else{n.renderPipeId&&(t.matrix=r,t.addBounds(n.bounds));const f=n.children;for(let d=0;d<f.length;d++)Um(f[d],t,r,i,!1)}if(l){for(let f=0;f<n.effects.length;f++)(c=(u=n.effects[f]).addLocalBounds)==null||c.call(u,t,i);o.addBounds(t,Vt.IDENTITY),ws.return(t)}je.return(r)}function Xm(n,t){const e=n.children;for(let i=0;i<e.length;i++){const s=e[i],r=s.uid,o=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,l=t.index;(t.data[l]!==r||t.data[l+1]!==o)&&(t.data[t.index]=r,t.data[t.index+1]=o,t.didChange=!0),t.index=l+2,s.children.length&&Xm(s,t)}return t.didChange}const UC=new Vt,XC={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(n,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=n/t*e:this.scale.x=e},_setHeight(n,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=n/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Ui});const n=this._localBoundsCacheData;return n.index=1,n.didChange=!1,n.data[0]!==this._didViewChangeTick&&(n.didChange=!0,n.data[0]=this._didViewChangeTick),Xm(this,n),n.didChange&&Nm(this,n.localBounds,UC),n.localBounds},getBounds(n,t){return Om(this,n,t||new Ui)}},WC={_onRender:null,set onRender(n){const t=this.renderGroup||this.parentRenderGroup;if(!n){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=n},get onRender(){return this._onRender}},zC={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(n){this._zIndex!==n&&(this._zIndex=n,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(GC))}};function GC(n,t){return n._zIndex-t._zIndex}const VC={getGlobalPosition(n=new fe,t=!1){return this.parent?this.parent.toGlobal(this._position,n,t):(n.x=this._position.x,n.y=this._position.y),n},toGlobal(n,t,e=!1){const i=this.getGlobalTransform(je.get(),e);return t=i.apply(n,t),je.return(i),t},toLocal(n,t,e,i){t&&(n=t.toGlobal(n,e,i));const s=this.getGlobalTransform(je.get(),i);return e=s.applyInverse(n,e),je.return(s),e}};class Wm{constructor(){this.uid=Se("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let $C=0;class HC{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1}createTexture(t,e,i){const s=new Pi({...this.textureOptions,width:t,height:e,resolution:1,antialias:i,autoGarbageCollect:!1});return new Ot({source:s,label:`texturePool_${$C++}`})}getOptimalTexture(t,e,i=1,s){let r=Math.ceil(t*i-1e-6),o=Math.ceil(e*i-1e-6);r=eo(r),o=eo(o);const l=(r<<17)+(o<<1)+(s?1:0);this._texturePool[l]||(this._texturePool[l]=[]);let u=this._texturePool[l].pop();return u||(u=this.createTexture(r,o,s)),u.source._resolution=i,u.source.width=r/i,u.source.height=o/i,u.source.pixelWidth=r,u.source.pixelHeight=o,u.frame.x=0,u.frame.y=0,u.frame.width=t,u.frame.height=e,u.updateUvs(),this._poolKeyHash[u.uid]=l,u}getSameSizeTexture(t,e=!1){const i=t.source;return this.getOptimalTexture(t.width,t.height,i._resolution,e)}returnTexture(t){const e=this._poolKeyHash[t.uid];this._texturePool[e].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const i=this._texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this._texturePool={}}}const qC=new HC;class jC{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Vt,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Wm,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let i=0;i<e.length;i++){const s=e[i];s._updateFlags=15,this.addChild(s)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(qC.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let i=0;i<e.length;i++)this.removeChild(e[i])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let i=0;i<e.length;i++)this._getChildren(e[i],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const i=t.children;for(let s=0;s<i.length;s++)this._getChildren(i[s],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new Vt),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new Vt),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new Vt),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function KC(n,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(n[i]=t[i])}const Jl=new di(null),th=new di(null),eh=new di(null,1,1),hp=1,ZC=2,ih=4;class sr extends is{constructor(t={}){var e,i;super(),this.uid=Se("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new Vt,this.relativeGroupTransform=new Vt,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new di(this,0,0),this._scale=eh,this._pivot=th,this._skew=Jl,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],KC(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(s=>this.addChild(s)),(i=t.parent)==null||i.addChild(this)}static mixin(t){jt("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Fe.mixin(sr,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||jt(le,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let s=0;s<t.length;s++)this.addChild(t[s]);return t[0]}const e=t[0],i=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),i&&(i.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,i&&i.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let s=0;s<t.length;s++)this.removeChild(t[s]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=_s.get(jC,this),this.groupTransform=Vt.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),_s.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Vt),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*cC}set angle(t){this.rotation=t*Cm}get pivot(){return this._pivot===th&&(this._pivot=new di(this,0,0)),this._pivot}set pivot(t){this._pivot===th&&(this._pivot=new di(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Jl&&(this._skew=new di(this,0,0)),this._skew}set skew(t){this._skew===Jl&&(this._skew=new di(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===eh&&(this._scale=new di(this,1,1)),this._scale}set scale(t){this._scale===eh&&(this._scale=new di(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,i.width),e!==void 0&&this._setHeight(e,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,i=this._scale,s=this._pivot,r=this._position,o=i._x,l=i._y,u=s._x,c=s._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*l,e.d=this._sy*l,e.tx=r._x-(u*e.a+c*e.c),e.ty=r._y-(u*e.b+c*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=hp,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=Be.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=hp,this._onUpdate())}get tint(){return qa(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ZC,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ih,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=ih,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=ih,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var s;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let r=0;r<e.length;++r)e[r].destroy(t);(s=this.renderGroup)==null||s.destroy(),this.renderGroup=null}}Fe.mixin(sr,RC,YC,VC,WC,XC,LC,OC,zC,PC,kC,NC,FC);class fc extends sr{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._bounds=new Ui(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:i,y:s}=t;return i>=e.minX&&i<=e.maxX&&s>=e.minY&&s<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}collectRenderablesSimple(t,e,i){const{renderPipes:s,renderableGC:r}=e;s.blendMode.setBlendMode(this,this.groupBlendMode,t),s[this.renderPipeId].addRenderable(this,t),r.addRenderable(this),this.didViewUpdate=!1;const l=this.children,u=l.length;for(let c=0;c<u;c++)l[c].collectRenderables(t,e,i)}}class tr extends fc{constructor(t=Ot.EMPTY){t instanceof Ot&&(t={texture:t});const{texture:e=Ot.EMPTY,anchor:i,roundPixels:s,width:r,height:o,...l}=t;super({label:"Sprite",...l}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new di({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=s??!1,r!==void 0&&(this.width=r),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof Ot?new tr(t):new tr(Ot.from(t,e))}set texture(t){t||(t=Ot.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return yC(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return jt("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,i=this._bounds,{width:s,height:r}=e.orig;i.minX=-t._x*s,i.maxX=i.minX+s,i.minY=-t._y*r,i.maxY=i.minY+r}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const QC=new Ui;function zm(n,t,e){const i=QC;n.measurable=!0,Om(n,e,i),t.addBoundsMask(i),n.measurable=!1}function Gm(n,t,e){const i=ws.get();n.measurable=!0;const s=je.get().identity(),r=Vm(n,e,s);Nm(n,i,r),n.measurable=!1,t.addBoundsMask(i),je.return(s),ws.return(i)}function Vm(n,t,e){return n?(n!==t&&(Vm(n.parent,t,e),n.updateLocalTransform(),e.append(n.localTransform)),e):(ge("Mask bounds, renderable is not inside the root container"),e)}class $m{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof tr),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||zm(this.mask,t,e)}addLocalBounds(t,e){Gm(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof tr}}$m.extension=_t.MaskEffect;class Hm{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}Hm.extension=_t.MaskEffect;class qm{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){zm(this.mask,t,e)}addLocalBounds(t,e){Gm(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof sr}}qm.extension=_t.MaskEffect;const JC={createCanvas:(n,t)=>{const e=document.createElement("canvas");return e.width=n,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,t)=>fetch(n,t),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")};let cp=JC;const ve={get(){return cp},set(n){cp=n}};class jm extends Pi{constructor(t){t.resource||(t.resource=ve.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const s=super.resize(t,e,i);return s&&this.resizeCanvas(),s}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}jm.extension=_t.TextureSource;class mn extends Pi{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=ve.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,ge("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}mn.extension=_t.TextureSource;var Nh=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Nh||{});class sh{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=s}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Km=class ci{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new sh(null,null,1/0),this.deltaMS=1/ci.targetFPMS,this.elapsedMS=1/ci.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=Nh.NORMAL){return this._addListener(new sh(t,e,i))}addOnce(t,e,i=Nh.NORMAL){return this._addListener(new sh(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ci.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,ci.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ci._shared){const t=ci._shared=new ci;t.autoStart=!0,t._protected=!0}return ci._shared}static get system(){if(!ci._system){const t=ci._system=new ci;t.autoStart=!0,t._protected=!0}return ci._system}};Km.targetFPMS=.06;let bs=Km,nh;async function Zm(){return nh??(nh=(async()=>{var o;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(l=>{const u=document.createElement("video");u.onloadeddata=()=>l(u),u.onerror=()=>l(null),u.autoplay=!1,u.crossOrigin="anonymous",u.preload="auto",u.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",u.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(s),t.deleteTexture(i),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),nh}const _o=class Qm extends Pi{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Qm.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=bs.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Zm(),this._load=new Promise((i,s)=>{this.isValid?i(this):(this._resolve=i,this._reject=s,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(bs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(bs.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(bs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};_o.extension=_t.TextureSource;_o.defaultOptions={...Pi.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};_o.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ja=_o;const Di=(n,t,e=!1)=>(Array.isArray(n)||(n=[n]),t?n.map(i=>typeof i=="string"||e?t(i):i):n);class t2{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||ge(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=Di(t);let s;for(let u=0;u<this.parsers.length;u++){const c=this.parsers[u];if(c.test(e)){s=c.getCacheableAssets(i,e);break}}const r=new Map(Object.entries(s||{}));s||i.forEach(u=>{r.set(u,e)});const o=[...r.keys()],l={cacheKeys:o,keys:i};i.forEach(u=>{this._cacheMap.set(u,l)}),o.forEach(u=>{const c=s?s[u]:e;this._cache.has(u)&&this._cache.get(u)!==c&&ge("[Cache] already has key:",u),this._cache.set(u,r.get(u))})}remove(t){if(!this._cacheMap.has(t)){ge(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(s=>{this._cache.delete(s)}),e.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const he=new t2,Uh=[];Fe.handleByList(_t.TextureSource,Uh);function Jm(n={}){const t=n&&n.resource,e=t?n.resource:n,i=t?n:{resource:n};for(let s=0;s<Uh.length;s++){const r=Uh[s];if(r.test(e))return new r(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function e2(n={},t=!1){const e=n&&n.resource,i=e?n.resource:n,s=e?n:{resource:n};if(!t&&he.has(i))return he.get(i);const r=new Ot({source:Jm(s)});return r.on("destroy",()=>{he.has(i)&&he.remove(i)}),t||he.set(i,r),r}function i2(n,t=!1){return typeof n=="string"?he.get(n):n instanceof Pi?new Ot({source:n}):e2(n,t)}Ot.from=i2;Pi.from=Jm;Fe.add($m,Hm,qm,ja,mn,jm,hc);var ss=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(ss||{});function Bi(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function wr(n){return n.split("?")[0].split("#")[0]}function s2(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n2(n,t,e){return n.replace(new RegExp(s2(t),"g"),e)}function r2(n,t){let e="",i=0,s=-1,r=0,o=-1;for(let l=0;l<=n.length;++l){if(l<n.length)o=n.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(s===l-1||r===1))if(s!==l-1&&r===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const u=e.lastIndexOf("/");if(u!==e.length-1){u===-1?(e="",i=0):(e=e.slice(0,u),i=e.length-1-e.lastIndexOf("/")),s=l,r=0;continue}}else if(e.length===2||e.length===1){e="",i=0,s=l,r=0;continue}}}else e.length>0?e+=`/${n.slice(s+1,l)}`:e=n.slice(s+1,l),i=l-s-1;s=l,r=0}else o===46&&r!==-1?++r:r=-1}return e}const Ue={toPosix(n){return n2(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Bi(n),n=this.toPosix(n);const t=/^file:\/\/\//.exec(n);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(n);return e?e[0]:""},toAbsolute(n,t,e){if(Bi(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const i=wr(this.toPosix(t??ve.get().getBaseUrl())),s=wr(this.toPosix(e??this.rootname(i)));return n=this.toPosix(n),n.startsWith("/")?Ue.join(s,n.slice(1)):this.isAbsolute(n)?n:this.join(i,n)},normalize(n){if(Bi(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let t="";const e=n.startsWith("/");this.hasProtocol(n)&&(t=this.rootname(n),n=n.slice(t.length));const i=n.endsWith("/");return n=r2(n),n.length>0&&i&&(n+="/"),e?`/${n}`:t+n},isAbsolute(n){return Bi(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let t;for(let e=0;e<n.length;++e){const i=n[e];if(Bi(i),i.length>0)if(t===void 0)t=i;else{const s=n[e-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(n){if(Bi(n),n.length===0)return".";n=this.toPosix(n);let t=n.charCodeAt(0);const e=t===47;let i=-1,s=!0;const r=this.getProtocol(n),o=n;n=n.slice(r.length);for(let l=n.length-1;l>=1;--l)if(t=n.charCodeAt(l),t===47){if(!s){i=l;break}}else s=!1;return i===-1?e?"/":this.isUrl(o)?r+n:r:e&&i===1?"//":r+n.slice(0,i)},rootname(n){Bi(n),n=this.toPosix(n);let t="";if(n.startsWith("/")?t="/":t=this.getProtocol(n),this.isUrl(n)){const e=n.indexOf("/",t.length);e!==-1?t=n.slice(0,e):t=n,t.endsWith("/")||(t+="/")}return t},basename(n,t){Bi(n),t&&Bi(t),n=wr(this.toPosix(n));let e=0,i=-1,s=!0,r;if(t!==void 0&&t.length>0&&t.length<=n.length){if(t.length===n.length&&t===n)return"";let o=t.length-1,l=-1;for(r=n.length-1;r>=0;--r){const u=n.charCodeAt(r);if(u===47){if(!s){e=r+1;break}}else l===-1&&(s=!1,l=r+1),o>=0&&(u===t.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=l))}return e===i?i=l:i===-1&&(i=n.length),n.slice(e,i)}for(r=n.length-1;r>=0;--r)if(n.charCodeAt(r)===47){if(!s){e=r+1;break}}else i===-1&&(s=!1,i=r+1);return i===-1?"":n.slice(e,i)},extname(n){Bi(n),n=wr(this.toPosix(n));let t=-1,e=0,i=-1,s=!0,r=0;for(let o=n.length-1;o>=0;--o){const l=n.charCodeAt(o);if(l===47){if(!s){e=o+1;break}continue}i===-1&&(s=!1,i=o+1),l===46?t===-1?t=o:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||i===-1||r===0||r===1&&t===i-1&&t===e+1?"":n.slice(t,i)},parse(n){Bi(n);const t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;n=wr(this.toPosix(n));let e=n.charCodeAt(0);const i=this.isAbsolute(n);let s;t.root=this.rootname(n),i||this.hasProtocol(n)?s=1:s=0;let r=-1,o=0,l=-1,u=!0,c=n.length-1,f=0;for(;c>=s;--c){if(e=n.charCodeAt(c),e===47){if(!u){o=c+1;break}continue}l===-1&&(u=!1,l=c+1),e===46?r===-1?r=c:f!==1&&(f=1):r!==-1&&(f=-1)}return r===-1||l===-1||f===0||f===1&&r===l-1&&r===o+1?l!==-1&&(o===0&&i?t.base=t.name=n.slice(1,l):t.base=t.name=n.slice(o,l)):(o===0&&i?(t.name=n.slice(1,r),t.base=n.slice(1,l)):(t.name=n.slice(o,r),t.base=n.slice(o,l)),t.ext=n.slice(r,l)),t.dir=this.dirname(n),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function tg(n,t,e,i,s){const r=t[e];for(let o=0;o<r.length;o++){const l=r[o];e<t.length-1?tg(n.replace(i[e],l),t,e+1,i,s):s.push(n.replace(i[e],l))}}function a2(n){const t=/\{(.*?)\}/g,e=n.match(t),i=[];if(e){const s=[];e.forEach(r=>{const o=r.substring(1,r.length-1).split(",");s.push(o)}),tg(n,s,0,e,i)}else i.push(n);return i}const io=n=>!Array.isArray(n);class xn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return Di(e||i,r=>typeof r=="string"?r:Array.isArray(r)?r.map(o=>(o==null?void 0:o.src)??o):r!=null&&r.src?r.src:r,!0)}addManifest(t){this._manifest&&ge("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let s=e;Array.isArray(e)||(s=Object.entries(e).map(([r,o])=>typeof o=="string"||Array.isArray(o)?{alias:r,src:o}:{alias:r,...o})),s.forEach(r=>{const o=r.src,l=r.alias;let u;if(typeof l=="string"){const c=this._createBundleAssetId(t,l);i.push(c),u=[l,c]}else{const c=l.map(f=>this._createBundleAssetId(t,f));i.push(...c),u=[...l,...c]}this.add({...r,alias:u,src:o})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=r=>{this.hasKey(r)&&ge(`[Resolver] already has key: ${r} overwriting`)},Di(e).forEach(r=>{const{src:o}=r;let{data:l,format:u,loadParser:c}=r;const f=Di(o).map(p=>typeof p=="string"?a2(p):Array.isArray(p)?p:[p]),d=this.getAlias(r);Array.isArray(d)?d.forEach(i):i(d);const g=[];f.forEach(p=>{p.forEach(x=>{let y={};if(typeof x!="object"){y.src=x;for(let b=0;b<this._parsers.length;b++){const v=this._parsers[b];if(v.test(x)){y=v.parse(x);break}}}else l=x.data??l,u=x.format??u,c=x.loadParser??c,y={...y,...x};if(!d)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:d,data:l,format:u,loadParser:c}),g.push(y)})}),d.forEach(p=>{this._assetMap[p]=g})})}resolveBundle(t){const e=io(t);t=Di(t);const i={};return t.forEach(s=>{const r=this._bundles[s];if(r){const o=this.resolve(r),l={};for(const u in o){const c=o[u];l[this._extractAssetIdFromBundle(s,u)]=c}i[s]=l}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const s in e)i[s]=e[s].src;return i}return e.src}resolve(t){const e=io(t);t=Di(t);const i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let r=this._assetMap[s];const o=this._getPreferredOrder(r);o==null||o.priority.forEach(l=>{o.params[l].forEach(u=>{const c=r.filter(f=>f[l]?f[l]===u:!1);c.length&&(r=c)})}),this._resolverHash[s]=r[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[e],s=this._preferredOrder.find(r=>r.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:s,loadParser:r,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Ue.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=r??t.loadParser,t.format=o??t.format??o2(t.src),t}}xn.RETINA_PREFIX=/@([0-9\.]+)x/;function o2(n){return n.split(".").pop().split("?").shift().split("#").shift()}const so=(n,t)=>{const e=t.split("?")[1];return e&&(n+=`?${e}`),n},eg=class Mr{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof Ot?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const i=parseFloat(e.meta.scale);i?(this.resolution=i,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Mr.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=Mr.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const s=this._frameKeys[e],r=this._frames[s],o=r.frame;if(o){let l=null,u=null;const c=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,f=new Ve(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);r.rotated?l=new Ve(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new Ve(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(u=new Ve(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new Ot({source:this.textureSource,frame:l,orig:f,trim:u,rotate:r.rotated?2:0,defaultAnchor:r.anchor,defaultBorders:r.borders,label:s.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Mr.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Mr.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};eg.BATCH_SIZE=1e3;let up=eg;const l2=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function ig(n,t,e){const i={};if(n.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[s]=t.textures[s]}),!e){const s=Ue.dirname(n[0]);t.linkedSheets.forEach((r,o)=>{const l=ig([`${s}/${t.data.meta.related_multi_packs[o]}`],r,!0);Object.assign(i,l)})}return i}const h2={extension:_t.Asset,cache:{test:n=>n instanceof up,getCacheableAssets:(n,t)=>ig(n,t,!1)},resolver:{extension:{type:_t.ResolveParser,name:"resolveSpritesheet"},test:n=>{const e=n.split("?")[0].split("."),i=e.pop(),s=e.pop();return i==="json"&&l2.includes(s)},parse:n=>{var e;const t=n.split(".");return{resolution:parseFloat(((e=xn.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:t[t.length-2],src:n}}},loader:{name:"spritesheetLoader",extension:{type:_t.LoadParser,priority:ss.Normal,name:"spritesheetLoader"},async testParse(n,t){return Ue.extname(t.src).toLowerCase()===".json"&&!!n.frames},async parse(n,t,e){var f,d;const{texture:i,imageFilename:s,textureOptions:r}=(t==null?void 0:t.data)??{};let o=Ue.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l;if(i instanceof Ot)l=i;else{const g=so(o+(s??n.meta.image),t.src);l=(await e.load([{src:g,data:r}]))[g]}const u=new up(l.source,n);await u.parse();const c=(f=n==null?void 0:n.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(c)){const g=[];for(const x of c){if(typeof x!="string")continue;let y=o+x;(d=t.data)!=null&&d.ignoreMultiPack||(y=so(y,t.src),g.push(e.load({src:y,data:{textureOptions:r,ignoreMultiPack:!0}})))}const p=await Promise.all(g);u.linkedSheets=p,p.forEach(x=>{x.linkedSheets=[u].concat(u.linkedSheets.filter(y=>y!==x))})}return u},async unload(n,t,e){await e.unload(n.textureSource._sourceOrigin),n.destroy(!1)}}};Fe.add(h2);const rh=Object.create(null),fp=Object.create(null);function dc(n,t){let e=fp[n];return e===void 0&&(rh[t]===void 0&&(rh[t]=1),fp[n]=e=rh[t]++),e}let Ln;function sg(){return(!Ln||Ln!=null&&Ln.isContextLost())&&(Ln=ve.get().createCanvas().getContext("webgl",{})),Ln}let Ua;function c2(){if(!Ua){Ua="mediump";const n=sg();n&&n.getShaderPrecisionFormat&&(Ua=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?"highp":"mediump")}return Ua}function u2(n,t,e){return t?n:e?(n=n.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${n}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${n}
        `}function f2(n,t,e){const i=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(n.substring(0,9)!=="precision"){let s=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return s==="highp"&&i!=="highp"&&(s="mediump"),`precision ${s} float;
${n}`}else if(i!=="highp"&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}function d2(n,t){return t?`#version 300 es
${n}`:n}const p2={},m2={};function g2(n,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?p2:m2;return i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,n.indexOf("#define SHADER_NAME")!==-1?n:`${`#define SHADER_NAME ${t}`}
${n}`}function x2(n,t){return t?n.replace("#version 300 es",""):n}const ah={stripVersion:x2,ensurePrecision:f2,addProgramDefines:u2,setProgramName:g2,insertVersion:d2},oh=Object.create(null),ng=class Xh{constructor(t){t={...Xh.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:c2()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let s=t.fragment,r=t.vertex;Object.keys(ah).forEach(o=>{const l=i[o];s=ah[o](s,l,!0),r=ah[o](r,l,!1)}),this.fragment=s,this.vertex=r,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=dc(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return oh[e]||(oh[e]=new Xh(t)),oh[e]}};ng.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let rg=ng;const dp={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function y2(n){return dp[n]??dp.float32}const b2={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function _2({source:n,entryPoint:t}){const e={},i=n.indexOf(`fn ${t}`);if(i!==-1){const s=n.indexOf("->",i);if(s!==-1){const r=n.substring(i,s),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let l;for(;(l=o.exec(r))!==null;){const u=b2[l[3]]??"float32";e[l[2]]={location:parseInt(l[1],10),format:u,stride:y2(u).stride,offset:0,instance:!1,start:0}}}}return e}function lh(n){var d,g;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,s=/var(<[^>]+>)? (\w+)/,r=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,l=/(\w+)\s*:\s*([\w\<\>]+)/g,u=/struct\s+(\w+)/,c=(d=n.match(t))==null?void 0:d.map(p=>({group:parseInt(p.match(e)[1],10),binding:parseInt(p.match(i)[1],10),name:p.match(s)[2],isUniform:p.match(s)[1]==="<uniform>",type:p.match(r)[1]}));if(!c)return{groups:[],structs:[]};const f=((g=n.match(o))==null?void 0:g.map(p=>{const x=p.match(u)[1],y=p.match(l).reduce((b,v)=>{const[C,_]=v.split(":");return b[C.trim()]=_.trim(),b},{});return y?{name:x,members:y}:null}).filter(({name:p})=>c.some(x=>x.type===p)))??[];return{groups:c,structs:f}}var Pr=(n=>(n[n.VERTEX=1]="VERTEX",n[n.FRAGMENT=2]="FRAGMENT",n[n.COMPUTE=4]="COMPUTE",n))(Pr||{});function w2({groups:n}){const t=[];for(let e=0;e<n.length;e++){const i=n[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:Pr.VERTEX|Pr.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:Pr.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:Pr.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function v2({groups:n}){const t=[];for(let e=0;e<n.length;e++){const i=n[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}function S2(n,t){const e=new Set,i=new Set,s=[...n.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),r=[...n.groups,...t.groups].filter(o=>{const l=`${o.name}-${o.binding}`;return i.has(l)?!1:(i.add(l),!0)});return{structs:s,groups:r}}const hh=Object.create(null);class wo{constructor(t){var l,u;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:i,layout:s,gpuLayout:r,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=i,e.source===i.source){const c=lh(e.source);this.structsAndGroups=c}else{const c=lh(i.source),f=lh(e.source);this.structsAndGroups=S2(c,f)}this.layout=s??v2(this.structsAndGroups),this.gpuLayout=r??w2(this.structsAndGroups),this.autoAssignGlobalUniforms=((l=this.layout[0])==null?void 0:l.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((u=this.layout[1])==null?void 0:u.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,i=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=dc(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=_2(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return hh[e]||(hh[e]=new wo(t)),hh[e]}}const ag=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],A2=ag.reduce((n,t)=>(n[t]=!0,n),{});function C2(n,t){switch(n){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const og=class lg{constructor(t,e){this._touched=0,this.uid=Se("uniform"),this._resourceType="uniformGroup",this._resourceId=Se("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...lg.defaultOptions,...e},this.uniformStructures=t;const i={};for(const s in t){const r=t[s];if(r.name=s,r.size=r.size??1,!A2[r.type])throw new Error(`Uniform type ${r.type} is not supported. Supported uniform types are: ${ag.join(", ")}`);r.value??(r.value=C2(r.type,r.size)),i[s]=r.value}this.uniforms=i,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=dc(Object.keys(i).map(s=>`${s}-${t[s].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};og.defaultOptions={ubo:!1,isStatic:!1};let hg=og;class Ka{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const s=t[i];this.setResource(s,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){var s,r;const i=this.resources[e];t!==i&&(i&&((s=t.off)==null||s.call(t,"change",this.onResourceChange,this)),(r=t.on)==null||r.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){var e;const t=this.resources;for(const i in t){const s=t[i];(e=s.off)==null||e.call(s,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const i in e)e[i]===t&&(e[i]=null)}else this._updateKey()}}var Wh=(n=>(n[n.WEBGL=1]="WEBGL",n[n.WEBGPU=2]="WEBGPU",n[n.BOTH=3]="BOTH",n))(Wh||{});class vo extends is{constructor(t){super(),this.uid=Se("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:i,groups:s,resources:r,compatibleRenderers:o,groupMap:l}=t;this.gpuProgram=e,this.glProgram=i,o===void 0&&(o=0,e&&(o|=Wh.WEBGPU),i&&(o|=Wh.WEBGL)),this.compatibleRenderers=o;const u={};if(!r&&!s&&(r={}),r&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&s&&!l)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&s&&l)for(const c in l)for(const f in l[c]){const d=l[c][f];u[d]={group:c,binding:f,name:d}}else if(e&&s&&!l){const c=e.structsAndGroups.groups;l={},c.forEach(f=>{l[f.group]=l[f.group]||{},l[f.group][f.binding]=f.name,u[f.name]=f})}else if(r){s={},l={},e&&e.structsAndGroups.groups.forEach(d=>{l[d.group]=l[d.group]||{},l[d.group][d.binding]=d.name,u[d.name]=d});let c=0;for(const f in r)u[f]||(s[99]||(s[99]=new Ka,this._ownedBindGroups.push(s[99])),u[f]={group:99,binding:c,name:f},l[99]=l[99]||{},l[99][c]=f,c++);for(const f in r){const d=f;let g=r[f];!g.source&&!g._resourceType&&(g=new hg(g));const p=u[d];p&&(s[p.group]||(s[p.group]=new Ka,this._ownedBindGroups.push(s[p.group])),s[p.group].setResource(g,p.binding))}}this.groups=s,this._uniformBindMap=l,this.resources=this._buildResourceAccessor(s,u)}addResource(t,e,i){var s,r;(s=this._uniformBindMap)[e]||(s[e]={}),(r=this._uniformBindMap[e])[i]||(r[i]=t),this.groups[e]||(this.groups[e]=new Ka,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const i={};for(const s in e){const r=e[s];Object.defineProperty(i,r.name,{get(){return t[r.group].getResource(r.binding)},set(o){t[r.group].setResource(o,r.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(s=>{s.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:i,...s}=t;let r,o;return e&&(r=wo.from(e)),i&&(o=rg.from(i)),new vo({gpuProgram:r,glProgram:o,...s})}}var Xa={exports:{}},pp;function T2(){if(pp)return Xa.exports;pp=1,Xa.exports=n,Xa.exports.default=n;function n(E,L,Y){Y=Y||2;var W=L&&L.length,q=W?L[0]*Y:E.length,j=t(E,0,q,Y,!0),tt=[];if(!j||j.next===j.prev)return tt;var Z,ct,lt,Pt,Ct,gt,It;if(W&&(j=u(E,L,j,Y)),E.length>80*Y){Z=lt=E[0],ct=Pt=E[1];for(var wt=Y;wt<q;wt+=Y)Ct=E[wt],gt=E[wt+1],Ct<Z&&(Z=Ct),gt<ct&&(ct=gt),Ct>lt&&(lt=Ct),gt>Pt&&(Pt=gt);It=Math.max(lt-Z,Pt-ct),It=It!==0?32767/It:0}return i(j,tt,Y,Z,ct,It,0),tt}function t(E,L,Y,W,q){var j,tt;if(q===J(E,L,Y,W)>0)for(j=L;j<Y;j+=W)tt=et(j,E[j],E[j+1],tt);else for(j=Y-W;j>=L;j-=W)tt=et(j,E[j],E[j+1],tt);return tt&&S(tt,tt.next)&&(K(tt),tt=tt.next),tt}function e(E,L){if(!E)return E;L||(L=E);var Y=E,W;do if(W=!1,!Y.steiner&&(S(Y,Y.next)||_(Y.prev,Y,Y.next)===0)){if(K(Y),Y=L=Y.prev,Y===Y.next)break;W=!0}else Y=Y.next;while(W||Y!==L);return L}function i(E,L,Y,W,q,j,tt){if(E){!tt&&j&&p(E,W,q,j);for(var Z=E,ct,lt;E.prev!==E.next;){if(ct=E.prev,lt=E.next,j?r(E,W,q,j):s(E)){L.push(ct.i/Y|0),L.push(E.i/Y|0),L.push(lt.i/Y|0),K(E),E=lt.next,Z=lt.next;continue}if(E=lt,E===Z){tt?tt===1?(E=o(e(E),L,Y),i(E,L,Y,W,q,j,2)):tt===2&&l(E,L,Y,W,q,j):i(e(E),L,Y,W,q,j,1);break}}}}function s(E){var L=E.prev,Y=E,W=E.next;if(_(L,Y,W)>=0)return!1;for(var q=L.x,j=Y.x,tt=W.x,Z=L.y,ct=Y.y,lt=W.y,Pt=q<j?q<tt?q:tt:j<tt?j:tt,Ct=Z<ct?Z<lt?Z:lt:ct<lt?ct:lt,gt=q>j?q>tt?q:tt:j>tt?j:tt,It=Z>ct?Z>lt?Z:lt:ct>lt?ct:lt,wt=W.next;wt!==L;){if(wt.x>=Pt&&wt.x<=gt&&wt.y>=Ct&&wt.y<=It&&v(q,Z,j,ct,tt,lt,wt.x,wt.y)&&_(wt.prev,wt,wt.next)>=0)return!1;wt=wt.next}return!0}function r(E,L,Y,W){var q=E.prev,j=E,tt=E.next;if(_(q,j,tt)>=0)return!1;for(var Z=q.x,ct=j.x,lt=tt.x,Pt=q.y,Ct=j.y,gt=tt.y,It=Z<ct?Z<lt?Z:lt:ct<lt?ct:lt,wt=Pt<Ct?Pt<gt?Pt:gt:Ct<gt?Ct:gt,ee=Z>ct?Z>lt?Z:lt:ct>lt?ct:lt,ie=Pt>Ct?Pt>gt?Pt:gt:Ct>gt?Ct:gt,Pe=y(It,wt,L,Y,W),Kt=y(ee,ie,L,Y,W),St=E.prevZ,Dt=E.nextZ;St&&St.z>=Pe&&Dt&&Dt.z<=Kt;){if(St.x>=It&&St.x<=ee&&St.y>=wt&&St.y<=ie&&St!==q&&St!==tt&&v(Z,Pt,ct,Ct,lt,gt,St.x,St.y)&&_(St.prev,St,St.next)>=0||(St=St.prevZ,Dt.x>=It&&Dt.x<=ee&&Dt.y>=wt&&Dt.y<=ie&&Dt!==q&&Dt!==tt&&v(Z,Pt,ct,Ct,lt,gt,Dt.x,Dt.y)&&_(Dt.prev,Dt,Dt.next)>=0))return!1;Dt=Dt.nextZ}for(;St&&St.z>=Pe;){if(St.x>=It&&St.x<=ee&&St.y>=wt&&St.y<=ie&&St!==q&&St!==tt&&v(Z,Pt,ct,Ct,lt,gt,St.x,St.y)&&_(St.prev,St,St.next)>=0)return!1;St=St.prevZ}for(;Dt&&Dt.z<=Kt;){if(Dt.x>=It&&Dt.x<=ee&&Dt.y>=wt&&Dt.y<=ie&&Dt!==q&&Dt!==tt&&v(Z,Pt,ct,Ct,lt,gt,Dt.x,Dt.y)&&_(Dt.prev,Dt,Dt.next)>=0)return!1;Dt=Dt.nextZ}return!0}function o(E,L,Y){var W=E;do{var q=W.prev,j=W.next.next;!S(q,j)&&M(q,W,W.next,j)&&O(q,j)&&O(j,q)&&(L.push(q.i/Y|0),L.push(W.i/Y|0),L.push(j.i/Y|0),K(W),K(W.next),W=E=j),W=W.next}while(W!==E);return e(W)}function l(E,L,Y,W,q,j){var tt=E;do{for(var Z=tt.next.next;Z!==tt.prev;){if(tt.i!==Z.i&&C(tt,Z)){var ct=N(tt,Z);tt=e(tt,tt.next),ct=e(ct,ct.next),i(tt,L,Y,W,q,j,0),i(ct,L,Y,W,q,j,0);return}Z=Z.next}tt=tt.next}while(tt!==E)}function u(E,L,Y,W){var q=[],j,tt,Z,ct,lt;for(j=0,tt=L.length;j<tt;j++)Z=L[j]*W,ct=j<tt-1?L[j+1]*W:E.length,lt=t(E,Z,ct,W,!1),lt===lt.next&&(lt.steiner=!0),q.push(b(lt));for(q.sort(c),j=0;j<q.length;j++)Y=f(q[j],Y);return Y}function c(E,L){return E.x-L.x}function f(E,L){var Y=d(E,L);if(!Y)return L;var W=N(Y,E);return e(W,W.next),e(Y,Y.next)}function d(E,L){var Y=L,W=E.x,q=E.y,j=-1/0,tt;do{if(q<=Y.y&&q>=Y.next.y&&Y.next.y!==Y.y){var Z=Y.x+(q-Y.y)*(Y.next.x-Y.x)/(Y.next.y-Y.y);if(Z<=W&&Z>j&&(j=Z,tt=Y.x<Y.next.x?Y:Y.next,Z===W))return tt}Y=Y.next}while(Y!==L);if(!tt)return null;var ct=tt,lt=tt.x,Pt=tt.y,Ct=1/0,gt;Y=tt;do W>=Y.x&&Y.x>=lt&&W!==Y.x&&v(q<Pt?W:j,q,lt,Pt,q<Pt?j:W,q,Y.x,Y.y)&&(gt=Math.abs(q-Y.y)/(W-Y.x),O(Y,E)&&(gt<Ct||gt===Ct&&(Y.x>tt.x||Y.x===tt.x&&g(tt,Y)))&&(tt=Y,Ct=gt)),Y=Y.next;while(Y!==ct);return tt}function g(E,L){return _(E.prev,E,L.prev)<0&&_(L.next,E,E.next)<0}function p(E,L,Y,W){var q=E;do q.z===0&&(q.z=y(q.x,q.y,L,Y,W)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==E);q.prevZ.nextZ=null,q.prevZ=null,x(q)}function x(E){var L,Y,W,q,j,tt,Z,ct,lt=1;do{for(Y=E,E=null,j=null,tt=0;Y;){for(tt++,W=Y,Z=0,L=0;L<lt&&(Z++,W=W.nextZ,!!W);L++);for(ct=lt;Z>0||ct>0&&W;)Z!==0&&(ct===0||!W||Y.z<=W.z)?(q=Y,Y=Y.nextZ,Z--):(q=W,W=W.nextZ,ct--),j?j.nextZ=q:E=q,q.prevZ=j,j=q;Y=W}j.nextZ=null,lt*=2}while(tt>1);return E}function y(E,L,Y,W,q){return E=(E-Y)*q|0,L=(L-W)*q|0,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,E|L<<1}function b(E){var L=E,Y=E;do(L.x<Y.x||L.x===Y.x&&L.y<Y.y)&&(Y=L),L=L.next;while(L!==E);return Y}function v(E,L,Y,W,q,j,tt,Z){return(q-tt)*(L-Z)>=(E-tt)*(j-Z)&&(E-tt)*(W-Z)>=(Y-tt)*(L-Z)&&(Y-tt)*(j-Z)>=(q-tt)*(W-Z)}function C(E,L){return E.next.i!==L.i&&E.prev.i!==L.i&&!B(E,L)&&(O(E,L)&&O(L,E)&&U(E,L)&&(_(E.prev,E,L.prev)||_(E,L.prev,L))||S(E,L)&&_(E.prev,E,E.next)>0&&_(L.prev,L,L.next)>0)}function _(E,L,Y){return(L.y-E.y)*(Y.x-L.x)-(L.x-E.x)*(Y.y-L.y)}function S(E,L){return E.x===L.x&&E.y===L.y}function M(E,L,Y,W){var q=P(_(E,L,Y)),j=P(_(E,L,W)),tt=P(_(Y,W,E)),Z=P(_(Y,W,L));return!!(q!==j&&tt!==Z||q===0&&T(E,Y,L)||j===0&&T(E,W,L)||tt===0&&T(Y,E,W)||Z===0&&T(Y,L,W))}function T(E,L,Y){return L.x<=Math.max(E.x,Y.x)&&L.x>=Math.min(E.x,Y.x)&&L.y<=Math.max(E.y,Y.y)&&L.y>=Math.min(E.y,Y.y)}function P(E){return E>0?1:E<0?-1:0}function B(E,L){var Y=E;do{if(Y.i!==E.i&&Y.next.i!==E.i&&Y.i!==L.i&&Y.next.i!==L.i&&M(Y,Y.next,E,L))return!0;Y=Y.next}while(Y!==E);return!1}function O(E,L){return _(E.prev,E,E.next)<0?_(E,L,E.next)>=0&&_(E,E.prev,L)>=0:_(E,L,E.prev)<0||_(E,E.next,L)<0}function U(E,L){var Y=E,W=!1,q=(E.x+L.x)/2,j=(E.y+L.y)/2;do Y.y>j!=Y.next.y>j&&Y.next.y!==Y.y&&q<(Y.next.x-Y.x)*(j-Y.y)/(Y.next.y-Y.y)+Y.x&&(W=!W),Y=Y.next;while(Y!==E);return W}function N(E,L){var Y=new V(E.i,E.x,E.y),W=new V(L.i,L.x,L.y),q=E.next,j=L.prev;return E.next=L,L.prev=E,Y.next=q,q.prev=Y,W.next=Y,Y.prev=W,j.next=W,W.prev=j,W}function et(E,L,Y,W){var q=new V(E,L,Y);return W?(q.next=W.next,q.prev=W,W.next.prev=q,W.next=q):(q.prev=q,q.next=q),q}function K(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function V(E,L,Y){this.i=E,this.x=L,this.y=Y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}n.deviation=function(E,L,Y,W){var q=L&&L.length,j=q?L[0]*Y:E.length,tt=Math.abs(J(E,0,j,Y));if(q)for(var Z=0,ct=L.length;Z<ct;Z++){var lt=L[Z]*Y,Pt=Z<ct-1?L[Z+1]*Y:E.length;tt-=Math.abs(J(E,lt,Pt,Y))}var Ct=0;for(Z=0;Z<W.length;Z+=3){var gt=W[Z]*Y,It=W[Z+1]*Y,wt=W[Z+2]*Y;Ct+=Math.abs((E[gt]-E[wt])*(E[It+1]-E[gt+1])-(E[gt]-E[It])*(E[wt+1]-E[gt+1]))}return tt===0&&Ct===0?0:Math.abs((Ct-tt)/tt)};function J(E,L,Y,W){for(var q=0,j=L,tt=Y-W;j<Y;j+=W)q+=(E[tt]-E[j])*(E[j+1]+E[tt+1]),tt=j;return q}return n.flatten=function(E){for(var L=E[0][0].length,Y={vertices:[],holes:[],dimensions:L},W=0,q=0;q<E.length;q++){for(var j=0;j<E[q].length;j++)for(var tt=0;tt<L;tt++)Y.vertices.push(E[q][j][tt]);q>0&&(W+=E[q-1].length,Y.holes.push(W))}return Y},Xa.exports}var M2=T2();const P2=Nr(M2);class cg extends is{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return jt(le,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return jt(le,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return jt(le,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return jt(le,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return jt(le,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(e=this.chars[i].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}const mp=[{offset:0,color:"white"},{offset:1,color:"black"}],pc=class zh{constructor(...t){this.uid=Se("fillGradient"),this.type="linear",this.colorStops=[];let e=I2(t);e={...e.type==="radial"?zh.defaultRadialOptions:zh.defaultLinearOptions,...Pm(e)},this._textureSize=e.textureSize,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(s=>{this.addColorStop(s.offset,s.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:Be.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:mp,e=this._textureSize,{canvas:i,context:s}=xp(e,1),r=s.createLinearGradient(0,0,this._textureSize,0);gp(r,t),s.fillStyle=r,s.fillRect(0,0,e,1),this.texture=new Ot({source:new mn({resource:i})});const{x:o,y:l}=this.start,{x:u,y:c}=this.end,f=new Vt,d=u-o,g=c-l,p=Math.sqrt(d*d+g*g),x=Math.atan2(g,d);f.scale(p/e,1),f.rotate(x),f.translate(o,l),this.textureSpace==="local"&&f.scale(e,e),this.transform=f}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:mp,e=this._textureSize,{canvas:i,context:s}=xp(e,e),{x:r,y:o}=this.center,{x:l,y:u}=this.outerCenter,c=this.innerRadius,f=this.outerRadius,d=l-f,g=u-f,p=e/(f*2),x=(r-d)*p,y=(o-g)*p,b=s.createRadialGradient(x,y,c*p,(l-d)*p,(u-g)*p,f*p);gp(b,t),s.fillStyle=t[t.length-1].color,s.fillRect(0,0,e,e),s.fillStyle=b,s.translate(x,y),s.rotate(this.rotation),s.scale(1,this.scale),s.translate(-x,-y),s.fillRect(0,0,e,e),this.texture=new Ot({source:new mn({resource:i,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const v=new Vt;v.scale(1/p,1/p),v.translate(d,g),this.textureSpace==="local"&&v.scale(e,e),this.transform=v}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};pc.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};pc.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let zs=pc;function gp(n,t){for(let e=0;e<t.length;e++){const i=t[e];n.addColorStop(i.offset,i.color)}}function xp(n,t){const e=ve.get().createCanvas(n,t),i=e.getContext("2d");return{canvas:e,context:i}}function I2(n){let t=n[0]??{};return(typeof t=="number"||n[1])&&(jt("8.5.2","use options object instead"),t={type:"linear",start:{x:n[0],y:n[1]},end:{x:n[2],y:n[3]},textureSpace:n[4],textureSize:n[5]??zs.defaultLinearOptions.textureSize}),t}const yp={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class So{constructor(t,e){this.uid=Se("fillPattern"),this.transform=new Vt,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=yp[e].addressModeU,t.source.style.addressModeV=yp[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var ch,bp;function k2(){if(bp)return ch;bp=1,ch=e;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(r){var o=[];return r.replace(t,function(l,u,c){var f=u.toLowerCase();for(c=s(c),f=="m"&&c.length>2&&(o.push([u].concat(c.splice(0,2))),f="l",u=u=="m"?"l":"L");;){if(c.length==n[f])return c.unshift(u),o.push(c);if(c.length<n[f])throw new Error("malformed path data");o.push([u].concat(c.splice(0,n[f])))}}),o}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(r){var o=r.match(i);return o?o.map(Number):[]}return ch}var E2=k2();const R2=Nr(E2);function F2(n,t){const e=R2(n),i=[];let s=null,r=0,o=0;for(let l=0;l<e.length;l++){const u=e[l],c=u[0],f=u;switch(c){case"M":r=f[1],o=f[2],t.moveTo(r,o);break;case"m":r+=f[1],o+=f[2],t.moveTo(r,o);break;case"H":r=f[1],t.lineTo(r,o);break;case"h":r+=f[1],t.lineTo(r,o);break;case"V":o=f[1],t.lineTo(r,o);break;case"v":o+=f[1],t.lineTo(r,o);break;case"L":r=f[1],o=f[2],t.lineTo(r,o);break;case"l":r+=f[1],o+=f[2],t.lineTo(r,o);break;case"C":r=f[5],o=f[6],t.bezierCurveTo(f[1],f[2],f[3],f[4],r,o);break;case"c":t.bezierCurveTo(r+f[1],o+f[2],r+f[3],o+f[4],r+f[5],o+f[6]),r+=f[5],o+=f[6];break;case"S":r=f[3],o=f[4],t.bezierCurveToShort(f[1],f[2],r,o);break;case"s":t.bezierCurveToShort(r+f[1],o+f[2],r+f[3],o+f[4]),r+=f[3],o+=f[4];break;case"Q":r=f[3],o=f[4],t.quadraticCurveTo(f[1],f[2],r,o);break;case"q":t.quadraticCurveTo(r+f[1],o+f[2],r+f[3],o+f[4]),r+=f[3],o+=f[4];break;case"T":r=f[1],o=f[2],t.quadraticCurveToShort(r,o);break;case"t":r+=f[1],o+=f[2],t.quadraticCurveToShort(r,o);break;case"A":r=f[6],o=f[7],t.arcToSvg(f[1],f[2],f[3],f[4],f[5],r,o);break;case"a":r+=f[6],o+=f[7],t.arcToSvg(f[1],f[2],f[3],f[4],f[5],r,o);break;case"Z":case"z":t.closePath(),i.length>0&&(s=i.pop(),s?(r=s.startX,o=s.startY):(r=0,o=0)),s=null;break;default:ge(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&s===null&&(s={startX:r,startY:o},i.push(s))}return t}class mc{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new mc(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-t,r=this.y-e;return s*=s,r*=r,s+r<=i}strokeContains(t,e,i,s=.5){if(this.radius===0)return!1;const r=this.x-t,o=this.y-e,l=this.radius,u=(1-s)*i,c=Math.sqrt(r*r+o*o);return c<=l+u&&c>l-(i-u)}getBounds(t){return t||(t=new Ve),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class gc{constructor(t=0,e=0,i=0,s=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=s}clone(){return new gc(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,s=(e-this.y)/this.halfHeight;return i*=i,s*=s,i+s<=1}strokeContains(t,e,i,s=.5){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const l=i*(1-s),u=i-l,c=r-u,f=o-u,d=r+l,g=o+l,p=t-this.x,x=e-this.y,y=p*p/(c*c)+x*x/(f*f),b=p*p/(d*d)+x*x/(g*g);return y>1&&b<=1}getBounds(t){return t||(t=new Ve),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function B2(n,t,e,i,s,r){const o=n-e,l=t-i,u=s-e,c=r-i,f=o*u+l*c,d=u*u+c*c;let g=-1;d!==0&&(g=f/d);let p,x;g<0?(p=e,x=i):g>1?(p=s,x=r):(p=e+g*u,x=i+g*c);const y=n-p,b=t-x;return y*y+b*b}let L2,O2;class kr{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let s=0,r=e.length;s<r;s++)i.push(e[s].x,e[s].y);e=i}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,i=e.length;for(let s=0;s<i;s+=2){const r=e[s],o=e[s+1],l=e[(s+2)%i],u=e[(s+3)%i];t+=(l-r)*(u+o)}return t<0}containsPolygon(t){const e=this.getBounds(L2),i=t.getBounds(O2);if(!e.containsRect(i))return!1;const s=t.points;for(let r=0;r<s.length;r+=2){const o=s[r],l=s[r+1];if(!this.contains(o,l))return!1}return!0}clone(){const t=this.points.slice(),e=new kr(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const s=this.points.length/2;for(let r=0,o=s-1;r<s;o=r++){const l=this.points[r*2],u=this.points[r*2+1],c=this.points[o*2],f=this.points[o*2+1];u>e!=f>e&&t<(c-l)*((e-u)/(f-u))+l&&(i=!i)}return i}strokeContains(t,e,i,s=.5){const r=i*i,o=r*(1-s),l=r-o,{points:u}=this,c=u.length-(this.closePath?0:2);for(let f=0;f<c;f+=2){const d=u[f],g=u[f+1],p=u[(f+2)%u.length],x=u[(f+3)%u.length],y=B2(t,e,d,g,p,x),b=Math.sign((p-d)*(e-g)-(x-g)*(t-d));if(y<=(b<0?l:o))return!0}return!1}getBounds(t){t||(t=new Ve);const e=this.points;let i=1/0,s=-1/0,r=1/0,o=-1/0;for(let l=0,u=e.length;l<u;l+=2){const c=e[l],f=e[l+1];i=c<i?c:i,s=c>s?c:s,r=f<r?f:r,o=f>o?f:o}return t.x=i,t.width=s-i,t.y=r,t.height=o-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Wa=(n,t,e,i,s,r,o)=>{const l=n-e,u=t-i,c=Math.sqrt(l*l+u*u);return c>=s-r&&c<=s+o};class xc{constructor(t=0,e=0,i=0,s=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=s,this.radius=r}getBounds(t){return t||(t=new Ve),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new xc(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),r=e-(this.y+i);const o=i*i;if(s*s+r*r<=o||(s=t-(this.x+this.width-i),s*s+r*r<=o)||(r=e-(this.y+this.height-i),s*s+r*r<=o)||(s=t-(this.x+i),s*s+r*r<=o))return!0}return!1}strokeContains(t,e,i,s=.5){const{x:r,y:o,width:l,height:u,radius:c}=this,f=i*(1-s),d=i-f,g=r+c,p=o+c,x=l-c*2,y=u-c*2,b=r+l,v=o+u;return(t>=r-f&&t<=r+d||t>=b-d&&t<=b+f)&&e>=p&&e<=p+y||(e>=o-f&&e<=o+d||e>=v-d&&e<=v+f)&&t>=g&&t<=g+x?!0:t<g&&e<p&&Wa(t,e,g,p,c,d,f)||t>b-c&&e<p&&Wa(t,e,b-c,p,c,d,f)||t>b-c&&e>v-c&&Wa(t,e,b-c,v-c,c,d,f)||t<g&&e>v-c&&Wa(t,e,g,v-c,c,d,f)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const D2=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Y2(n){let t="";for(let e=0;e<n;++e)e>0&&(t+=`
else `),e<n-1&&(t+=`if(test == ${e}.0){}`);return t}function N2(n,t){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const i=D2.replace(/%forloop%/gi,Y2(n));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))n=n/2|0;else break}}finally{t.deleteShader(e)}return n}let On=null;function ug(){var t;if(On)return On;const n=sg();return On=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),On=N2(On,n),(t=n.getExtension("WEBGL_lose_context"))==null||t.loseContext(),On}const fg={};function U2(n,t){let e=2166136261;for(let i=0;i<t;i++)e^=n[i].uid,e=Math.imul(e,16777619),e>>>=0;return fg[e]||X2(n,t,e)}let uh=0;function X2(n,t,e){const i={};let s=0;uh||(uh=ug());for(let o=0;o<uh;o++){const l=o<t?n[o]:Ot.EMPTY.source;i[s++]=l.source,i[s++]=l.style}const r=new Ka(i);return fg[e]=r,r}class _p{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Gh(n,t){const e=n.byteLength/8|0,i=new Float64Array(n,0,e);new Float64Array(t,0,e).set(i);const r=n.byteLength-e*8;if(r>0){const o=new Uint8Array(n,e*8,r);new Uint8Array(t,e*8,r).set(o)}}const W2={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var z2=(n=>(n[n.DISABLED=0]="DISABLED",n[n.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",n[n.MASK_ACTIVE=2]="MASK_ACTIVE",n[n.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",n[n.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",n[n.NONE=5]="NONE",n))(z2||{});function wp(n,t){return t.alphaMode==="no-premultiply-alpha"&&W2[n]||n}class G2{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class V2{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new G2,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const dg=[];let Vh=0;function vp(){return Vh>0?dg[--Vh]:new V2}function Sp(n){dg[Vh++]=n}let vr=0;const pg=class Za{constructor(t={}){this.uid=Se("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],Za.defaultOptions.maxTextures=Za.defaultOptions.maxTextures??ug(),t={...Za.defaultOptions,...t};const{maxTextures:e,attributesInitialSize:i,indicesInitialSize:s}=t;this.attributeBuffer=new _p(i*4),this.indexBuffer=new Uint16Array(s),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Sp(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const i=t._batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t._textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let i=vp(),s=i.textures;s.clear();const r=e[this.elementStart];let o=wp(r.blendMode,r.texture._source),l=r.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const u=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,f=this.indexBuffer;let d=this._batchIndexSize,g=this._batchIndexStart,p="startBatch";const x=this.maxTextures;for(let y=this.elementStart;y<this.elementSize;++y){const b=e[y];e[y]=null;const C=b.texture._source,_=wp(b.blendMode,C),S=o!==_||l!==b.topology;if(C._batchTick===vr&&!S){b._textureId=C._textureBindLocation,d+=b.indexSize,b.packAsQuad?(this.packQuadAttributes(b,u,c,b._attributeStart,b._textureId),this.packQuadIndex(f,b._indexStart,b._attributeStart/this.vertexSize)):(this.packAttributes(b,u,c,b._attributeStart,b._textureId),this.packIndex(b,f,b._indexStart,b._attributeStart/this.vertexSize)),b._batch=i;continue}C._batchTick=vr,(s.count>=x||S)&&(this._finishBatch(i,g,d-g,s,o,l,t,p),p="renderBatch",g=d,o=_,l=b.topology,i=vp(),s=i.textures,s.clear(),++vr),b._textureId=C._textureBindLocation=s.count,s.ids[C.uid]=s.count,s.textures[s.count++]=C,b._batch=i,d+=b.indexSize,b.packAsQuad?(this.packQuadAttributes(b,u,c,b._attributeStart,b._textureId),this.packQuadIndex(f,b._indexStart,b._attributeStart/this.vertexSize)):(this.packAttributes(b,u,c,b._attributeStart,b._textureId),this.packIndex(b,f,b._indexStart,b._attributeStart/this.vertexSize))}s.count>0&&(this._finishBatch(i,g,d-g,s,o,l,t,p),g=d,++vr),this.elementStart=this.elementSize,this._batchIndexStart=g,this._batchIndexSize=d}_finishBatch(t,e,i,s,r,o,l,u){t.gpuBindGroup=null,t.bindGroup=null,t.action=u,t.batcher=this,t.textures=s,t.blendMode=r,t.topology=o,t.start=e,t.size=i,++vr,this.batches[this.batchIndex++]=t,l.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new _p(e);Gh(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const s=i>65535?new Uint32Array(i):new Uint16Array(i);if(s.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let r=0;r<e.length;r++)s[r]=e[r];else Gh(e.buffer,s.buffer);this.indexBuffer=s}packQuadIndex(t,e,i){t[e]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3}packIndex(t,e,i,s){const r=t.indices,o=t.indexSize,l=t.indexOffset,u=t.attributeOffset;for(let c=0;c<o;c++)e[i++]=s+r[c+l]-u}destroy(){for(let t=0;t<this.batches.length;t++)Sp(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};pg.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let mg=pg;var Re=(n=>(n[n.MAP_READ=1]="MAP_READ",n[n.MAP_WRITE=2]="MAP_WRITE",n[n.COPY_SRC=4]="COPY_SRC",n[n.COPY_DST=8]="COPY_DST",n[n.INDEX=16]="INDEX",n[n.VERTEX=32]="VERTEX",n[n.UNIFORM=64]="UNIFORM",n[n.STORAGE=128]="STORAGE",n[n.INDIRECT=256]="INDIRECT",n[n.QUERY_RESOLVE=512]="QUERY_RESOLVE",n[n.STATIC=1024]="STATIC",n))(Re||{});class gn extends is{constructor(t){let{data:e,size:i}=t;const{usage:s,label:r,shrinkToFit:o}=t;super(),this.uid=Se("buffer"),this._resourceType="buffer",this._resourceId=Se("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i??(i=e==null?void 0:e.byteLength);const l=!!e;this.descriptor={size:i,usage:s,mappedAtCreation:l,label:r},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&Re.STATIC)}set static(t){t?this.descriptor.usage|=Re.STATIC:this.descriptor.usage&=~Re.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const s=this._data;if(this._data=t,this._dataInt32=null,!s||s.length!==t.length){!this.shrinkToFit&&s&&t.byteLength<s.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Se("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function gg(n,t){if(!(n instanceof gn)){let e=t?Re.INDEX:Re.VERTEX;n instanceof Array&&(t?(n=new Uint32Array(n),e=Re.INDEX|Re.COPY_DST):(n=new Float32Array(n),e=Re.VERTEX|Re.COPY_DST)),n=new gn({data:n,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return n}function $2(n,t,e){const i=n.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const s=i.buffer.data;let r=1/0,o=1/0,l=-1/0,u=-1/0;const c=s.BYTES_PER_ELEMENT,f=(i.offset||0)/c,d=(i.stride||2*4)/c;for(let g=f;g<s.length;g+=d){const p=s[g],x=s[g+1];p>l&&(l=p),x>u&&(u=x),p<r&&(r=p),x<o&&(o=x)}return e.minX=r,e.minY=o,e.maxX=l,e.maxY=u,e}function H2(n){return(n instanceof gn||Array.isArray(n)||n.BYTES_PER_ELEMENT)&&(n={buffer:n}),n.buffer=gg(n.buffer,!1),n}class xg extends is{constructor(t={}){super(),this.uid=Se("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Ui,this._boundsDirty=!0;const{attributes:e,indexBuffer:i,topology:s}=t;if(this.buffers=[],this.attributes={},e)for(const r in e)this.addAttribute(r,e[r]);this.instanceCount=t.instanceCount??1,i&&this.addIndex(i),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const i=H2(e);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=i}addIndex(t){this.indexBuffer=gg(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,$2(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const q2=new Float32Array(1),j2=new Uint32Array(1);class K2 extends xg{constructor(){const e=new gn({data:q2,label:"attribute-batch-buffer",usage:Re.VERTEX|Re.COPY_DST,shrinkToFit:!1}),i=new gn({data:j2,label:"index-batch-buffer",usage:Re.INDEX|Re.COPY_DST,shrinkToFit:!1}),s=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:s,offset:0},aUV:{buffer:e,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:s,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:s,offset:5*4}},indexBuffer:i})}}function Ap(n,t,e){if(n)for(const i in n){const s=i.toLocaleLowerCase(),r=t[s];if(r){let o=n[i];i==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&r.push(`//----${e}----//`),r.push(o)}else ge(`${i} placement hook does not exist in shader`)}}const Z2=/\{\{(.*?)\}\}/g;function Cp(n){var i;const t={};return(((i=n.match(Z2))==null?void 0:i.map(s=>s.replace(/[{()}]/g,"")))??[]).forEach(s=>{t[s]=[]}),t}function Tp(n,t){let e;const i=/@in\s+([^;]+);/g;for(;(e=i.exec(n))!==null;)t.push(e[1])}function Mp(n,t,e=!1){const i=[];Tp(t,i),n.forEach(l=>{l.header&&Tp(l.header,i)});const s=i;e&&s.sort();const r=s.map((l,u)=>`       @location(${u}) ${l},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${r}
`),o}function Pp(n,t){let e;const i=/@out\s+([^;]+);/g;for(;(e=i.exec(n))!==null;)t.push(e[1])}function Q2(n){const e=/\b(\w+)\s*:/g.exec(n);return e?e[1]:""}function J2(n){const t=/@.*?\s+/g;return n.replace(t,"")}function tT(n,t){const e=[];Pp(t,e),n.forEach(u=>{u.header&&Pp(u.header,e)});let i=0;const s=e.sort().map(u=>u.indexOf("builtin")>-1?u:`@location(${i++}) ${u}`).join(`,
`),r=e.sort().map(u=>`       var ${J2(u)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(u=>` ${Q2(u)}`).join(`,
`)});`;let l=t.replace(/@out\s+[^;]+;\s*/g,"");return l=l.replace("{{struct}}",`
${s}
`),l=l.replace("{{start}}",`
${r}
`),l=l.replace("{{return}}",`
${o}
`),l}function Ip(n,t){let e=n;for(const i in t){const s=t[i];s.join(`
`).length?e=e.replace(`{{${i}}}`,`//-----${i} START-----//
${s.join(`
`)}
//----${i} FINISH----//`):e=e.replace(`{{${i}}}`,"")}return e}const Us=Object.create(null),fh=new Map;let eT=0;function iT({template:n,bits:t}){const e=yg(n,t);if(Us[e])return Us[e];const{vertex:i,fragment:s}=nT(n,t);return Us[e]=bg(i,s,t),Us[e]}function sT({template:n,bits:t}){const e=yg(n,t);return Us[e]||(Us[e]=bg(n.vertex,n.fragment,t)),Us[e]}function nT(n,t){const e=t.map(o=>o.vertex).filter(o=>!!o),i=t.map(o=>o.fragment).filter(o=>!!o);let s=Mp(e,n.vertex,!0);s=tT(e,s);const r=Mp(i,n.fragment,!0);return{vertex:s,fragment:r}}function yg(n,t){return t.map(e=>(fh.has(e)||fh.set(e,eT++),fh.get(e))).sort((e,i)=>e-i).join("-")+n.vertex+n.fragment}function bg(n,t,e){const i=Cp(n),s=Cp(t);return e.forEach(r=>{Ap(r.vertex,i,r.name),Ap(r.fragment,s,r.name)}),{vertex:Ip(n,i),fragment:Ip(t,s)}}const rT=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,aT=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,oT=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,lT=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,hT={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},cT={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function _g({bits:n,name:t}){const e=iT({template:{fragment:aT,vertex:rT},bits:[hT,...n]});return wo.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function wg({bits:n,name:t}){return new rg({name:t,...sT({template:{vertex:oT,fragment:lT},bits:[cT,...n]})})}const vg={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Sg={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},dh={};function uT(n){const t=[];if(n===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let i=0;i<n;i++)t.push(`@group(1) @binding(${e++}) var textureSource${i+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${i+1}: sampler;`)}return t.join(`
`)}function fT(n){const t=[];if(n===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<n;e++)e===n-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Ag(n){return dh[n]||(dh[n]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${uT(n)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${fT(n)}
            `}}),dh[n]}const ph={};function dT(n){const t=[];for(let e=0;e<n;e++)e>0&&t.push("else"),e<n-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Cg(n){return ph[n]||(ph[n]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${n}];

            `,main:`

                ${dT(n)}
            `}}),ph[n]}const Tg={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Mg={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},kp={};function Pg(n){let t=kp[n];if(t)return t;const e=new Int32Array(n);for(let i=0;i<n;i++)e[i]=i;return t=kp[n]=new hg({uTextures:{value:e,type:"i32",size:n}},{isStatic:!0}),t}class pT extends vo{constructor(t){const e=wg({name:"batch",bits:[Sg,Cg(t),Mg]}),i=_g({name:"batch",bits:[vg,Ag(t),Tg]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:Pg(t)}})}}let Ep=null;const Ig=class kg extends mg{constructor(){super(...arguments),this.geometry=new K2,this.shader=Ep||(Ep=new pT(this.maxTextures)),this.name=kg.extension.name,this.vertexSize=6}packAttributes(t,e,i,s,r){const o=r<<16|t.roundPixels&65535,l=t.transform,u=l.a,c=l.b,f=l.c,d=l.d,g=l.tx,p=l.ty,{positions:x,uvs:y}=t,b=t.color,v=t.attributeOffset,C=v+t.attributeSize;for(let _=v;_<C;_++){const S=_*2,M=x[S],T=x[S+1];e[s++]=u*M+f*T+g,e[s++]=d*T+c*M+p,e[s++]=y[S],e[s++]=y[S+1],i[s++]=b,i[s++]=o}}packQuadAttributes(t,e,i,s,r){const o=t.texture,l=t.transform,u=l.a,c=l.b,f=l.c,d=l.d,g=l.tx,p=l.ty,x=t.bounds,y=x.maxX,b=x.minX,v=x.maxY,C=x.minY,_=o.uvs,S=t.color,M=r<<16|t.roundPixels&65535;e[s+0]=u*b+f*C+g,e[s+1]=d*C+c*b+p,e[s+2]=_.x0,e[s+3]=_.y0,i[s+4]=S,i[s+5]=M,e[s+6]=u*y+f*C+g,e[s+7]=d*C+c*y+p,e[s+8]=_.x1,e[s+9]=_.y1,i[s+10]=S,i[s+11]=M,e[s+12]=u*y+f*v+g,e[s+13]=d*v+c*y+p,e[s+14]=_.x2,e[s+15]=_.y2,i[s+16]=S,i[s+17]=M,e[s+18]=u*b+f*v+g,e[s+19]=d*v+c*b+p,e[s+20]=_.x3,e[s+21]=_.y3,i[s+22]=S,i[s+23]=M}};Ig.extension={type:[_t.Batcher],name:"default"};let mT=Ig;function gT(n,t,e,i,s,r,o,l=null){let u=0;e*=t,s*=r;const c=l.a,f=l.b,d=l.c,g=l.d,p=l.tx,x=l.ty;for(;u<o;){const y=n[e],b=n[e+1];i[s]=c*y+d*b+p,i[s+1]=f*y+g*b+x,s+=r,e+=t,u++}}function xT(n,t,e,i){let s=0;for(t*=e;s<i;)n[t]=0,n[t+1]=0,t+=e,s++}function Eg(n,t,e,i,s){const r=t.a,o=t.b,l=t.c,u=t.d,c=t.tx,f=t.ty;e||(e=0),i||(i=2),s||(s=n.length/i-e);let d=e*i;for(let g=0;g<s;g++){const p=n[d],x=n[d+1];n[d]=r*p+l*x+c,n[d+1]=o*p+u*x+f,d+=i}}const yT=new Vt;class Rg{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,i=this.renderable;return i?Ym(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||yT}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Rr={extension:{type:_t.ShapeBuilder,name:"circle"},build(n,t){let e,i,s,r,o,l;if(n.type==="circle"){const S=n;e=S.x,i=S.y,o=l=S.radius,s=r=0}else if(n.type==="ellipse"){const S=n;e=S.x,i=S.y,o=S.halfWidth,l=S.halfHeight,s=r=0}else{const S=n,M=S.width/2,T=S.height/2;e=S.x+M,i=S.y+T,o=l=Math.max(0,Math.min(S.radius,Math.min(M,T))),s=M-o,r=T-l}if(!(o>=0&&l>=0&&s>=0&&r>=0))return t;const u=Math.ceil(2.3*Math.sqrt(o+l)),c=u*8+(s?4:0)+(r?4:0);if(c===0)return t;if(u===0)return t[0]=t[6]=e+s,t[1]=t[3]=i+r,t[2]=t[4]=e-s,t[5]=t[7]=i-r,t;let f=0,d=u*4+(s?2:0)+2,g=d,p=c,x=s+o,y=r,b=e+x,v=e-x,C=i+y;if(t[f++]=b,t[f++]=C,t[--d]=C,t[--d]=v,r){const S=i-y;t[g++]=v,t[g++]=S,t[--p]=S,t[--p]=b}for(let S=1;S<u;S++){const M=Math.PI/2*(S/u),T=s+Math.cos(M)*o,P=r+Math.sin(M)*l,B=e+T,O=e-T,U=i+P,N=i-P;t[f++]=B,t[f++]=U,t[--d]=U,t[--d]=O,t[g++]=O,t[g++]=N,t[--p]=N,t[--p]=B}x=s,y=r+l,b=e+x,v=e-x,C=i+y;const _=i-y;return t[f++]=b,t[f++]=C,t[--p]=_,t[--p]=b,s&&(t[f++]=v,t[f++]=C,t[--p]=_,t[--p]=v),t},triangulate(n,t,e,i,s,r){if(n.length===0)return;let o=0,l=0;for(let f=0;f<n.length;f+=2)o+=n[f],l+=n[f+1];o/=n.length/2,l/=n.length/2;let u=i;t[u*e]=o,t[u*e+1]=l;const c=u++;for(let f=0;f<n.length;f+=2)t[u*e]=n[f],t[u*e+1]=n[f+1],f>0&&(s[r++]=u,s[r++]=c,s[r++]=u-1),u++;s[r++]=c+1,s[r++]=c,s[r++]=u-1}},bT={...Rr,extension:{...Rr.extension,name:"ellipse"}},_T={...Rr,extension:{...Rr.extension,name:"roundedRectangle"}},Fg=1e-4,Rp=1e-4;function wT(n){const t=n.length;if(t<6)return 1;let e=0;for(let i=0,s=n[t-2],r=n[t-1];i<t;i+=2){const o=n[i],l=n[i+1];e+=(o-s)*(l+r),s=o,r=l}return e<0?-1:1}function Fp(n,t,e,i,s,r,o,l){const u=n-e*s,c=t-i*s,f=n+e*r,d=t+i*r;let g,p;o?(g=i,p=-e):(g=-i,p=e);const x=u+g,y=c+p,b=f+g,v=d+p;return l.push(x,y),l.push(b,v),2}function nn(n,t,e,i,s,r,o,l){const u=e-n,c=i-t;let f=Math.atan2(u,c),d=Math.atan2(s-n,r-t);l&&f<d?f+=Math.PI*2:!l&&f>d&&(d+=Math.PI*2);let g=f;const p=d-f,x=Math.abs(p),y=Math.sqrt(u*u+c*c),b=(15*x*Math.sqrt(y)/Math.PI>>0)+1,v=p/b;if(g+=v,l){o.push(n,t),o.push(e,i);for(let C=1,_=g;C<b;C++,_+=v)o.push(n,t),o.push(n+Math.sin(_)*y,t+Math.cos(_)*y);o.push(n,t),o.push(s,r)}else{o.push(e,i),o.push(n,t);for(let C=1,_=g;C<b;C++,_+=v)o.push(n+Math.sin(_)*y,t+Math.cos(_)*y),o.push(n,t);o.push(s,r),o.push(n,t)}return b*2}function vT(n,t,e,i,s,r){const o=Fg;if(n.length===0)return;const l=t;let u=l.alignment;if(t.alignment!==.5){let W=wT(n);u=(u-.5)*W+.5}const c=new fe(n[0],n[1]),f=new fe(n[n.length-2],n[n.length-1]),d=i,g=Math.abs(c.x-f.x)<o&&Math.abs(c.y-f.y)<o;if(d){n=n.slice(),g&&(n.pop(),n.pop(),f.set(n[n.length-2],n[n.length-1]));const W=(c.x+f.x)*.5,q=(f.y+c.y)*.5;n.unshift(W,q),n.push(W,q)}const p=s,x=n.length/2;let y=n.length;const b=p.length/2,v=l.width/2,C=v*v,_=l.miterLimit*l.miterLimit;let S=n[0],M=n[1],T=n[2],P=n[3],B=0,O=0,U=-(M-P),N=S-T,et=0,K=0,V=Math.sqrt(U*U+N*N);U/=V,N/=V,U*=v,N*=v;const J=u,E=(1-J)*2,L=J*2;d||(l.cap==="round"?y+=nn(S-U*(E-L)*.5,M-N*(E-L)*.5,S-U*E,M-N*E,S+U*L,M+N*L,p,!0)+2:l.cap==="square"&&(y+=Fp(S,M,U,N,E,L,!0,p))),p.push(S-U*E,M-N*E),p.push(S+U*L,M+N*L);for(let W=1;W<x-1;++W){S=n[(W-1)*2],M=n[(W-1)*2+1],T=n[W*2],P=n[W*2+1],B=n[(W+1)*2],O=n[(W+1)*2+1],U=-(M-P),N=S-T,V=Math.sqrt(U*U+N*N),U/=V,N/=V,U*=v,N*=v,et=-(P-O),K=T-B,V=Math.sqrt(et*et+K*K),et/=V,K/=V,et*=v,K*=v;const q=T-S,j=M-P,tt=T-B,Z=O-P,ct=q*tt+j*Z,lt=j*tt-Z*q,Pt=lt<0;if(Math.abs(lt)<.001*Math.abs(ct)){p.push(T-U*E,P-N*E),p.push(T+U*L,P+N*L),ct>=0&&(l.join==="round"?y+=nn(T,P,T-U*E,P-N*E,T-et*E,P-K*E,p,!1)+4:y+=2,p.push(T-et*L,P-K*L),p.push(T+et*E,P+K*E));continue}const Ct=(-U+S)*(-N+P)-(-U+T)*(-N+M),gt=(-et+B)*(-K+P)-(-et+T)*(-K+O),It=(q*gt-tt*Ct)/lt,wt=(Z*Ct-j*gt)/lt,ee=(It-T)*(It-T)+(wt-P)*(wt-P),ie=T+(It-T)*E,Pe=P+(wt-P)*E,Kt=T-(It-T)*L,St=P-(wt-P)*L,Dt=Math.min(q*q+j*j,tt*tt+Z*Z),Le=Pt?E:L,Ii=Dt+Le*Le*C;ee<=Ii?l.join==="bevel"||ee/C>_?(Pt?(p.push(ie,Pe),p.push(T+U*L,P+N*L),p.push(ie,Pe),p.push(T+et*L,P+K*L)):(p.push(T-U*E,P-N*E),p.push(Kt,St),p.push(T-et*E,P-K*E),p.push(Kt,St)),y+=2):l.join==="round"?Pt?(p.push(ie,Pe),p.push(T+U*L,P+N*L),y+=nn(T,P,T+U*L,P+N*L,T+et*L,P+K*L,p,!0)+4,p.push(ie,Pe),p.push(T+et*L,P+K*L)):(p.push(T-U*E,P-N*E),p.push(Kt,St),y+=nn(T,P,T-U*E,P-N*E,T-et*E,P-K*E,p,!1)+4,p.push(T-et*E,P-K*E),p.push(Kt,St)):(p.push(ie,Pe),p.push(Kt,St)):(p.push(T-U*E,P-N*E),p.push(T+U*L,P+N*L),l.join==="round"?Pt?y+=nn(T,P,T+U*L,P+N*L,T+et*L,P+K*L,p,!0)+2:y+=nn(T,P,T-U*E,P-N*E,T-et*E,P-K*E,p,!1)+2:l.join==="miter"&&ee/C<=_&&(Pt?(p.push(Kt,St),p.push(Kt,St)):(p.push(ie,Pe),p.push(ie,Pe)),y+=2),p.push(T-et*E,P-K*E),p.push(T+et*L,P+K*L),y+=2)}S=n[(x-2)*2],M=n[(x-2)*2+1],T=n[(x-1)*2],P=n[(x-1)*2+1],U=-(M-P),N=S-T,V=Math.sqrt(U*U+N*N),U/=V,N/=V,U*=v,N*=v,p.push(T-U*E,P-N*E),p.push(T+U*L,P+N*L),d||(l.cap==="round"?y+=nn(T-U*(E-L)*.5,P-N*(E-L)*.5,T-U*E,P-N*E,T+U*L,P+N*L,p,!1)+2:l.cap==="square"&&(y+=Fp(T,P,U,N,E,L,!1,p)));const Y=Rp*Rp;for(let W=b;W<y+b-2;++W)S=p[W*2],M=p[W*2+1],T=p[(W+1)*2],P=p[(W+1)*2+1],B=p[(W+2)*2],O=p[(W+2)*2+1],!(Math.abs(S*(P-O)+T*(O-M)+B*(M-P))<Y)&&r.push(W,W+1,W+2)}function ST(n,t,e,i){const s=Fg;if(n.length===0)return;const r=n[0],o=n[1],l=n[n.length-2],u=n[n.length-1],c=t||Math.abs(r-l)<s&&Math.abs(o-u)<s,f=e,d=n.length/2,g=f.length/2;for(let p=0;p<d;p++)f.push(n[p*2]),f.push(n[p*2+1]);for(let p=0;p<d-1;p++)i.push(g+p,g+p+1);c&&i.push(g+d-1,g)}function Bg(n,t,e,i,s,r,o){const l=P2(n,t,2);if(!l)return;for(let c=0;c<l.length;c+=3)r[o++]=l[c]+s,r[o++]=l[c+1]+s,r[o++]=l[c+2]+s;let u=s*i;for(let c=0;c<n.length;c+=2)e[u]=n[c],e[u+1]=n[c+1],u+=i}const AT=[],CT={extension:{type:_t.ShapeBuilder,name:"polygon"},build(n,t){for(let e=0;e<n.points.length;e++)t[e]=n.points[e];return t},triangulate(n,t,e,i,s,r){Bg(n,AT,t,e,i,s,r)}},TT={extension:{type:_t.ShapeBuilder,name:"rectangle"},build(n,t){const e=n,i=e.x,s=e.y,r=e.width,o=e.height;return r>=0&&o>=0&&(t[0]=i,t[1]=s,t[2]=i+r,t[3]=s,t[4]=i+r,t[5]=s+o,t[6]=i,t[7]=s+o),t},triangulate(n,t,e,i,s,r){let o=0;i*=e,t[i+o]=n[0],t[i+o+1]=n[1],o+=e,t[i+o]=n[2],t[i+o+1]=n[3],o+=e,t[i+o]=n[6],t[i+o+1]=n[7],o+=e,t[i+o]=n[4],t[i+o+1]=n[5],o+=e;const l=i/e;s[r++]=l,s[r++]=l+1,s[r++]=l+2,s[r++]=l+1,s[r++]=l+3,s[r++]=l+2}},MT={extension:{type:_t.ShapeBuilder,name:"triangle"},build(n,t){return t[0]=n.x,t[1]=n.y,t[2]=n.x2,t[3]=n.y2,t[4]=n.x3,t[5]=n.y3,t},triangulate(n,t,e,i,s,r){let o=0;i*=e,t[i+o]=n[0],t[i+o+1]=n[1],o+=e,t[i+o]=n[2],t[i+o+1]=n[3],o+=e,t[i+o]=n[4],t[i+o+1]=n[5];const l=i/e;s[r++]=l,s[r++]=l+1,s[r++]=l+2}},PT=new Vt,IT=new Ve;function kT(n,t,e,i){const s=t.matrix?n.copyFrom(t.matrix).invert():n.identity();if(t.textureSpace==="local"){const r=e.getBounds(IT);s.translate(-r.x,-r.y),s.scale(1/r.width,1/r.height)}else{s.translate(t.texture.frame.x,t.texture.frame.y),s.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update())}return i&&s.append(PT.copyFrom(i).invert()),s}const Ao={};Fe.handleByMap(_t.ShapeBuilder,Ao);Fe.add(TT,CT,MT,Rr,bT,_T);const ET=new Ve,RT=new Vt;function FT(n,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let s=0;s<n.instructions.length;s++){const r=n.instructions[s];if(r.action==="texture")BT(r.data,i,e);else if(r.action==="fill"||r.action==="stroke"){const o=r.action==="stroke",l=r.data.path.shapePath,u=r.data.style,c=r.data.hole;o&&c&&Bp(c.shapePath,u,!0,i,e),c&&(l.shapePrimitives[l.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),Bp(l,u,o,i,e)}}}function BT(n,t,e){const{vertices:i,uvs:s,indices:r}=e,o=r.length,l=i.length/2,u=[],c=Ao.rectangle,f=ET,d=n.image;f.x=n.dx,f.y=n.dy,f.width=n.dw,f.height=n.dh;const g=n.transform;c.build(f,u),g&&Eg(u,g),c.triangulate(u,i,2,l,r,o);const p=d.uvs;s.push(p.x0,p.y0,p.x1,p.y1,p.x3,p.y3,p.x2,p.y2);const x=_s.get(Rg);x.indexOffset=o,x.indexSize=r.length-o,x.attributeOffset=l,x.attributeSize=i.length/2-l,x.baseColor=n.style,x.alpha=n.alpha,x.texture=d,x.geometryData=e,t.push(x)}function Bp(n,t,e,i,s){const{vertices:r,uvs:o,indices:l}=s;n.shapePrimitives.forEach(({shape:u,transform:c,holes:f})=>{const d=l.length,g=r.length/2,p=[],x=Ao[u.type];let y="triangle-list";if(x.build(u,p),c&&Eg(p,c),e){const _=u.closePath??!0,S=t;S.pixelLine?(ST(p,_,r,l),y="line-list"):vT(p,S,!1,_,r,l)}else if(f){const _=[],S=p.slice();LT(f).forEach(T=>{_.push(S.length/2),S.push(...T)}),Bg(S,_,r,2,g,l,d)}else x.triangulate(p,r,2,g,l,d);const b=o.length/2,v=t.texture;if(v!==Ot.WHITE){const _=kT(RT,t,u,c);gT(r,2,g,o,b,2,r.length/2-g,_)}else xT(o,b,2,r.length/2-g);const C=_s.get(Rg);C.indexOffset=d,C.indexSize=l.length-d,C.attributeOffset=g,C.attributeSize=r.length/2-g,C.baseColor=t.color,C.alpha=t.alpha,C.texture=v,C.geometryData=s,C.topology=y,i.push(C)})}function LT(n){const t=[];for(let e=0;e<n.length;e++){const i=n[e].shape,s=[];Ao[i.type].build(i,s),t.push(s)}return t}class OT{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class DT{constructor(){this.batcher=new mT,this.instructions=new Wm}init(){this.instructions.reset()}get geometry(){return jt(pC,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const yc=class $h{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){$h.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??$h.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),FT(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=_s.get(DT),{batches:i,geometryData:s}=this._gpuContextHash[t.uid],r=s.vertices.length,o=s.indices.length;for(let f=0;f<i.length;f++)i[f].applyTransform=!1;const l=e.batcher;l.ensureAttributeBuffer(r),l.ensureIndexBuffer(o),l.begin();for(let f=0;f<i.length;f++){const d=i[f];l.add(d)}l.finish(e.instructions);const u=l.geometry;u.indexBuffer.setDataWithSize(l.indexBuffer,l.indexSize,!0),u.buffers[0].setDataWithSize(l.attributeBuffer.float32View,l.attributeSize,!0);const c=l.batches;for(let f=0;f<c.length;f++){const d=c[f];d.bindGroup=U2(d.textures.textures,d.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new OT;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(_s.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{_s.return(i)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};yc.extension={type:[_t.WebGLSystem,_t.WebGPUSystem,_t.CanvasSystem],name:"graphicsContext"};yc.defaultOptions={bezierSmoothness:.5};let Lg=yc;const YT=8,za=11920929e-14,NT=1;function Og(n,t,e,i,s,r,o,l,u,c){const d=Math.min(.99,Math.max(0,c??Lg.defaultOptions.bezierSmoothness));let g=(NT-d)/1;return g*=g,UT(t,e,i,s,r,o,l,u,n,g),n}function UT(n,t,e,i,s,r,o,l,u,c){Hh(n,t,e,i,s,r,o,l,u,c,0),u.push(o,l)}function Hh(n,t,e,i,s,r,o,l,u,c,f){if(f>YT)return;const d=(n+e)/2,g=(t+i)/2,p=(e+s)/2,x=(i+r)/2,y=(s+o)/2,b=(r+l)/2,v=(d+p)/2,C=(g+x)/2,_=(p+y)/2,S=(x+b)/2,M=(v+_)/2,T=(C+S)/2;if(f>0){let P=o-n,B=l-t;const O=Math.abs((e-o)*B-(i-l)*P),U=Math.abs((s-o)*B-(r-l)*P);if(O>za&&U>za){if((O+U)*(O+U)<=c*(P*P+B*B)){u.push(M,T);return}}else if(O>za){if(O*O<=c*(P*P+B*B)){u.push(M,T);return}}else if(U>za){if(U*U<=c*(P*P+B*B)){u.push(M,T);return}}else if(P=M-(n+o)/2,B=T-(t+l)/2,P*P+B*B<=c){u.push(M,T);return}}Hh(n,t,d,g,v,C,M,T,u,c,f+1),Hh(M,T,_,S,y,b,o,l,u,c,f+1)}const XT=8,WT=11920929e-14,zT=1;function GT(n,t,e,i,s,r,o,l){const c=Math.min(.99,Math.max(0,l??Lg.defaultOptions.bezierSmoothness));let f=(zT-c)/1;return f*=f,VT(t,e,i,s,r,o,n,f),n}function VT(n,t,e,i,s,r,o,l){qh(o,n,t,e,i,s,r,l,0),o.push(s,r)}function qh(n,t,e,i,s,r,o,l,u){if(u>XT)return;const c=(t+i)/2,f=(e+s)/2,d=(i+r)/2,g=(s+o)/2,p=(c+d)/2,x=(f+g)/2;let y=r-t,b=o-e;const v=Math.abs((i-r)*b-(s-o)*y);if(v>WT){if(v*v<=l*(y*y+b*b)){n.push(p,x);return}}else if(y=p-(t+r)/2,b=x-(e+o)/2,y*y+b*b<=l){n.push(p,x);return}qh(n,t,e,c,f,p,x,l,u+1),qh(n,p,x,d,g,r,o,l,u+1)}function Dg(n,t,e,i,s,r,o,l){let u=Math.abs(s-r);(!o&&s>r||o&&r>s)&&(u=2*Math.PI-u),l||(l=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(u/Math.PI)))),l=Math.max(l,3);let c=u/l,f=s;c*=o?-1:1;for(let d=0;d<l+1;d++){const g=Math.cos(f),p=Math.sin(f),x=t+g*i,y=e+p*i;n.push(x,y),f+=c}}function $T(n,t,e,i,s,r){const o=n[n.length-2],u=n[n.length-1]-e,c=o-t,f=s-e,d=i-t,g=Math.abs(u*d-c*f);if(g<1e-8||r===0){(n[n.length-2]!==t||n[n.length-1]!==e)&&n.push(t,e);return}const p=u*u+c*c,x=f*f+d*d,y=u*f+c*d,b=r*Math.sqrt(p)/g,v=r*Math.sqrt(x)/g,C=b*y/p,_=v*y/x,S=b*d+v*c,M=b*f+v*u,T=c*(v+C),P=u*(v+C),B=d*(b+_),O=f*(b+_),U=Math.atan2(P-M,T-S),N=Math.atan2(O-M,B-S);Dg(n,S+t,M+e,r,U,N,c*f>d*u)}const Er=Math.PI*2,mh={centerX:0,centerY:0,ang1:0,ang2:0},gh=({x:n,y:t},e,i,s,r,o,l,u)=>{n*=e,t*=i;const c=s*n-r*t,f=r*n+s*t;return u.x=c+o,u.y=f+l,u};function HT(n,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,s=Math.cos(n),r=Math.sin(n),o=Math.cos(n+t),l=Math.sin(n+t);return[{x:s-r*i,y:r+s*i},{x:o+l*i,y:l-o*i},{x:o,y:l}]}const Lp=(n,t,e,i)=>{const s=n*i-t*e<0?-1:1;let r=n*e+t*i;return r>1&&(r=1),r<-1&&(r=-1),s*Math.acos(r)},qT=(n,t,e,i,s,r,o,l,u,c,f,d,g)=>{const p=Math.pow(s,2),x=Math.pow(r,2),y=Math.pow(f,2),b=Math.pow(d,2);let v=p*x-p*b-x*y;v<0&&(v=0),v/=p*b+x*y,v=Math.sqrt(v)*(o===l?-1:1);const C=v*s/r*d,_=v*-r/s*f,S=c*C-u*_+(n+e)/2,M=u*C+c*_+(t+i)/2,T=(f-C)/s,P=(d-_)/r,B=(-f-C)/s,O=(-d-_)/r,U=Lp(1,0,T,P);let N=Lp(T,P,B,O);l===0&&N>0&&(N-=Er),l===1&&N<0&&(N+=Er),g.centerX=S,g.centerY=M,g.ang1=U,g.ang2=N};function jT(n,t,e,i,s,r,o,l=0,u=0,c=0){if(r===0||o===0)return;const f=Math.sin(l*Er/360),d=Math.cos(l*Er/360),g=d*(t-i)/2+f*(e-s)/2,p=-f*(t-i)/2+d*(e-s)/2;if(g===0&&p===0)return;r=Math.abs(r),o=Math.abs(o);const x=Math.pow(g,2)/Math.pow(r,2)+Math.pow(p,2)/Math.pow(o,2);x>1&&(r*=Math.sqrt(x),o*=Math.sqrt(x)),qT(t,e,i,s,r,o,u,c,f,d,g,p,mh);let{ang1:y,ang2:b}=mh;const{centerX:v,centerY:C}=mh;let _=Math.abs(b)/(Er/4);Math.abs(1-_)<1e-7&&(_=1);const S=Math.max(Math.ceil(_),1);b/=S;let M=n[n.length-2],T=n[n.length-1];const P={x:0,y:0};for(let B=0;B<S;B++){const O=HT(y,b),{x:U,y:N}=gh(O[0],r,o,d,f,v,C,P),{x:et,y:K}=gh(O[1],r,o,d,f,v,C,P),{x:V,y:J}=gh(O[2],r,o,d,f,v,C,P);Og(n,M,T,U,N,et,K,V,J),M=V,T=J,y+=b}}function KT(n,t,e){const i=(o,l)=>{const u=l.x-o.x,c=l.y-o.y,f=Math.sqrt(u*u+c*c),d=u/f,g=c/f;return{len:f,nx:d,ny:g}},s=(o,l)=>{o===0?n.moveTo(l.x,l.y):n.lineTo(l.x,l.y)};let r=t[t.length-1];for(let o=0;o<t.length;o++){const l=t[o%t.length],u=l.radius??e;if(u<=0){s(o,l),r=l;continue}const c=t[(o+1)%t.length],f=i(l,r),d=i(l,c);if(f.len<1e-4||d.len<1e-4){s(o,l),r=l;continue}let g=Math.asin(f.nx*d.ny-f.ny*d.nx),p=1,x=!1;f.nx*d.nx-f.ny*-d.ny<0?g<0?g=Math.PI+g:(g=Math.PI-g,p=-1,x=!0):g>0&&(p=-1,x=!0);const y=g/2;let b,v=Math.abs(Math.cos(y)*u/Math.sin(y));v>Math.min(f.len/2,d.len/2)?(v=Math.min(f.len/2,d.len/2),b=Math.abs(v*Math.sin(y)/Math.cos(y))):b=u;const C=l.x+d.nx*v+-d.ny*b*p,_=l.y+d.ny*v+d.nx*b*p,S=Math.atan2(f.ny,f.nx)+Math.PI/2*p,M=Math.atan2(d.ny,d.nx)-Math.PI/2*p;o===0&&n.moveTo(C+Math.cos(S)*b,_+Math.sin(S)*b),n.arc(C,_,b,S,M,x),r=l}}function ZT(n,t,e,i){const s=(l,u)=>Math.sqrt((l.x-u.x)**2+(l.y-u.y)**2),r=(l,u,c)=>({x:l.x+(u.x-l.x)*c,y:l.y+(u.y-l.y)*c}),o=t.length;for(let l=0;l<o;l++){const u=t[(l+1)%o],c=u.radius??e;if(c<=0){l===0?n.moveTo(u.x,u.y):n.lineTo(u.x,u.y);continue}const f=t[l],d=t[(l+2)%o],g=s(f,u);let p;if(g<1e-4)p=u;else{const b=Math.min(g/2,c);p=r(u,f,b/g)}const x=s(d,u);let y;if(x<1e-4)y=u;else{const b=Math.min(x/2,c);y=r(u,d,b/x)}l===0?n.moveTo(p.x,p.y):n.lineTo(p.x,p.y),n.quadraticCurveTo(u.x,u.y,y.x,y.y,i)}}const QT=new Ve;class JT{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Ui,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,s=i[i.length-2],r=i[i.length-1];return(s!==t||r!==e)&&i.push(t,e),this}arc(t,e,i,s,r,o){this._ensurePoly(!1);const l=this._currentPoly.points;return Dg(l,t,e,i,s,r,o),this}arcTo(t,e,i,s,r){this._ensurePoly();const o=this._currentPoly.points;return $T(o,t,e,i,s,r),this}arcToSvg(t,e,i,s,r,o,l){const u=this._currentPoly.points;return jT(u,this._currentPoly.lastX,this._currentPoly.lastY,o,l,t,e,i,s,r),this}bezierCurveTo(t,e,i,s,r,o,l){this._ensurePoly();const u=this._currentPoly;return Og(this._currentPoly.points,u.lastX,u.lastY,t,e,i,s,r,o,l),this}quadraticCurveTo(t,e,i,s,r){this._ensurePoly();const o=this._currentPoly;return GT(this._currentPoly.points,o.lastX,o.lastY,t,e,i,s,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const i=this.shapePrimitives,s=i.length;for(let r=0;r<t.instructions.length;r++){const o=t.instructions[r];this[o.action](...o.data)}if(t.checkForHoles&&i.length-s>1){let r=null;for(let o=s;o<i.length;o++){const l=i[o];if(l.shape.type==="polygon"){const u=l.shape,c=r==null?void 0:r.shape;c&&c.containsPolygon(u)?(r.holes||(r.holes=[]),r.holes.push(l),i.copyWithin(o,o+1),i.length--,o--):r=l}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,s,r){return this.drawShape(new Ve(t,e,i,s),r),this}circle(t,e,i,s){return this.drawShape(new mc(t,e,i),s),this}poly(t,e,i){const s=new kr(t);return s.closePath=e,this.drawShape(s,i),this}regularPoly(t,e,i,s,r=0,o){s=Math.max(s|0,3);const l=-1*Math.PI/2+r,u=Math.PI*2/s,c=[];for(let f=0;f<s;f++){const d=l-f*u;c.push(t+i*Math.cos(d),e+i*Math.sin(d))}return this.poly(c,!0,o),this}roundPoly(t,e,i,s,r,o=0,l){if(s=Math.max(s|0,3),r<=0)return this.regularPoly(t,e,i,s,o);const u=i*Math.sin(Math.PI/s)-.001;r=Math.min(r,u);const c=-1*Math.PI/2+o,f=Math.PI*2/s,d=(s-2)*Math.PI/s/2;for(let g=0;g<s;g++){const p=g*f+c,x=t+i*Math.cos(p),y=e+i*Math.sin(p),b=p+Math.PI+d,v=p-Math.PI-d,C=x+r*Math.cos(b),_=y+r*Math.sin(b),S=x+r*Math.cos(v),M=y+r*Math.sin(v);g===0?this.moveTo(C,_):this.lineTo(C,_),this.quadraticCurveTo(x,y,S,M,l)}return this.closePath()}roundShape(t,e,i=!1,s){return t.length<3?this:(i?ZT(this,t,e,s):KT(this,t,e),this.closePath())}filletRect(t,e,i,s,r){if(r===0)return this.rect(t,e,i,s);const o=Math.min(i,s)/2,l=Math.min(o,Math.max(-o,r)),u=t+i,c=e+s,f=l<0?-l:0,d=Math.abs(l);return this.moveTo(t,e+d).arcTo(t+f,e+f,t+d,e,d).lineTo(u-d,e).arcTo(u-f,e+f,u,e+d,d).lineTo(u,c-d).arcTo(u-f,c-f,t+i-d,c,d).lineTo(t+d,c).arcTo(t+f,c-f,t,c-d,d).closePath()}chamferRect(t,e,i,s,r,o){if(r<=0)return this.rect(t,e,i,s);const l=Math.min(r,Math.min(i,s)/2),u=t+i,c=e+s,f=[t+l,e,u-l,e,u,e+l,u,c-l,u-l,c,t+l,c,t,c-l,t,e+l];for(let d=f.length-1;d>=2;d-=2)f[d]===f[d-2]&&f[d-1]===f[d-3]&&f.splice(d-1,2);return this.poly(f,!0,o)}ellipse(t,e,i,s,r){return this.drawShape(new gc(t,e,i,s),r),this}roundRect(t,e,i,s,r,o){return this.drawShape(new xc(t,e,i,s,r),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new kr,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new kr,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,s=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,o=i;i=r.a*i+r.c*s+r.tx,s=r.b*o+r.d*s+r.ty}this._currentPoly.points.push(i,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const s=e[i],r=s.shape.getBounds(QT);s.transform?t.addRect(r,s.transform):t.addRect(r)}return t}}class er{constructor(t,e=!1){this.instructions=[],this.uid=Se("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?F2(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new JT(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,s,r){const o=this.instructions[this.instructions.length-1],l=this.getLastPoint(fe.shared);let u=0,c=0;if(!o||o.action!=="bezierCurveTo")u=l.x,c=l.y;else{u=o.data[2],c=o.data[3];const f=l.x,d=l.y;u=f+(f-u),c=d+(d-c)}return this.instructions.push({action:"bezierCurveTo",data:[u,c,t,e,i,s,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const s=this.instructions[this.instructions.length-1],r=this.getLastPoint(fe.shared);let o=0,l=0;if(!s||s.action!=="quadraticCurveTo")o=r.x,l=r.y;else{o=s.data[0],l=s.data[1];const u=r.x,c=r.y;o=u+(u-o),l=c+(c-l)}return this.instructions.push({action:"quadraticCurveTo",data:[o,l,t,e,i]}),this._dirty=!0,this}rect(t,e,i,s,r){return this.instructions.push({action:"rect",data:[t,e,i,s,r]}),this._dirty=!0,this}circle(t,e,i,s){return this.instructions.push({action:"circle",data:[t,e,i,s]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,s,r,o,l){r||(r=s/2);const u=-1*Math.PI/2+o,c=i*2,f=Math.PI*2/c,d=[];for(let g=0;g<c;g++){const p=g%2?r:s,x=g*f+u;d.push(t+p*Math.cos(x),e+p*Math.sin(x))}return this.poly(d,!0,l),this}clone(t=!1){const e=new er;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const s=this.instructions[i];e.instructions.push({action:s.action,data:s.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,s=t.c,r=t.d,o=t.tx,l=t.ty;let u=0,c=0,f=0,d=0,g=0,p=0,x=0,y=0;for(let b=0;b<this.instructions.length;b++){const v=this.instructions[b],C=v.data;switch(v.action){case"moveTo":case"lineTo":u=C[0],c=C[1],C[0]=e*u+s*c+o,C[1]=i*u+r*c+l;break;case"bezierCurveTo":f=C[0],d=C[1],g=C[2],p=C[3],u=C[4],c=C[5],C[0]=e*f+s*d+o,C[1]=i*f+r*d+l,C[2]=e*g+s*p+o,C[3]=i*g+r*p+l,C[4]=e*u+s*c+o,C[5]=i*u+r*c+l;break;case"quadraticCurveTo":f=C[0],d=C[1],u=C[2],c=C[3],C[0]=e*f+s*d+o,C[1]=i*f+r*d+l,C[2]=e*u+s*c+o,C[3]=i*u+r*c+l;break;case"arcToSvg":u=C[5],c=C[6],x=C[0],y=C[1],C[0]=e*x+s*y,C[1]=i*x+r*y,C[5]=e*u+s*c+o,C[6]=i*u+r*c+l;break;case"circle":C[4]=Sr(C[3],t);break;case"rect":C[4]=Sr(C[4],t);break;case"ellipse":C[8]=Sr(C[8],t);break;case"roundRect":C[5]=Sr(C[5],t);break;case"addPath":C[0].transform(t);break;case"poly":C[2]=Sr(C[2],t);break;default:ge("unknown transform action",v.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function Sr(n,t){return n?n.prepend(t):t.clone()}function ye(n,t,e){const i=n.getAttribute(t);return i?Number(i):e}function tM(n,t){const e=n.querySelectorAll("defs");for(let i=0;i<e.length;i++){const s=e[i];for(let r=0;r<s.children.length;r++){const o=s.children[r];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=eM(o);break;case"radialgradient":t.defs[o.id]=iM();break}}}}function eM(n){const t=ye(n,"x1",0),e=ye(n,"y1",0),i=ye(n,"x2",1),s=ye(n,"y2",0),r=n.getAttribute("gradientUnits")||"objectBoundingBox",o=new zs(t,e,i,s,r==="objectBoundingBox"?"local":"global");for(let l=0;l<n.children.length;l++){const u=n.children[l],c=ye(u,"offset",0),f=Be.shared.setValue(u.getAttribute("stop-color")).toNumber();o.addColorStop(c,f)}return o}function iM(n){return ge("[SVG Parser] Radial gradients are not yet supported"),new zs(0,0,1,0)}function Op(n){const t=n.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Dp={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Yg(n,t){const e=n.getAttribute("style"),i={},s={},r={strokeStyle:i,fillStyle:s,useFill:!1,useStroke:!1};for(const o in Dp){const l=n.getAttribute(o);l&&Yp(t,r,o,l.trim())}if(e){const o=e.split(";");for(let l=0;l<o.length;l++){const u=o[l].trim(),[c,f]=u.split(":");Dp[c]&&Yp(t,r,c,f.trim())}}return{strokeStyle:r.useStroke?i:null,fillStyle:r.useFill?s:null,useFill:r.useFill,useStroke:r.useStroke}}function Yp(n,t,e,i){switch(e){case"stroke":if(i!=="none"){if(i.startsWith("url(")){const s=Op(i);t.strokeStyle.fill=n.defs[s]}else t.strokeStyle.color=Be.shared.setValue(i).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(i);break;case"fill":if(i!=="none"){if(i.startsWith("url(")){const s=Op(i);t.fillStyle.fill=n.defs[s]}else t.fillStyle.color=Be.shared.setValue(i).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(i);break;case"stroke-opacity":t.strokeStyle.alpha=Number(i);break;case"opacity":t.fillStyle.alpha=Number(i),t.strokeStyle.alpha=Number(i);break}}function sM(n,t){if(typeof n=="string"){const o=document.createElement("div");o.innerHTML=n.trim(),n=o.querySelector("svg")}const e={context:t,defs:{},path:new er};tM(n,e);const i=n.children,{fillStyle:s,strokeStyle:r}=Yg(n,e);for(let o=0;o<i.length;o++){const l=i[o];l.nodeName.toLowerCase()!=="defs"&&Ng(l,e,s,r)}return t}function Ng(n,t,e,i){const s=n.children,{fillStyle:r,strokeStyle:o}=Yg(n,t);r&&e?e={...e,...r}:r&&(e=r),o&&i?i={...i,...o}:o&&(i=o);const l=!e&&!i;l&&(e={color:0});let u,c,f,d,g,p,x,y,b,v,C,_,S,M,T,P,B;switch(n.nodeName.toLowerCase()){case"path":M=n.getAttribute("d"),n.getAttribute("fill-rule")==="evenodd"&&ge("SVG Evenodd fill rule not supported, your svg may render incorrectly"),T=new er(M,!0),t.context.path(T),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"circle":x=ye(n,"cx",0),y=ye(n,"cy",0),b=ye(n,"r",0),t.context.ellipse(x,y,b,b),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"rect":u=ye(n,"x",0),c=ye(n,"y",0),P=ye(n,"width",0),B=ye(n,"height",0),v=ye(n,"rx",0),C=ye(n,"ry",0),v||C?t.context.roundRect(u,c,P,B,v||C):t.context.rect(u,c,P,B),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"ellipse":x=ye(n,"cx",0),y=ye(n,"cy",0),v=ye(n,"rx",0),C=ye(n,"ry",0),t.context.beginPath(),t.context.ellipse(x,y,v,C),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"line":f=ye(n,"x1",0),d=ye(n,"y1",0),g=ye(n,"x2",0),p=ye(n,"y2",0),t.context.beginPath(),t.context.moveTo(f,d),t.context.lineTo(g,p),i&&t.context.stroke(i);break;case"polygon":S=n.getAttribute("points"),_=S.match(/\d+/g).map(O=>parseInt(O,10)),t.context.poly(_,!0),e&&t.context.fill(e),i&&t.context.stroke(i);break;case"polyline":S=n.getAttribute("points"),_=S.match(/\d+/g).map(O=>parseInt(O,10)),t.context.poly(_,!1),i&&t.context.stroke(i);break;case"g":case"svg":break;default:{ge(`[SVG parser] <${n.nodeName}> elements unsupported`);break}}l&&(e=null);for(let O=0;O<s.length;O++)Ng(s[O],t,e,i)}function nM(n){return Be.isColorLike(n)}function Np(n){return n instanceof So}function Up(n){return n instanceof zs}function rM(n){return n instanceof Ot}function aM(n,t,e){const i=Be.shared.setValue(t??0);return n.color=i.toNumber(),n.alpha=i.alpha===1?e.alpha:i.alpha,n.texture=Ot.WHITE,{...e,...n}}function oM(n,t,e){return n.texture=t,{...e,...n}}function Xp(n,t,e){return n.fill=t,n.color=16777215,n.texture=t.texture,n.matrix=t.transform,{...e,...n}}function Wp(n,t,e){return t.buildGradient(),n.fill=t,n.color=16777215,n.texture=t.texture,n.matrix=t.transform,n.textureSpace=t.textureSpace,{...e,...n}}function lM(n,t){const e={...t,...n},i=Be.shared.setValue(e.color);return e.alpha*=i.alpha,e.color=i.toNumber(),e}function cn(n,t){if(n==null)return null;const e={},i=n;return nM(n)?aM(e,n,t):rM(n)?oM(e,n,t):Np(n)?Xp(e,n,t):Up(n)?Wp(e,n,t):i.fill&&Np(i.fill)?Xp(i,i.fill,t):i.fill&&Up(i.fill)?Wp(i,i.fill,t):lM(i,t)}function no(n,t){const{width:e,alignment:i,miterLimit:s,cap:r,join:o,pixelLine:l,...u}=t,c=cn(n,u);return c?{width:e,alignment:i,miterLimit:s,cap:r,join:o,pixelLine:l,...c}:null}const hM=new fe,zp=new Vt,bc=class Ki extends is{constructor(){super(...arguments),this.uid=Se("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new er,this._transform=new Vt,this._fillStyle={...Ki.defaultFillStyle},this._strokeStyle={...Ki.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Ui,this._boundsDirty=!0}clone(){const t=new Ki;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=cn(t,Ki.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=no(t,Ki.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=cn(t,Ki.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=cn(t,Ki.defaultStrokeStyle),this}texture(t,e,i,s,r,o){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:s||0,dw:r||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?Be.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new er,this}fill(t,e){let i;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="stroke"?i=s.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(jt(le,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=cn(t,Ki.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(fe.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=no(t,Ki.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,s,r,o){this._tick++;const l=this._transform;return this._activePath.arc(l.a*t+l.c*e+l.tx,l.b*t+l.d*e+l.ty,i,s,r,o),this}arcTo(t,e,i,s,r){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*s+o.tx,o.b*i+o.d*s+o.ty,r),this}arcToSvg(t,e,i,s,r,o,l){this._tick++;const u=this._transform;return this._activePath.arcToSvg(t,e,i,s,r,u.a*o+u.c*l+u.tx,u.b*o+u.d*l+u.ty),this}bezierCurveTo(t,e,i,s,r,o,l){this._tick++;const u=this._transform;return this._activePath.bezierCurveTo(u.a*t+u.c*e+u.tx,u.b*t+u.d*e+u.ty,u.a*i+u.c*s+u.tx,u.b*i+u.d*s+u.ty,u.a*r+u.c*o+u.tx,u.b*r+u.d*o+u.ty,l),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,i,s){return this._tick++,this._activePath.ellipse(t,e,i,s,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,s=this._activePath.instructions,r=i.a*t+i.c*e+i.tx,o=i.b*t+i.d*e+i.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=r,s[0].data[1]=o,this):(this._activePath.moveTo(r,o),this)}quadraticCurveTo(t,e,i,s,r){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*s+o.tx,o.b*i+o.d*s+o.ty,r),this}rect(t,e,i,s){return this._tick++,this._activePath.rect(t,e,i,s,this._transform.clone()),this}roundRect(t,e,i,s,r){return this._tick++,this._activePath.roundRect(t,e,i,s,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,s,r=0,o){return this._tick++,this._activePath.regularPoly(t,e,i,s,r,o),this}roundPoly(t,e,i,s,r,o){return this._tick++,this._activePath.roundPoly(t,e,i,s,r,o),this}roundShape(t,e,i,s){return this._tick++,this._activePath.roundShape(t,e,i,s),this}filletRect(t,e,i,s,r){return this._tick++,this._activePath.filletRect(t,e,i,s,r),this}chamferRect(t,e,i,s,r,o){return this._tick++,this._activePath.chamferRect(t,e,i,s,r,o),this}star(t,e,i,s,r=0,o=0){return this._tick++,this._activePath.star(t,e,i,s,r,o,this._transform.clone()),this}svg(t){return this._tick++,sM(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,s,r,o){return t instanceof Vt?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,s,r,o),this)}transform(t,e,i,s,r,o){return t instanceof Vt?(this._transform.append(t),this):(zp.set(t,e,i,s,r,o),this._transform.append(zp),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],s=i.action;if(s==="fill"){const r=i.data;t.addBounds(r.path.bounds)}else if(s==="texture"){const r=i.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(s==="stroke"){const r=i.data,o=r.style.alignment,l=r.style.width*(1-o),u=r.path.bounds;t.addFrame(u.minX-l,u.minY-l,u.maxX+l,u.maxY+l)}}return t}containsPoint(t){var s;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let r=0;r<e.length;r++){const o=e[r],l=o.data,u=l.path;if(!o.action||!u)continue;const c=l.style,f=u.shapePath.shapePrimitives;for(let d=0;d<f.length;d++){const g=f[d].shape;if(!c||!g)continue;const p=f[d].transform,x=p?p.applyInverse(t,hM):t;if(o.action==="fill")i=g.contains(x.x,x.y);else{const b=c;i=g.strokeContains(x.x,x.y,b.width,b.alignment)}const y=l.hole;if(y){const b=(s=y.shapePath)==null?void 0:s.shapePrimitives;if(b)for(let v=0;v<b.length;v++)b[v].shape.contains(x.x,x.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};bc.defaultFillStyle={color:16777215,alpha:1,texture:Ot.WHITE,matrix:null,fill:null,textureSpace:"local"};bc.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ot.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Ai=bc;const Gp=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function cM(n){const t=[];let e=0;for(let i=0;i<Gp.length;i++){const s=`_${Gp[i]}`;t[e++]=n[s]}return e=Ug(n._fill,t,e),e=uM(n._stroke,t,e),e=fM(n.dropShadow,t,e),t.join("-")}function Ug(n,t,e){var i;return n&&(t[e++]=n.color,t[e++]=n.alpha,t[e++]=(i=n.fill)==null?void 0:i.styleKey),e}function uM(n,t,e){return n&&(e=Ug(n,t,e),t[e++]=n.width,t[e++]=n.alignment,t[e++]=n.cap,t[e++]=n.join,t[e++]=n.miterLimit),e}function fM(n,t,e){return n&&(t[e++]=n.alpha,t[e++]=n.angle,t[e++]=n.blur,t[e++]=n.distance,t[e++]=Be.shared.setValue(n.color).toNumber()),e}const _c=class Wn extends is{constructor(t={}){super(),dM(t);const e={...Wn.defaultTextStyle,...t};for(const i in e){const s=i;this[s]=e[i]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Wn.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Wn.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Ai.defaultFillStyle,...t},()=>{this._fill=cn({...this._originalFill},Ai.defaultFillStyle)})),this._fill=cn(t===0?"black":t,Ai.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Ai.defaultStrokeStyle,...t},()=>{this._stroke=no({...this._originalStroke},Ai.defaultStrokeStyle)})),this._stroke=no(t,Ai.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=cM(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Wn.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Wn({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var i,s,r,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const l=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(l),(s=this._originalFill)!=null&&s.texture&&this._originalFill.texture.destroy(l),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(l),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(l)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(i,s,r)=>(i[s]=r,e==null||e(s,r),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(Be.isColorLike(t)||t instanceof zs||t instanceof So)}};_c.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};_c.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Fr=_c;function dM(n){const t=n;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Fr.defaultDropShadow;n.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){jt(le,"strokeThickness is now a part of stroke");const e=t.stroke;let i={};if(Be.isColorLike(e))i.color=e;else if(e instanceof zs||e instanceof So)i.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))i=e;else throw new Error("Invalid stroke value.");n.stroke={...i,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){jt(le,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;n.fontSize==null?n.fontSize=Fr.defaultTextStyle.fontSize:typeof n.fontSize=="string"?e=parseInt(n.fontSize,10):e=n.fontSize;const i=new zs({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),s=t.fillGradientStops.map(r=>Be.shared.setValue(r).toNumber());s.forEach((r,o)=>{const l=o/(s.length-1);i.addColorStop(l,r)}),n.fill={fill:i}}}class pM{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const i=ve.get().createCanvas();i.width=t,i.height=e;const s=i.getContext("2d");return{canvas:i,context:s}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=eo(t),e=eo(e);const s=(t<<17)+(e<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let r=this._canvasPool[s].pop();return r||(r=this._createCanvasAndContext(t,e)),r}returnCanvasAndContext(t){const e=t.canvas,{width:i,height:s}=e,r=(i<<17)+(s<<1);t.context.clearRect(0,0,i,s),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}const Vp=new pM,mM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function jh(n){const t=typeof n.fontSize=="number"?`${n.fontSize}px`:n.fontSize;let e=n.fontFamily;Array.isArray(n.fontFamily)||(e=n.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!mM.includes(s)&&(s=`"${s}"`),e[i]=s}return`${n.fontStyle} ${n.fontVariant} ${n.fontWeight} ${t} ${e.join(",")}`}const xh={willReadFrequently:!0},zi=class bt{static get experimentalLetterSpacingSupported(){let t=bt._experimentalLetterSpacingSupported;if(t!==void 0){const e=ve.get().getCanvasRenderingContext2D().prototype;t=bt._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,r,o,l,u,c){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=r,this.lineWidths=o,this.lineHeight=l,this.maxLineWidth=u,this.fontProperties=c}static measureText(t=" ",e,i=bt._canvas,s=e.wordWrap){var C;const r=`${t}:${e.styleKey}`;if(bt._measurementCache[r])return bt._measurementCache[r];const o=jh(e),l=bt.measureFont(o);l.fontSize===0&&(l.fontSize=e.fontSize,l.ascent=e.fontSize);const u=bt.__context;u.font=o;const f=(s?bt._wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),d=new Array(f.length);let g=0;for(let _=0;_<f.length;_++){const S=bt._measureText(f[_],e.letterSpacing,u);d[_]=S,g=Math.max(g,S)}const p=((C=e._stroke)==null?void 0:C.width)||0;let x=g+p;e.dropShadow&&(x+=e.dropShadow.distance);const y=e.lineHeight||l.fontSize;let b=Math.max(y,l.fontSize+p)+(f.length-1)*(y+e.leading);return e.dropShadow&&(b+=e.dropShadow.distance),new bt(t,e,x,b,f,d,y+e.leading,g,l)}static _measureText(t,e,i){let s=!1;bt.experimentalLetterSpacingSupported&&(bt.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const r=i.measureText(t);let o=r.width;const l=-r.actualBoundingBoxLeft;let c=r.actualBoundingBoxRight-l;if(o>0)if(s)o-=e,c-=e;else{const f=(bt.graphemeSegmenter(t).length-1)*e;o+=f,c+=f}return Math.max(o,c)}static _wordWrap(t,e,i=bt._canvas){const s=i.getContext("2d",xh);let r=0,o="",l="";const u=Object.create(null),{letterSpacing:c,whiteSpace:f}=e,d=bt._collapseSpaces(f),g=bt._collapseNewlines(f);let p=!d;const x=e.wordWrapWidth+c,y=bt._tokenize(t);for(let b=0;b<y.length;b++){let v=y[b];if(bt._isNewline(v)){if(!g){l+=bt._addLine(o),p=!d,o="",r=0;continue}v=" "}if(d){const _=bt.isBreakingSpace(v),S=bt.isBreakingSpace(o[o.length-1]);if(_&&S)continue}const C=bt._getFromCache(v,c,u,s);if(C>x)if(o!==""&&(l+=bt._addLine(o),o="",r=0),bt.canBreakWords(v,e.breakWords)){const _=bt.wordWrapSplit(v);for(let S=0;S<_.length;S++){let M=_[S],T=M,P=1;for(;_[S+P];){const O=_[S+P];if(!bt.canBreakChars(T,O,v,S,e.breakWords))M+=O;else break;T=O,P++}S+=P-1;const B=bt._getFromCache(M,c,u,s);B+r>x&&(l+=bt._addLine(o),p=!1,o="",r=0),o+=M,r+=B}}else{o.length>0&&(l+=bt._addLine(o),o="",r=0);const _=b===y.length-1;l+=bt._addLine(v,!_),p=!1,o="",r=0}else C+r>x&&(p=!1,l+=bt._addLine(o),o="",r=0),(o.length>0||!bt.isBreakingSpace(v)||p)&&(o+=v,r+=C)}return l+=bt._addLine(o,!1),l}static _addLine(t,e=!0){return t=bt._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,i,s){let r=i[t];return typeof r!="number"&&(r=bt._measureText(t,e,s)+e,i[t]=r),r}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!bt.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:bt._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:bt._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const r=t[s],o=t[s+1];if(bt.isBreakingSpace(r,o)||bt._isNewline(r)){i!==""&&(e.push(i),i=""),e.push(r);continue}i+=r}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,r){return!0}static wordWrapSplit(t){return bt.graphemeSegmenter(t)}static measureFont(t){if(bt._fonts[t])return bt._fonts[t];const e=bt._context;e.font=t;const i=e.measureText(bt.METRICS_STRING+bt.BASELINE_SYMBOL),s={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return bt._fonts[t]=s,s}static clearMetrics(t=""){t?delete bt._fonts[t]:bt._fonts={}}static get _canvas(){if(!bt.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",xh);if(i!=null&&i.measureText)return bt.__canvas=e,e;t=ve.get().createCanvas()}catch{t=ve.get().createCanvas()}t.width=t.height=10,bt.__canvas=t}return bt.__canvas}static get _context(){return bt.__context||(bt.__context=bt._canvas.getContext("2d",xh)),bt.__context}};zi.METRICS_STRING="|ÉqÅ";zi.BASELINE_SYMBOL="M";zi.BASELINE_MULTIPLIER=1.4;zi.HEIGHT_MULTIPLIER=2;zi.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return t=>[...n.segment(t)].map(e=>e.segment)}return n=>[...n]})();zi.experimentalLetterSpacing=!1;zi._fonts={};zi._newlines=[10,13];zi._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];zi._measurementCache={};let $p=zi;const Hp=1e5;function qp(n,t,e,i=0){if(n.texture===Ot.WHITE&&!n.fill)return Be.shared.setValue(n.color).setAlpha(n.alpha??1).toHexa();if(n.fill){if(n.fill instanceof So){const s=n.fill,r=t.createPattern(s.texture.source.resource,"repeat"),o=s.transform.copyTo(Vt.shared);return o.scale(s.texture.frame.width,s.texture.frame.height),r.setTransform(o),r}else if(n.fill instanceof zs){const s=n.fill,r=s.type==="linear",o=s.textureSpace==="local";let l=1,u=1;o&&e&&(l=e.width+i,u=e.height+i);let c,f=!1;if(r){const{start:d,end:g}=s;c=t.createLinearGradient(d.x*l,d.y*u,g.x*l,g.y*u),f=Math.abs(g.x-d.x)<Math.abs((g.y-d.y)*.1)}else{const{center:d,innerRadius:g,outerCenter:p,outerRadius:x}=s;c=t.createRadialGradient(d.x*l,d.y*u,g*l,p.x*l,p.y*u,x*l)}if(f&&o&&e){const d=e.lineHeight/u;for(let g=0;g<e.lines.length;g++){const p=(g*e.lineHeight+i/2)/u;s.colorStops.forEach(x=>{const y=p+x.offset*d;c.addColorStop(Math.floor(y*Hp)/Hp,Be.shared.setValue(x.color).toHex())})}}else s.colorStops.forEach(d=>{c.addColorStop(d.offset,Be.shared.setValue(d.color).toHex())});return c}}else{const s=t.createPattern(n.texture.source.resource,"repeat"),r=n.matrix.copyTo(Vt.shared);return r.scale(n.texture.frame.width,n.texture.frame.height),s.setTransform(r),s}return ge("FillStyle not recognised",n),"red"}function Xg(n){if(n==="")return[];typeof n=="string"&&(n=[n]);const t=[];for(let e=0,i=n.length;e<i;e++){const s=n[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);if(s[0].length===0||s[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const r=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<r)throw new Error("[BitmapFont]: Invalid character range.");for(let l=r,u=o;l<=u;l++)t.push(String.fromCharCode(l))}else t.push(...Array.from(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Wg=class zg extends cg{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...zg.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const i=e.style.clone();e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=Ot.WHITE,i._fill.fill=null),this.applyFillAsTint=e.overrideFill;const s=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const r=jh(i);e.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/s):i.fontSize=this.baseRenderedFontSize=s,this._style=i,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,this.fontMetrics=$p.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var b,v;const e=Xg(t).filter(C=>!this._currentChars.includes(C)).filter((C,_,S)=>S.indexOf(C)===_);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:s,context:r}=i.canvasAndContext,o=i.texture.source;const l=this._style;let u=this._currentX,c=this._currentY;const f=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*f;let g=0,p=!1;const x=s.width/this.resolution,y=s.height/this.resolution;for(let C=0;C<e.length;C++){const _=e[C],S=$p.measureText(_,l,s,!1);S.lineHeight=S.height;const M=S.width*f,T=Math.ceil((l.fontStyle==="italic"?2:1)*M),P=S.height*f,B=T+d*2,O=P+d*2;if(p=!1,_!==`
`&&_!=="\r"&&_!=="	"&&_!==" "&&(p=!0,g=Math.ceil(Math.max(O,g))),u+B>x&&(c+=g,g=O,u=0,c+g>y)){o.update();const N=this._nextPage();s=N.canvasAndContext.canvas,r=N.canvasAndContext.context,o=N.texture.source,c=0}const U=M/f-(((b=l.dropShadow)==null?void 0:b.distance)??0)-(((v=l._stroke)==null?void 0:v.width)??0);if(this.chars[_]={id:_.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:U,kerning:{}},p){this._drawGlyph(r,S,u+d,c+d,f,l);const N=o.width*f,et=o.height*f,K=new Ve(u/N*o.width,c/et*o.height,B/N*o.width,O/et*o.height);this.chars[_].texture=new Ot({source:o,frame:K}),u+=Math.ceil(B)}}o.update(),this._currentX=u,this._currentY=c,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return jt(le,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const i=this._measureCache;for(let s=0;s<t.length;s++){const r=t[s];for(let o=0;o<this._currentChars.length;o++){const l=this._currentChars[o];let u=i[r];u||(u=i[r]=e.measureText(r).width);let c=i[l];c||(c=i[l]=e.measureText(l).width);let f=e.measureText(r+l).width,d=f-(u+c);d&&(this.chars[r].kerning[l]=d),f=e.measureText(r+l).width,d=f-(u+c),d&&(this.chars[l].kerning[r]=d)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=Vp.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),s=new Ot({source:new mn({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),r={canvasAndContext:e,texture:s};return this.pages[this._currentPageIndex]=r,r}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=jh(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const s=e._stroke,r=(s==null?void 0:s.width)??0;if(s&&(t.lineWidth=r,t.lineJoin=s.join,t.miterLimit=s.miterLimit,t.strokeStyle=qp(s,t)),e._fill&&(t.fillStyle=qp(e._fill,t)),e.dropShadow){const o=e.dropShadow,l=Be.shared.setValue(o.color).toArray(),u=o.blur*i,c=o.distance*i;t.shadowColor=`rgba(${l[0]*255},${l[1]*255},${l[2]*255},${o.alpha})`,t.shadowBlur=u,t.shadowOffsetX=Math.cos(o.angle)*c,t.shadowOffsetY=Math.sin(o.angle)*c}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,s,r,o){const l=e.text,u=e.fontProperties,c=o._stroke,f=((c==null?void 0:c.width)??0)*r,d=i+f/2,g=s-f/2,p=u.descent*r,x=e.lineHeight*r;o.stroke&&f&&t.strokeText(l,d,g+x-p),o._fill&&t.fillText(l,d,g+x-p)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];Vp.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};Wg.defaultOptions={textureSize:512,style:new Fr,mipmap:!0};let jp=Wg;function gM(n,t,e,i){const s={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=e.baseLineOffset;let r=s.lines[0],o=null,l=!0;const u={width:0,start:0,index:0,positions:[],chars:[]},c=x=>{const y=r.width;for(let b=0;b<u.index;b++){const v=x.positions[b];r.chars.push(x.chars[b]),r.charPositions.push(v+y)}r.width+=x.width,l=!1,u.width=0,u.index=0,u.chars.length=0},f=()=>{let x=r.chars.length-1;if(i){let y=r.chars[x];for(;y===" ";)r.width-=e.chars[y].xAdvance,y=r.chars[--x]}s.width=Math.max(s.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},l=!0,s.lines.push(r),s.height+=e.lineHeight},d=e.baseMeasurementFontSize/t.fontSize,g=t.letterSpacing*d,p=t.wordWrapWidth*d;for(let x=0;x<n.length+1;x++){let y;const b=x===n.length;b||(y=n[x]);const v=e.chars[y]||e.chars[" "];if(/(?:\s)/.test(y)||y==="\r"||y===`
`||b){if(!l&&t.wordWrap&&r.width+u.width-g>p?(f(),c(u),b||r.charPositions.push(0)):(u.start=r.width,c(u),b||r.charPositions.push(0)),y==="\r"||y===`
`)r.width!==0&&f();else if(!b){const M=v.xAdvance+(v.kerning[o]||0)+g;r.width+=M,r.spaceWidth=M,r.spacesIndex.push(r.charPositions.length),r.chars.push(y)}}else{const S=v.kerning[o]||0,M=v.xAdvance+S+g;u.positions[u.index++]=u.width+S,u.chars.push(y),u.width+=M}o=y}return f(),t.align==="center"?xM(s):t.align==="right"?yM(s):t.align==="justify"&&bM(s),s}function xM(n){for(let t=0;t<n.lines.length;t++){const e=n.lines[t],i=n.width/2-e.width/2;for(let s=0;s<e.charPositions.length;s++)e.charPositions[s]+=i}}function yM(n){for(let t=0;t<n.lines.length;t++){const e=n.lines[t],i=n.width-e.width;for(let s=0;s<e.charPositions.length;s++)e.charPositions[s]+=i}}function bM(n){const t=n.width;for(let e=0;e<n.lines.length;e++){const i=n.lines[e];let s=0,r=i.spacesIndex[s++],o=0;const l=i.spacesIndex.length,c=(t-i.width)/l;for(let f=0;f<i.charPositions.length;f++)f===r&&(r=i.spacesIndex[s++],o+=c),i.charPositions[f]+=o}}let Ga=0;class _M{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){var o;let i=`${e.fontFamily}-bitmap`,s=!0;if(e._fill.fill&&!e._stroke)i+=e._fill.fill.styleKey,s=!1;else if(e._stroke||e.dropShadow){let l=e.styleKey;l=l.substring(0,l.lastIndexOf("-")),i=`${l}-bitmap`,s=!1}if(!he.has(i)){const l=new jp({style:e,overrideFill:s,overrideSize:!0,...this.defaultOptions});Ga++,Ga>50&&ge("BitmapText",`You have dynamically created ${Ga} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),l.once("destroy",()=>{Ga--,he.remove(i)}),he.set(i,l)}const r=he.get(i);return(o=r.ensureCharacters)==null||o.call(r,t),r}getLayout(t,e,i=!0){const s=this.getFont(t,e);return gM([...t],e,s,i)}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){var c,f,d,g;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(c=t[2])==null?void 0:c.chars,resolution:(f=t[2])==null?void 0:f.resolution,padding:(d=t[2])==null?void 0:d.padding,skipKerning:(g=t[2])==null?void 0:g.skipKerning},jt(le,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=e==null?void 0:e.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const s=e.style,r=s instanceof Fr?s:new Fr(s),o=r._fill.fill!==null&&r._fill.fill!==void 0,l=new jp({style:r,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),u=Xg(e.chars);return l.ensureCharacters(u.join("")),he.set(`${i}-bitmap`,l),l.once("destroy",()=>he.remove(`${i}-bitmap`)),l}uninstall(t){const e=`${t}-bitmap`,i=he.get(e);i&&i.destroy()}}const Kp=new _M;class Gg extends cg{constructor(t,e){super();const{textures:i,data:s}=t;Object.keys(s.pages).forEach(r=>{const o=s.pages[parseInt(r,10)],l=i[o.id];this.pages.push({texture:l})}),Object.keys(s.chars).forEach(r=>{const o=s.chars[r],{frame:l,source:u}=i[o.page],c=new Ve(o.x+l.x,o.y+l.y,o.width,o.height),f=new Ot({source:u,frame:c});this.chars[r]={id:r.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:f}}),this.baseRenderedFontSize=s.fontSize,this.baseMeasurementFontSize=s.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:s.fontSize},this.baseLineOffset=s.baseLineOffset,this.lineHeight=s.lineHeight,this.fontFamily=s.fontFamily,this.distanceField=s.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){Kp.install(t)}static uninstall(t){Kp.uninstall(t)}}const yh={test(n){return typeof n=="string"&&n.startsWith("info face=")},parse(n){const t=n.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const d in t){const g=t[d].match(/^[a-z]+/gm)[0],p=t[d].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),x={};for(const y in p){const b=p[y].split("="),v=b[0],C=b[1].replace(/"/gm,""),_=parseFloat(C),S=isNaN(_)?C:_;x[v]=S}e[g].push(x)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=e.info,[r]=e.common,[o]=e.distanceField??[];o&&(i.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),i.fontSize=parseInt(s.size,10),i.fontFamily=s.face,i.lineHeight=parseInt(r.lineHeight,10);const l=e.page;for(let d=0;d<l.length;d++)i.pages.push({id:parseInt(l[d].id,10)||0,file:l[d].file});const u={};i.baseLineOffset=i.lineHeight-parseInt(r.base,10);const c=e.char;for(let d=0;d<c.length;d++){const g=c[d],p=parseInt(g.id,10);let x=g.letter??g.char??String.fromCharCode(p);x==="space"&&(x=" "),u[p]=x,i.chars[x]={id:p,page:parseInt(g.page,10)||0,x:parseInt(g.x,10),y:parseInt(g.y,10),width:parseInt(g.width,10),height:parseInt(g.height,10),xOffset:parseInt(g.xoffset,10),yOffset:parseInt(g.yoffset,10),xAdvance:parseInt(g.xadvance,10),kerning:{}}}const f=e.kerning||[];for(let d=0;d<f.length;d++){const g=parseInt(f[d].first,10),p=parseInt(f[d].second,10),x=parseInt(f[d].amount,10);i.chars[u[p]].kerning[u[g]]=x}return i}},Zp={test(n){const t=n;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(n){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=n.getElementsByTagName("info")[0],i=n.getElementsByTagName("common")[0],s=n.getElementsByTagName("distanceField")[0];s&&(t.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const r=n.getElementsByTagName("page"),o=n.getElementsByTagName("char"),l=n.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let c=0;c<r.length;c++)t.pages.push({id:parseInt(r[c].getAttribute("id"),10)||0,file:r[c].getAttribute("file")});const u={};t.baseLineOffset=t.lineHeight-parseInt(i.getAttribute("base"),10);for(let c=0;c<o.length;c++){const f=o[c],d=parseInt(f.getAttribute("id"),10);let g=f.getAttribute("letter")??f.getAttribute("char")??String.fromCharCode(d);g==="space"&&(g=" "),u[d]=g,t.chars[g]={id:d,page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xOffset:parseInt(f.getAttribute("xoffset"),10),yOffset:parseInt(f.getAttribute("yoffset"),10),xAdvance:parseInt(f.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<l.length;c++){const f=parseInt(l[c].getAttribute("first"),10),d=parseInt(l[c].getAttribute("second"),10),g=parseInt(l[c].getAttribute("amount"),10);t.chars[u[d]].kerning[u[f]]=g}return t}},Qp={test(n){return typeof n=="string"&&n.includes("<font>")?Zp.test(ve.get().parseXML(n)):!1},parse(n){return Zp.parse(ve.get().parseXML(n))}},wM=[".xml",".fnt"],vM={extension:{type:_t.CacheParser,name:"cacheBitmapFont"},test:n=>n instanceof Gg,getCacheableAssets(n,t){const e={};return n.forEach(i=>{e[i]=t,e[`${i}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},SM={extension:{type:_t.LoadParser,priority:ss.Normal},name:"loadBitmapFont",test(n){return wM.includes(Ue.extname(n).toLowerCase())},async testParse(n){return yh.test(n)||Qp.test(n)},async parse(n,t,e){const i=yh.test(n)?yh.parse(n):Qp.parse(n),{src:s}=t,{pages:r}=i,o=[],l=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let d=0;d<r.length;++d){const g=r[d].file;let p=Ue.join(Ue.dirname(s),g);p=so(p,s),o.push({src:p,data:l})}const u=await e.load(o),c=o.map(d=>u[d.src]);return new Gg({data:i,textures:c},s)},async load(n,t){return await(await ve.get().fetch(n)).text()},async unload(n,t,e){await Promise.all(n.pages.map(i=>e.unload(i.texture.source._sourceOrigin))),n.destroy()}};class AM{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const CM={extension:{type:_t.CacheParser,name:"cacheTextureArray"},test:n=>Array.isArray(n)&&n.every(t=>t instanceof Ot),getCacheableAssets:(n,t)=>{const e={};return n.forEach(i=>{t.forEach((s,r)=>{e[i+(r===0?"":r+1)]=s})}),e}};async function Vg(n){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(n)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const TM={extension:{type:_t.DetectionParser,priority:1},test:async()=>Vg("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(t=>t!=="avif")},Jp=["png","jpg","jpeg"],MM={extension:{type:_t.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...Jp],remove:async n=>n.filter(t=>!Jp.includes(t))},PM="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function wc(n){return PM?!1:document.createElement("video").canPlayType(n)!==""}const IM={extension:{type:_t.DetectionParser,priority:0},test:async()=>wc("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(t=>t!=="mp4"&&t!=="m4v")},kM={extension:{type:_t.DetectionParser,priority:0},test:async()=>wc("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(t=>t!=="ogv")},EM={extension:{type:_t.DetectionParser,priority:0},test:async()=>wc("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(t=>t!=="webm")},RM={extension:{type:_t.DetectionParser,priority:0},test:async()=>Vg("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(t=>t!=="webp")};class FM{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var o,l;let s=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||ge(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let u=0;u<this.parsers.length;u++){const c=this.parsers[u];if(c.load&&((o=c.test)!=null&&o.call(c,t,e,this))){r=c;break}}if(!r)return ge(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await r.load(t,e,this),i.parser=r;for(let u=0;u<this.parsers.length;u++){const c=this.parsers[u];c.parse&&c.parse&&await((l=c.testParse)==null?void 0:l.call(c,s,e,this))&&(s=await c.parse(s,e,this)||s,i.parser=c)}return s})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const s={},r=io(t),o=Di(t,c=>({alias:[c],src:c,data:{}})),l=o.length,u=o.map(async c=>{const f=Ue.toAbsolute(c.src);if(!s[c.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,c)),s[c.src]=await this.promiseCache[f].promise,e&&e(++i/l)}catch(d){throw delete this.promiseCache[f],delete s[c.src],new Error(`[Loader.load] Failed to load ${f}.
${d}`)}});return await Promise.all(u),r?s[o[0].src]:s}async unload(t){const i=Di(t,s=>({alias:[s],src:s})).map(async s=>{var l,u;const r=Ue.toAbsolute(s.src),o=this.promiseCache[r];if(o){const c=await o.promise;delete this.promiseCache[r],await((u=(l=o.parser)==null?void 0:l.unload)==null?void 0:u.call(l,c,s,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&ge(`[Assets] loadParser name conflict "${e.name}"`):ge("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function nr(n,t){if(Array.isArray(t)){for(const e of t)if(n.startsWith(`data:${e}`))return!0;return!1}return n.startsWith(`data:${t}`)}function Ti(n,t){const e=n.split("?")[0],i=Ue.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const BM=".json",LM="application/json",OM={extension:{type:_t.LoadParser,priority:ss.Low},name:"loadJson",test(n){return nr(n,LM)||Ti(n,BM)},async load(n){return await(await ve.get().fetch(n)).json()}},DM=".txt",YM="text/plain",NM={name:"loadTxt",extension:{type:_t.LoadParser,priority:ss.Low,name:"loadTxt"},test(n){return nr(n,YM)||Ti(n,DM)},async load(n){return await(await ve.get().fetch(n)).text()}},UM=["normal","bold","100","200","300","400","500","600","700","800","900"],XM=[".ttf",".otf",".woff",".woff2"],WM=["font/ttf","font/otf","font/woff","font/woff2"],zM=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function GM(n){const t=Ue.extname(n),s=Ue.basename(n,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1));let r=s.length>0;for(const l of s)if(!l.match(zM)){r=!1;break}let o=s.join(" ");return r||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const VM=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function $M(n){return VM.test(n)?n:encodeURI(n)}const HM={extension:{type:_t.LoadParser,priority:ss.Low},name:"loadWebFont",test(n){return nr(n,WM)||Ti(n,XM)},async load(n,t){var i,s,r;const e=ve.get().getFontFaceSet();if(e){const o=[],l=((i=t.data)==null?void 0:i.family)??GM(n),u=((r=(s=t.data)==null?void 0:s.weights)==null?void 0:r.filter(f=>UM.includes(f)))??["normal"],c=t.data??{};for(let f=0;f<u.length;f++){const d=u[f],g=new FontFace(l,`url(${$M(n)})`,{...c,weight:d});await g.load(),e.add(g),o.push(g)}return he.set(`${l}-and-url`,{url:n,fontFaces:o}),o.length===1?o[0]:o}return ge("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(t=>{he.remove(`${t.family}-and-url`),ve.get().getFontFaceSet().delete(t)})}};function vc(n,t=1){var i;const e=(i=xn.RETINA_PREFIX)==null?void 0:i.exec(n);return e?parseFloat(e[1]):t}function Sc(n,t,e){n.label=e,n._sourceOrigin=e;const i=new Ot({source:n,label:e}),s=()=>{delete t.promiseCache[e],he.has(e)&&he.remove(e)};return i.source.once("destroy",()=>{t.promiseCache[e]&&(ge("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),i.once("destroy",()=>{n.destroyed||(ge("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const qM=".svg",jM="image/svg+xml",KM={extension:{type:_t.LoadParser,priority:ss.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(n){return nr(n,jM)||Ti(n,qM)},async load(n,t,e){var i;return((i=t.data)==null?void 0:i.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?QM(n):ZM(n,t,e,this.config.crossOrigin)},unload(n){n.destroy(!0)}};async function ZM(n,t,e,i){var b,v,C;const r=await(await ve.get().fetch(n)).blob(),o=URL.createObjectURL(r),l=new Image;l.src=o,l.crossOrigin=i,await l.decode(),URL.revokeObjectURL(o);const u=document.createElement("canvas"),c=u.getContext("2d"),f=((b=t.data)==null?void 0:b.resolution)||vc(n),d=((v=t.data)==null?void 0:v.width)??l.width,g=((C=t.data)==null?void 0:C.height)??l.height;u.width=d*f,u.height=g*f,c.drawImage(l,0,0,d*f,g*f);const{parseAsGraphicsContext:p,...x}=t.data??{},y=new mn({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:f,...x});return Sc(y,e,n)}async function QM(n){const e=await(await ve.get().fetch(n)).text(),i=new Ai;return i.svg(e),i}const JM=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Kn=null,Kh=class{constructor(){Kn||(Kn=URL.createObjectURL(new Blob([JM],{type:"application/javascript"}))),this.worker=new Worker(Kn)}};Kh.revokeObjectURL=function(){Kn&&(URL.revokeObjectURL(Kn),Kn=null)};const tP=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Zn=null;class $g{constructor(){Zn||(Zn=URL.createObjectURL(new Blob([tP],{type:"application/javascript"}))),this.worker=new Worker(Zn)}}$g.revokeObjectURL=function(){Zn&&(URL.revokeObjectURL(Zn),Zn=null)};let tm=0,bh;class eP{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Kh;e.addEventListener("message",i=>{e.terminate(),Kh.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var i;return this._run("loadImageBitmap",[t,(i=e==null?void 0:e.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){bh===void 0&&(bh=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<bh&&(this._createdWorkers++,t=new $g().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((s,r)=>{this._queue.push({id:t,arguments:e,resolve:s,reject:r})});return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[tm]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:tm++,id:i})}}const em=new eP,iP=[".jpeg",".jpg",".png",".webp",".avif"],sP=["image/jpeg","image/png","image/webp","image/avif"];async function nP(n,t){var s;const e=await ve.get().fetch(n);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${e.status} ${e.statusText}`);const i=await e.blob();return((s=t==null?void 0:t.data)==null?void 0:s.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const Hg={name:"loadTextures",extension:{type:_t.LoadParser,priority:ss.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return nr(n,sP)||Ti(n,iP)},async load(n,t,e){var r;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await em.isImageBitmapSupported()?i=await em.loadImageBitmap(n,t):i=await nP(n,t):i=await new Promise((o,l)=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=n,i.complete?o(i):(i.onload=()=>{o(i)},i.onerror=l)});const s=new mn({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((r=t.data)==null?void 0:r.resolution)||vc(n),...t.data});return Sc(s,e,n)},unload(n){n.destroy(!0)}},qg=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],rP=qg.map(n=>`video/${n.substring(1)}`);function aP(n,t,e){e===void 0&&!t.startsWith("data:")?n.crossOrigin=lP(t):e!==!1&&(n.crossOrigin=typeof e=="string"?e:"anonymous")}function oP(n){return new Promise((t,e)=>{n.addEventListener("canplaythrough",i),n.addEventListener("error",s),n.load();function i(){r(),t()}function s(o){r(),e(o)}function r(){n.removeEventListener("canplaythrough",i),n.removeEventListener("error",s)}})}function lP(n,t=globalThis.location){if(n.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(n,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const hP={name:"loadVideo",extension:{type:_t.LoadParser,name:"loadVideo"},test(n){const t=nr(n,rP),e=Ti(n,qg);return t||e},async load(n,t,e){var u,c;const i={...ja.defaultOptions,resolution:((u=t.data)==null?void 0:u.resolution)||vc(n),alphaMode:((c=t.data)==null?void 0:c.alphaMode)||await Zm(),...t.data},s=document.createElement("video"),r={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(r).forEach(f=>{const d=r[f];d!==void 0&&s.setAttribute(f,d)}),i.muted===!0&&(s.muted=!0),aP(s,n,i.crossorigin);const o=document.createElement("source");let l;if(n.startsWith("data:"))l=n.slice(5,n.indexOf(";"));else if(!n.startsWith("blob:")){const f=n.split("?")[0].slice(n.lastIndexOf(".")+1).toLowerCase();l=ja.MIME_TYPES[f]||`video/${f}`}return o.src=n,l&&(o.type=l),new Promise(f=>{const d=async()=>{const g=new ja({...i,resource:s});s.removeEventListener("canplay",d),t.data.preload&&await oP(s),f(Sc(g,e,n))};s.addEventListener("canplay",d),s.appendChild(o)})},unload(n){n.destroy(!0)}},jg={extension:{type:_t.ResolveParser,name:"resolveTexture"},test:Hg.test,parse:n=>{var t;return{resolution:parseFloat(((t=xn.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:n.split(".").pop(),src:n}}},cP={extension:{type:_t.ResolveParser,priority:-2,name:"resolveJson"},test:n=>xn.RETINA_PREFIX.test(n)&&n.endsWith(".json"),parse:jg.parse};class uP{constructor(){this._detections=[],this._initialized=!1,this.resolver=new xn,this.loader=new FM,this.cache=he,this._backgroundLoader=new AM(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,o;if(this._initialized){ge("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let l=t.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,i=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=io(t),s=Di(t).map(l=>{if(typeof l!="string"){const u=this.resolver.getAlias(l);return u.some(c=>!this.resolver.hasKey(c))&&this.add(l),Array.isArray(u)?u[0]:u}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),r=this.resolver.resolve(s),o=await this._mapLoadToResolve(r,e);return i?o[s[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const s=this.resolver.resolveBundle(t),r={},o=Object.keys(s);let l=0,u=0;const c=()=>{e==null||e(++l/u)},f=o.map(d=>{const g=s[d];return u+=Object.keys(g).length,this._mapLoadToResolve(g,c).then(p=>{r[d]=p})});return await Promise.all(f),i?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return he.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=he.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const s=await this.loader.load(i,e);this._backgroundLoader.active=!0;const r={};return i.forEach(o=>{const l=s[o.src],u=[o.src];o.alias&&u.push(...o.alias),u.forEach(c=>{r[c]=l}),he.set(u,l)}),r}async unload(t){this._initialized||await this.init();const e=Di(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Di(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{he.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,s)=>e.indexOf(i)===s),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const Vn=new uP;Fe.handleByList(_t.LoadParser,Vn.loader.parsers).handleByList(_t.ResolveParser,Vn.resolver.parsers).handleByList(_t.CacheParser,Vn.cache.parsers).handleByList(_t.DetectionParser,Vn.detections);Fe.add(CM,MM,TM,RM,IM,kM,EM,OM,NM,HM,KM,Hg,hP,SM,vM,jg,cP);const im={loader:_t.LoadParser,resolver:_t.ResolveParser,cache:_t.CacheParser,detection:_t.DetectionParser};Fe.handle(_t.Asset,n=>{const t=n.ref;Object.entries(im).filter(([e])=>!!t[e]).forEach(([e,i])=>Fe.add(Object.assign(t[e],{extension:t[e].extension??i})))},n=>{const t=n.ref;Object.keys(im).filter(e=>!!t[e]).forEach(e=>Fe.remove(t[e]))});class ro extends fc{constructor(t){t instanceof Ai&&(t={context:t});const{context:e,roundPixels:i,...s}=t||{};super({label:"Graphics",...s}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Ai,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new ro(this._context.clone()):(this._ownedContext=null,new ro(this._context))}lineStyle(t,e,i){jt(le,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const s={};return t&&(s.width=t),e&&(s.color=e),i&&(s.alpha=i),this.context.strokeStyle=s,this}beginFill(t,e){jt(le,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t!==void 0&&(i.color=t),e!==void 0&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){jt(le,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Ai.defaultStrokeStyle.width||t.color!==Ai.defaultStrokeStyle.color||t.alpha!==Ai.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return jt(le,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return jt(le,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return jt(le,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return jt(le,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return jt(le,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return jt(le,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}function fP(n,t,e){jt("8.7.0","Please use container.collectRenderables instead.");const i=e.renderPipes?e:e.batch.renderer;return n.collectRenderables(t,i,null)}Fe.add(rC,aC);class Kg{constructor(){A(this,"entries",{});A(this,"size",0)}add(t){let e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){let e=this.size;for(var i=0,s=t.length;i<s;i++)this.add(t[i]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const ui=class ui{constructor(t=0,e=0,i=0,s=0){A(this,"r");A(this,"g");A(this,"b");A(this,"a");this.r=t,this.g=e,this.b=i,this.a=s}set(t,e,i,s){return this.r=t,this.g=e,this.b=i,this.a=s,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t=t.charAt(0)=="#"?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=t.length!=8?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,i,s){return this.r+=t,this.g+=e,this.b+=i,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((e&4278190080)>>>24)/255,t.g=((e&16711680)>>>16)/255,t.b=((e&65280)>>>8)/255,t.a=(e&255)/255}static rgb888ToColor(t,e){t.r=((e&16711680)>>>16)/255,t.g=((e&65280)>>>8)/255,t.b=(e&255)/255}toRgb888(){const t=e=>("0"+(e*255).toString(16)).slice(-2);return+("0x"+t(this.r)+t(this.g)+t(this.b))}static fromString(t){return new ui().setFromString(t)}};A(ui,"WHITE",new ui(1,1,1,1)),A(ui,"RED",new ui(1,0,0,1)),A(ui,"GREEN",new ui(0,1,0,1)),A(ui,"BLUE",new ui(0,0,1,1)),A(ui,"MAGENTA",new ui(1,0,1,1));let kt=ui;const Te=class Te{static clamp(t,e,i){return t<e?e:t>i?i:t}static cosDeg(t){return Math.cos(t*Te.degRad)}static sinDeg(t){return Math.sin(t*Te.degRad)}static atan2Deg(t,e){return Math.atan2(t,e)*Te.degRad}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),.3333333333333333);return t<0?-e:e}static randomTriangular(t,e){return Te.randomTriangularWith(t,e,(t+e)*.5)}static randomTriangularWith(t,e,i){let s=Math.random(),r=e-t;return s<=(i-t)/r?t+Math.sqrt(s*r*(i-t)):e-Math.sqrt((1-s)*r*(e-i))}static isPowerOfTwo(t){return t&&(t&t-1)===0}};A(Te,"PI",3.1415927),A(Te,"PI2",Te.PI*2),A(Te,"invPI2",1/Te.PI2),A(Te,"radiansToDegrees",180/Te.PI),A(Te,"radDeg",Te.radiansToDegrees),A(Te,"degreesToRadians",Te.PI/180),A(Te,"degRad",Te.degreesToRadians);let ft=Te;const Os=class Os{static arrayCopy(t,e,i,s,r){for(let o=e,l=s;o<e+r;o++,l++)i[l]=t[o]}static arrayFill(t,e,i,s){for(let r=e;r<i;r++)t[r]=s}static setArraySize(t,e,i=0){let s=t.length;if(s==e)return t;if(t.length=e,s<e)for(let r=s;r<e;r++)t[r]=i;return t}static ensureArrayCapacity(t,e,i=0){return t.length>=e?t:Os.setArraySize(t,e,i)}static newArray(t,e){let i=new Array(t);for(let s=0;s<t;s++)i[s]=e;return i}static newFloatArray(t){if(Os.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let i=0;i<e.length;i++)e[i]=0;return e}}static newShortArray(t){if(Os.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let i=0;i<e.length;i++)e[i]=0;return e}}static toFloatArray(t){return Os.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return Os.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,i=!0){for(var s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};A(Os,"SUPPORTS_TYPED_ARRAYS",typeof Float32Array<"u");let dt=Os;class Br{constructor(t){A(this,"items",new Array);A(this,"instantiator");this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class ao{constructor(t=0,e=0){A(this,"x");A(this,"y");this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class Zg{constructor(t){A(this,"name");if(!t)throw new Error("name cannot be null.");this.name=t}}const mo=class mo extends Zg{constructor(e){super(e);A(this,"id",mo.nextID++);A(this,"bones",null);A(this,"vertices",[]);A(this,"worldVerticesLength",0);A(this,"timelineAttachment",this)}computeWorldVertices(e,i,s,r,o,l){s=o+(s>>1)*l;let u=e.bone.skeleton,c=e.deform,f=this.vertices,d=this.bones;if(!d){c.length>0&&(f=c);let y=e.bone,b=y.worldX,v=y.worldY,C=y.a,_=y.b,S=y.c,M=y.d;for(let T=i,P=o;P<s;T+=2,P+=l){let B=f[T],O=f[T+1];r[P]=B*C+O*_+b,r[P+1]=B*S+O*M+v}return}let g=0,p=0;for(let y=0;y<i;y+=2){let b=d[g];g+=b+1,p+=b}let x=u.bones;if(c.length==0)for(let y=o,b=p*3;y<s;y+=l){let v=0,C=0,_=d[g++];for(_+=g;g<_;g++,b+=3){let S=x[d[g]],M=f[b],T=f[b+1],P=f[b+2];v+=(M*S.a+T*S.b+S.worldX)*P,C+=(M*S.c+T*S.d+S.worldY)*P}r[y]=v,r[y+1]=C}else{let y=c;for(let b=o,v=p*3,C=p<<1;b<s;b+=l){let _=0,S=0,M=d[g++];for(M+=g;g<M;g++,v+=3,C+=2){let T=x[d[g]],P=f[v]+y[C],B=f[v+1]+y[C+1],O=f[v+2];_+=(P*T.a+B*T.b+T.worldX)*O,S+=(P*T.c+B*T.d+T.worldY)*O}r[b]=_,r[b+1]=S}}}copyTo(e){this.bones?(e.bones=new Array(this.bones.length),dt.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=dt.newFloatArray(this.vertices.length),dt.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment}};A(mo,"nextID",0);let Xi=mo;const Hn=class Hn{constructor(t){A(this,"id",Hn.nextID());A(this,"regions");A(this,"start",0);A(this,"digits",0);A(this,"setupIndex",0);this.regions=new Array(t)}copy(){let t=new Hn(this.regions.length);return dt.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let i=t.sequenceIndex;i==-1&&(i=this.setupIndex),i>=this.regions.length&&(i=this.regions.length-1);let s=this.regions[i];e.region!=s&&(e.region=s,e.updateRegion())}getPath(t,e){let i=t,s=(this.start+e).toString();for(let r=this.digits-s.length;r>0;r--)i+="0";return i+=s,i}static nextID(){return Hn._nextID++}};A(Hn,"_nextID",0);let oo=Hn;var Ne;(function(n){n[n.hold=0]="hold",n[n.once=1]="once",n[n.loop=2]="loop",n[n.pingpong=3]="pingpong",n[n.onceReverse=4]="onceReverse",n[n.loopReverse=5]="loopReverse",n[n.pingpongReverse=6]="pingpongReverse"})(Ne||(Ne={}));const Qg=[Ne.hold,Ne.once,Ne.loop,Ne.pingpong,Ne.onceReverse,Ne.loopReverse,Ne.pingpongReverse];class Ac{constructor(t,e,i){A(this,"name");A(this,"timelines",[]);A(this,"timelineIds",new Kg);A(this,"duration");if(!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=i}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,i,s,r,o,l,u){if(!t)throw new Error("skeleton cannot be null.");s&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));let c=this.timelines;for(let f=0,d=c.length;f<d;f++)c[f].apply(t,e,i,r,o,l,u)}}var at;(function(n){n[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add"})(at||(at={}));var Ge;(function(n){n[n.mixIn=0]="mixIn",n[n.mixOut=1]="mixOut"})(Ge||(Ge={}));const Bt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class ce{constructor(t,e){A(this,"propertyIds");A(this,"frames");this.propertyIds=e,this.frames=dt.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let i=t.length;for(let s=1;s<i;s++)if(t[s]>e)return s-1;return i-1}static search(t,e,i){let s=t.length;for(let r=i;r<s;r+=i)if(t[r]>e)return r-i;return s-i}}class ns extends ce{constructor(e,i,s){super(e,s);A(this,"curves");this.curves=dt.newFloatArray(e+i*18),this.curves[e-1]=1}setLinear(e){this.curves[e]=0}setStepped(e){this.curves[e]=1}shrink(e){let i=this.getFrameCount()+e*18;if(this.curves.length>i){let s=dt.newFloatArray(i);dt.arrayCopy(this.curves,0,s,0,i),this.curves=s}}setBezier(e,i,s,r,o,l,u,c,f,d,g){let p=this.curves,x=this.getFrameCount()+e*18;s==0&&(p[i]=2+x);let y=(r-l*2+c)*.03,b=(o-u*2+f)*.03,v=((l-c)*3-r+d)*.006,C=((u-f)*3-o+g)*.006,_=y*2+v,S=b*2+C,M=(l-r)*.3+y+v*.16666667,T=(u-o)*.3+b+C*.16666667,P=r+M,B=o+T;for(let O=x+18;x<O;x+=2)p[x]=P,p[x+1]=B,M+=_,T+=S,_+=v,S+=C,P+=M,B+=T}getBezierValue(e,i,s,r){let o=this.curves;if(o[r]>e){let f=this.frames[i],d=this.frames[i+s];return d+(e-f)/(o[r]-f)*(o[r+1]-d)}let l=r+18;for(r+=2;r<l;r+=2)if(o[r]>=e){let f=o[r-2],d=o[r-1];return d+(e-f)/(o[r]-f)*(o[r+1]-d)}i+=this.getFrameEntries();let u=o[l-2],c=o[l-1];return c+(e-u)/(this.frames[i]-u)*(this.frames[i+s]-c)}}class Gi extends ns{constructor(t,e,i){super(t,e,[i])}getFrameEntries(){return 2}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+1]=i}getCurveValue(t){let e=this.frames,i=e.length-2;for(let r=2;r<=i;r+=2)if(e[r]>t){i=r-2;break}let s=this.curves[i>>1];switch(s){case 0:let r=e[i],o=e[i+1];return o+(t-r)/(e[i+2]-r)*(e[i+2+1]-o);case 1:return e[i+1]}return this.getBezierValue(t,i,1,s-2)}getRelativeValue(t,e,i,s,r){if(t<this.frames[0]){switch(i){case at.setup:return r;case at.first:return s+(r-s)*e}return s}let o=this.getCurveValue(t);switch(i){case at.setup:return r+o*e;case at.first:case at.replace:o+=r-s}return s+o*e}getAbsoluteValue(t,e,i,s,r){if(t<this.frames[0]){switch(i){case at.setup:return r;case at.first:return s+(r-s)*e}return s}let o=this.getCurveValue(t);return i==at.setup?r+(o-r)*e:s+(o-s)*e}getAbsoluteValue2(t,e,i,s,r,o){if(t<this.frames[0]){switch(i){case at.setup:return r;case at.first:return s+(r-s)*e}return s}return i==at.setup?r+(o-r)*e:s+(o-s)*e}getScaleValue(t,e,i,s,r,o){const l=this.frames;if(t<l[0]){switch(i){case at.setup:return o;case at.first:return r+(o-r)*e}return r}let u=this.getCurveValue(t)*o;if(e==1)return i==at.add?r+u-o:u;if(s==Ge.mixOut)switch(i){case at.setup:return o+(Math.abs(u)*ft.signum(o)-o)*e;case at.first:case at.replace:return r+(Math.abs(u)*ft.signum(r)-r)*e}else{let c=0;switch(i){case at.setup:return c=Math.abs(o)*ft.signum(u),c+(u-c)*e;case at.first:case at.replace:return c=Math.abs(r)*ft.signum(u),c+(u-c)*e}}return r+(u-o)*e}}class Cc extends ns{constructor(t,e,i,s){super(t,e,[i,s])}getFrameEntries(){return 3}setFrame(t,e,i,s){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s}}class lo extends Gi{constructor(e,i,s){super(e,i,Bt.rotate+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.rotation=this.getRelativeValue(s,o,l,c.rotation,c.data.rotation))}}class Jg extends Cc{constructor(e,i,s){super(e,i,Bt.x+"|"+s,Bt.y+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){switch(l){case at.setup:c.x=c.data.x,c.y=c.data.y;return;case at.first:c.x+=(c.data.x-c.x)*o,c.y+=(c.data.y-c.y)*o}return}let d=0,g=0,p=ce.search(f,s,3),x=this.curves[p/3];switch(x){case 0:let y=f[p];d=f[p+1],g=f[p+2];let b=(s-y)/(f[p+3]-y);d+=(f[p+3+1]-d)*b,g+=(f[p+3+2]-g)*b;break;case 1:d=f[p+1],g=f[p+2];break;default:d=this.getBezierValue(s,p,1,x-2),g=this.getBezierValue(s,p,2,x+18-2)}switch(l){case at.setup:c.x=c.data.x+d*o,c.y=c.data.y+g*o;break;case at.first:case at.replace:c.x+=(c.data.x+d-c.x)*o,c.y+=(c.data.y+g-c.y)*o;break;case at.add:c.x+=d*o,c.y+=g*o}}}class t0 extends Gi{constructor(e,i,s){super(e,i,Bt.x+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.x=this.getRelativeValue(s,o,l,c.x,c.data.x))}}class e0 extends Gi{constructor(e,i,s){super(e,i,Bt.y+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.y=this.getRelativeValue(s,o,l,c.y,c.data.y))}}class i0 extends Cc{constructor(e,i,s){super(e,i,Bt.scaleX+"|"+s,Bt.scaleY+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){switch(l){case at.setup:c.scaleX=c.data.scaleX,c.scaleY=c.data.scaleY;return;case at.first:c.scaleX+=(c.data.scaleX-c.scaleX)*o,c.scaleY+=(c.data.scaleY-c.scaleY)*o}return}let d,g,p=ce.search(f,s,3),x=this.curves[p/3];switch(x){case 0:let y=f[p];d=f[p+1],g=f[p+2];let b=(s-y)/(f[p+3]-y);d+=(f[p+3+1]-d)*b,g+=(f[p+3+2]-g)*b;break;case 1:d=f[p+1],g=f[p+2];break;default:d=this.getBezierValue(s,p,1,x-2),g=this.getBezierValue(s,p,2,x+18-2)}if(d*=c.data.scaleX,g*=c.data.scaleY,o==1)l==at.add?(c.scaleX+=d-c.data.scaleX,c.scaleY+=g-c.data.scaleY):(c.scaleX=d,c.scaleY=g);else{let y=0,b=0;if(u==Ge.mixOut)switch(l){case at.setup:y=c.data.scaleX,b=c.data.scaleY,c.scaleX=y+(Math.abs(d)*ft.signum(y)-y)*o,c.scaleY=b+(Math.abs(g)*ft.signum(b)-b)*o;break;case at.first:case at.replace:y=c.scaleX,b=c.scaleY,c.scaleX=y+(Math.abs(d)*ft.signum(y)-y)*o,c.scaleY=b+(Math.abs(g)*ft.signum(b)-b)*o;break;case at.add:c.scaleX+=(d-c.data.scaleX)*o,c.scaleY+=(g-c.data.scaleY)*o}else switch(l){case at.setup:y=Math.abs(c.data.scaleX)*ft.signum(d),b=Math.abs(c.data.scaleY)*ft.signum(g),c.scaleX=y+(d-y)*o,c.scaleY=b+(g-b)*o;break;case at.first:case at.replace:y=Math.abs(c.scaleX)*ft.signum(d),b=Math.abs(c.scaleY)*ft.signum(g),c.scaleX=y+(d-y)*o,c.scaleY=b+(g-b)*o;break;case at.add:c.scaleX+=(d-c.data.scaleX)*o,c.scaleY+=(g-c.data.scaleY)*o}}}}class s0 extends Gi{constructor(e,i,s){super(e,i,Bt.scaleX+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.scaleX=this.getScaleValue(s,o,l,u,c.scaleX,c.data.scaleX))}}class n0 extends Gi{constructor(e,i,s){super(e,i,Bt.scaleY+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.scaleY=this.getScaleValue(s,o,l,u,c.scaleY,c.data.scaleY))}}class r0 extends Cc{constructor(e,i,s){super(e,i,Bt.shearX+"|"+s,Bt.shearY+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){switch(l){case at.setup:c.shearX=c.data.shearX,c.shearY=c.data.shearY;return;case at.first:c.shearX+=(c.data.shearX-c.shearX)*o,c.shearY+=(c.data.shearY-c.shearY)*o}return}let d=0,g=0,p=ce.search(f,s,3),x=this.curves[p/3];switch(x){case 0:let y=f[p];d=f[p+1],g=f[p+2];let b=(s-y)/(f[p+3]-y);d+=(f[p+3+1]-d)*b,g+=(f[p+3+2]-g)*b;break;case 1:d=f[p+1],g=f[p+2];break;default:d=this.getBezierValue(s,p,1,x-2),g=this.getBezierValue(s,p,2,x+18-2)}switch(l){case at.setup:c.shearX=c.data.shearX+d*o,c.shearY=c.data.shearY+g*o;break;case at.first:case at.replace:c.shearX+=(c.data.shearX+d-c.shearX)*o,c.shearY+=(c.data.shearY+g-c.shearY)*o;break;case at.add:c.shearX+=d*o,c.shearY+=g*o}}}class a0 extends Gi{constructor(e,i,s){super(e,i,Bt.shearX+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.shearX=this.getRelativeValue(s,o,l,c.shearX,c.data.shearX))}}class o0 extends Gi{constructor(e,i,s){super(e,i,Bt.shearY+"|"+s);A(this,"boneIndex",0);this.boneIndex=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];c.active&&(c.shearY=this.getRelativeValue(s,o,l,c.shearY,c.data.shearY))}}class l0 extends ce{constructor(e,i){super(e,[Bt.inherit+"|"+i]);A(this,"boneIndex",0);this.boneIndex=i}getFrameEntries(){return 2}setFrame(e,i,s){e*=2,this.frames[e]=i,this.frames[e+1]=s}apply(e,i,s,r,o,l,u){let c=e.bones[this.boneIndex];if(!c.active)return;if(u==Ge.mixOut){l==at.setup&&(c.inherit=c.data.inherit);return}let f=this.frames;if(s<f[0]){(l==at.setup||l==at.first)&&(c.inherit=c.data.inherit);return}c.inherit=this.frames[ce.search(f,s,2)+1]}}class h0 extends ns{constructor(e,i,s){super(e,i,[Bt.rgb+"|"+s,Bt.alpha+"|"+s]);A(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 5}setFrame(e,i,s,r,o,l){e*=5,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=l}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=this.frames,d=c.color;if(s<f[0]){let C=c.data.color;switch(l){case at.setup:d.setFromColor(C);return;case at.first:d.add((C.r-d.r)*o,(C.g-d.g)*o,(C.b-d.b)*o,(C.a-d.a)*o)}return}let g=0,p=0,x=0,y=0,b=ce.search(f,s,5),v=this.curves[b/5];switch(v){case 0:let C=f[b];g=f[b+1],p=f[b+2],x=f[b+3],y=f[b+4];let _=(s-C)/(f[b+5]-C);g+=(f[b+5+1]-g)*_,p+=(f[b+5+2]-p)*_,x+=(f[b+5+3]-x)*_,y+=(f[b+5+4]-y)*_;break;case 1:g=f[b+1],p=f[b+2],x=f[b+3],y=f[b+4];break;default:g=this.getBezierValue(s,b,1,v-2),p=this.getBezierValue(s,b,2,v+18-2),x=this.getBezierValue(s,b,3,v+18*2-2),y=this.getBezierValue(s,b,4,v+18*3-2)}o==1?d.set(g,p,x,y):(l==at.setup&&d.setFromColor(c.data.color),d.add((g-d.r)*o,(p-d.g)*o,(x-d.b)*o,(y-d.a)*o))}}class c0 extends ns{constructor(e,i,s){super(e,i,[Bt.rgb+"|"+s]);A(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 4}setFrame(e,i,s,r,o){e<<=2,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=this.frames,d=c.color;if(s<f[0]){let v=c.data.color;switch(l){case at.setup:d.r=v.r,d.g=v.g,d.b=v.b;return;case at.first:d.r+=(v.r-d.r)*o,d.g+=(v.g-d.g)*o,d.b+=(v.b-d.b)*o}return}let g=0,p=0,x=0,y=ce.search(f,s,4),b=this.curves[y>>2];switch(b){case 0:let v=f[y];g=f[y+1],p=f[y+2],x=f[y+3];let C=(s-v)/(f[y+4]-v);g+=(f[y+4+1]-g)*C,p+=(f[y+4+2]-p)*C,x+=(f[y+4+3]-x)*C;break;case 1:g=f[y+1],p=f[y+2],x=f[y+3];break;default:g=this.getBezierValue(s,y,1,b-2),p=this.getBezierValue(s,y,2,b+18-2),x=this.getBezierValue(s,y,3,b+18*2-2)}if(o==1)d.r=g,d.g=p,d.b=x;else{if(l==at.setup){let v=c.data.color;d.r=v.r,d.g=v.g,d.b=v.b}d.r+=(g-d.r)*o,d.g+=(p-d.g)*o,d.b+=(x-d.b)*o}}}class u0 extends Gi{constructor(e,i,s){super(e,i,Bt.alpha+"|"+s);A(this,"slotIndex",0);this.slotIndex=s}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=c.color;if(s<this.frames[0]){let g=c.data.color;switch(l){case at.setup:f.a=g.a;return;case at.first:f.a+=(g.a-f.a)*o}return}let d=this.getCurveValue(s);o==1?f.a=d:(l==at.setup&&(f.a=c.data.color.a),f.a+=(d-f.a)*o)}}class f0 extends ns{constructor(e,i,s){super(e,i,[Bt.rgb+"|"+s,Bt.alpha+"|"+s,Bt.rgb2+"|"+s]);A(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 8}setFrame(e,i,s,r,o,l,u,c,f){e<<=3,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=l,this.frames[e+5]=u,this.frames[e+6]=c,this.frames[e+7]=f}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=this.frames,d=c.color,g=c.darkColor;if(s<f[0]){let T=c.data.color,P=c.data.darkColor;switch(l){case at.setup:d.setFromColor(T),g.r=P.r,g.g=P.g,g.b=P.b;return;case at.first:d.add((T.r-d.r)*o,(T.g-d.g)*o,(T.b-d.b)*o,(T.a-d.a)*o),g.r+=(P.r-g.r)*o,g.g+=(P.g-g.g)*o,g.b+=(P.b-g.b)*o}return}let p=0,x=0,y=0,b=0,v=0,C=0,_=0,S=ce.search(f,s,8),M=this.curves[S>>3];switch(M){case 0:let T=f[S];p=f[S+1],x=f[S+2],y=f[S+3],b=f[S+4],v=f[S+5],C=f[S+6],_=f[S+7];let P=(s-T)/(f[S+8]-T);p+=(f[S+8+1]-p)*P,x+=(f[S+8+2]-x)*P,y+=(f[S+8+3]-y)*P,b+=(f[S+8+4]-b)*P,v+=(f[S+8+5]-v)*P,C+=(f[S+8+6]-C)*P,_+=(f[S+8+7]-_)*P;break;case 1:p=f[S+1],x=f[S+2],y=f[S+3],b=f[S+4],v=f[S+5],C=f[S+6],_=f[S+7];break;default:p=this.getBezierValue(s,S,1,M-2),x=this.getBezierValue(s,S,2,M+18-2),y=this.getBezierValue(s,S,3,M+18*2-2),b=this.getBezierValue(s,S,4,M+18*3-2),v=this.getBezierValue(s,S,5,M+18*4-2),C=this.getBezierValue(s,S,6,M+18*5-2),_=this.getBezierValue(s,S,7,M+18*6-2)}if(o==1)d.set(p,x,y,b),g.r=v,g.g=C,g.b=_;else{if(l==at.setup){d.setFromColor(c.data.color);let T=c.data.darkColor;g.r=T.r,g.g=T.g,g.b=T.b}d.add((p-d.r)*o,(x-d.g)*o,(y-d.b)*o,(b-d.a)*o),g.r+=(v-g.r)*o,g.g+=(C-g.g)*o,g.b+=(_-g.b)*o}}}class d0 extends ns{constructor(e,i,s){super(e,i,[Bt.rgb+"|"+s,Bt.rgb2+"|"+s]);A(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 7}setFrame(e,i,s,r,o,l,u,c){e*=7,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=l,this.frames[e+5]=u,this.frames[e+6]=c}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=this.frames,d=c.color,g=c.darkColor;if(s<f[0]){let M=c.data.color,T=c.data.darkColor;switch(l){case at.setup:d.r=M.r,d.g=M.g,d.b=M.b,g.r=T.r,g.g=T.g,g.b=T.b;return;case at.first:d.r+=(M.r-d.r)*o,d.g+=(M.g-d.g)*o,d.b+=(M.b-d.b)*o,g.r+=(T.r-g.r)*o,g.g+=(T.g-g.g)*o,g.b+=(T.b-g.b)*o}return}let p=0,x=0,y=0,b=0,v=0,C=0,_=ce.search(f,s,7),S=this.curves[_/7];switch(S){case 0:let M=f[_];p=f[_+1],x=f[_+2],y=f[_+3],b=f[_+4],v=f[_+5],C=f[_+6];let T=(s-M)/(f[_+7]-M);p+=(f[_+7+1]-p)*T,x+=(f[_+7+2]-x)*T,y+=(f[_+7+3]-y)*T,b+=(f[_+7+4]-b)*T,v+=(f[_+7+5]-v)*T,C+=(f[_+7+6]-C)*T;break;case 1:p=f[_+1],x=f[_+2],y=f[_+3],b=f[_+4],v=f[_+5],C=f[_+6];break;default:p=this.getBezierValue(s,_,1,S-2),x=this.getBezierValue(s,_,2,S+18-2),y=this.getBezierValue(s,_,3,S+18*2-2),b=this.getBezierValue(s,_,4,S+18*3-2),v=this.getBezierValue(s,_,5,S+18*4-2),C=this.getBezierValue(s,_,6,S+18*5-2)}if(o==1)d.r=p,d.g=x,d.b=y,g.r=b,g.g=v,g.b=C;else{if(l==at.setup){let M=c.data.color,T=c.data.darkColor;d.r=M.r,d.g=M.g,d.b=M.b,g.r=T.r,g.g=T.g,g.b=T.b}d.r+=(p-d.r)*o,d.g+=(x-d.g)*o,d.b+=(y-d.b)*o,g.r+=(b-g.r)*o,g.g+=(v-g.g)*o,g.b+=(C-g.b)*o}}}class $n extends ce{constructor(e,i){super(e,[Bt.attachment+"|"+i]);A(this,"slotIndex",0);A(this,"attachmentNames");this.slotIndex=i,this.attachmentNames=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.attachmentNames[e]=s}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(c.bone.active){if(u==Ge.mixOut){l==at.setup&&this.setAttachment(e,c,c.data.attachmentName);return}if(s<this.frames[0]){(l==at.setup||l==at.first)&&this.setAttachment(e,c,c.data.attachmentName);return}this.setAttachment(e,c,this.attachmentNames[ce.search1(this.frames,s)])}}setAttachment(e,i,s){i.setAttachment(s?e.getAttachment(this.slotIndex,s):null)}}class p0 extends ns{constructor(e,i,s,r){super(e,i,[Bt.deform+"|"+s+"|"+r.id]);A(this,"slotIndex",0);A(this,"attachment");A(this,"vertices");this.slotIndex=s,this.attachment=r,this.vertices=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.vertices[e]=s}setBezier(e,i,s,r,o,l,u,c,f,d,g){let p=this.curves,x=this.getFrameCount()+e*18;s==0&&(p[i]=2+x);let y=(r-l*2+c)*.03,b=f*.03-u*.06,v=((l-c)*3-r+d)*.006,C=(u-f+.33333333)*.018,_=y*2+v,S=b*2+C,M=(l-r)*.3+y+v*.16666667,T=u*.3+b+C*.16666667,P=r+M,B=T;for(let O=x+18;x<O;x+=2)p[x]=P,p[x+1]=B,M+=_,T+=S,_+=v,S+=C,P+=M,B+=T}getCurvePercent(e,i){let s=this.curves,r=s[i];switch(r){case 0:let c=this.frames[i];return(e-c)/(this.frames[i+this.getFrameEntries()]-c);case 1:return 0}if(r-=2,s[r]>e){let c=this.frames[i];return s[r+1]*(e-c)/(s[r]-c)}let o=r+18;for(r+=2;r<o;r+=2)if(s[r]>=e){let c=s[r-2],f=s[r-1];return f+(e-c)/(s[r]-c)*(s[r+1]-f)}let l=s[o-2],u=s[o-1];return u+(1-u)*(e-l)/(this.frames[i+this.getFrameEntries()]-l)}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=c.getAttachment();if(!f||!(f instanceof Xi)||f.timelineAttachment!=this.attachment)return;let d=c.deform;d.length==0&&(l=at.setup);let g=this.vertices,p=g[0].length,x=this.frames;if(s<x[0]){switch(l){case at.setup:d.length=0;return;case at.first:if(o==1){d.length=0;return}d.length=p;let S=f;if(S.bones){o=1-o;for(var y=0;y<p;y++)d[y]*=o}else{let M=S.vertices;for(var y=0;y<p;y++)d[y]+=(M[y]-d[y])*o}}return}if(d.length=p,s>=x[x.length-1]){let S=g[x.length-1];if(o==1)if(l==at.add){let M=f;if(M.bones)for(let T=0;T<p;T++)d[T]+=S[T];else{let T=M.vertices;for(let P=0;P<p;P++)d[P]+=S[P]-T[P]}}else dt.arrayCopy(S,0,d,0,p);else switch(l){case at.setup:{let T=f;if(T.bones)for(let P=0;P<p;P++)d[P]=S[P]*o;else{let P=T.vertices;for(let B=0;B<p;B++){let O=P[B];d[B]=O+(S[B]-O)*o}}break}case at.first:case at.replace:for(let T=0;T<p;T++)d[T]+=(S[T]-d[T])*o;break;case at.add:let M=f;if(M.bones)for(let T=0;T<p;T++)d[T]+=S[T]*o;else{let T=M.vertices;for(let P=0;P<p;P++)d[P]+=(S[P]-T[P])*o}}return}let b=ce.search1(x,s),v=this.getCurvePercent(s,b),C=g[b],_=g[b+1];if(o==1)if(l==at.add){let S=f;if(S.bones)for(let M=0;M<p;M++){let T=C[M];d[M]+=T+(_[M]-T)*v}else{let M=S.vertices;for(let T=0;T<p;T++){let P=C[T];d[T]+=P+(_[T]-P)*v-M[T]}}}else for(let S=0;S<p;S++){let M=C[S];d[S]=M+(_[S]-M)*v}else switch(l){case at.setup:{let M=f;if(M.bones)for(let T=0;T<p;T++){let P=C[T];d[T]=(P+(_[T]-P)*v)*o}else{let T=M.vertices;for(let P=0;P<p;P++){let B=C[P],O=T[P];d[P]=O+(B+(_[P]-B)*v-O)*o}}break}case at.first:case at.replace:for(let M=0;M<p;M++){let T=C[M];d[M]+=(T+(_[M]-T)*v-d[M])*o}break;case at.add:let S=f;if(S.bones)for(let M=0;M<p;M++){let T=C[M];d[M]+=(T+(_[M]-T)*v)*o}else{let M=S.vertices;for(let T=0;T<p;T++){let P=C[T];d[T]+=(P+(_[T]-P)*v-M[T])*o}}}}}const go=class go extends ce{constructor(e){super(e,go.propertyIds);A(this,"events");this.events=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i){this.frames[e]=i.time,this.events[e]=i}apply(e,i,s,r,o,l,u){if(!r)return;let c=this.frames,f=this.frames.length;if(i>s)this.apply(e,i,Number.MAX_VALUE,r,o,l,u),i=-1;else if(i>=c[f-1])return;if(s<c[0])return;let d=0;if(i<c[0])d=0;else{d=ce.search1(c,i)+1;let g=c[d];for(;d>0&&c[d-1]==g;)d--}for(;d<f&&s>=c[d];d++)r.push(this.events[d])}};A(go,"propertyIds",[""+Bt.event]);let Lr=go;const xo=class xo extends ce{constructor(e){super(e,xo.propertyIds);A(this,"drawOrders");this.drawOrders=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,i,s){this.frames[e]=i,this.drawOrders[e]=s}apply(e,i,s,r,o,l,u){if(u==Ge.mixOut){l==at.setup&&dt.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}if(s<this.frames[0]){(l==at.setup||l==at.first)&&dt.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}let c=ce.search1(this.frames,s),f=this.drawOrders[c];if(!f)dt.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{let d=e.drawOrder,g=e.slots;for(let p=0,x=f.length;p<x;p++)d[p]=g[f[p]]}}};A(xo,"propertyIds",[""+Bt.drawOrder]);let un=xo;class m0 extends ns{constructor(e,i,s){super(e,i,[Bt.ikConstraint+"|"+s]);A(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 6}setFrame(e,i,s,r,o,l,u){e*=6,this.frames[e]=i,this.frames[e+1]=s,this.frames[e+2]=r,this.frames[e+3]=o,this.frames[e+4]=l?1:0,this.frames[e+5]=u?1:0}apply(e,i,s,r,o,l,u){let c=e.ikConstraints[this.constraintIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){switch(l){case at.setup:c.mix=c.data.mix,c.softness=c.data.softness,c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch;return;case at.first:c.mix+=(c.data.mix-c.mix)*o,c.softness+=(c.data.softness-c.softness)*o,c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch}return}let d=0,g=0,p=ce.search(f,s,6),x=this.curves[p/6];switch(x){case 0:let y=f[p];d=f[p+1],g=f[p+2];let b=(s-y)/(f[p+6]-y);d+=(f[p+6+1]-d)*b,g+=(f[p+6+2]-g)*b;break;case 1:d=f[p+1],g=f[p+2];break;default:d=this.getBezierValue(s,p,1,x-2),g=this.getBezierValue(s,p,2,x+18-2)}l==at.setup?(c.mix=c.data.mix+(d-c.data.mix)*o,c.softness=c.data.softness+(g-c.data.softness)*o,u==Ge.mixOut?(c.bendDirection=c.data.bendDirection,c.compress=c.data.compress,c.stretch=c.data.stretch):(c.bendDirection=f[p+3],c.compress=f[p+4]!=0,c.stretch=f[p+5]!=0)):(c.mix+=(d-c.mix)*o,c.softness+=(g-c.softness)*o,u==Ge.mixIn&&(c.bendDirection=f[p+3],c.compress=f[p+4]!=0,c.stretch=f[p+5]!=0))}}class g0 extends ns{constructor(e,i,s){super(e,i,[Bt.transformConstraint+"|"+s]);A(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 7}setFrame(e,i,s,r,o,l,u,c){let f=this.frames;e*=7,f[e]=i,f[e+1]=s,f[e+2]=r,f[e+3]=o,f[e+4]=l,f[e+5]=u,f[e+6]=c}apply(e,i,s,r,o,l,u){let c=e.transformConstraints[this.constraintIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){let _=c.data;switch(l){case at.setup:c.mixRotate=_.mixRotate,c.mixX=_.mixX,c.mixY=_.mixY,c.mixScaleX=_.mixScaleX,c.mixScaleY=_.mixScaleY,c.mixShearY=_.mixShearY;return;case at.first:c.mixRotate+=(_.mixRotate-c.mixRotate)*o,c.mixX+=(_.mixX-c.mixX)*o,c.mixY+=(_.mixY-c.mixY)*o,c.mixScaleX+=(_.mixScaleX-c.mixScaleX)*o,c.mixScaleY+=(_.mixScaleY-c.mixScaleY)*o,c.mixShearY+=(_.mixShearY-c.mixShearY)*o}return}let d,g,p,x,y,b,v=ce.search(f,s,7),C=this.curves[v/7];switch(C){case 0:let _=f[v];d=f[v+1],g=f[v+2],p=f[v+3],x=f[v+4],y=f[v+5],b=f[v+6];let S=(s-_)/(f[v+7]-_);d+=(f[v+7+1]-d)*S,g+=(f[v+7+2]-g)*S,p+=(f[v+7+3]-p)*S,x+=(f[v+7+4]-x)*S,y+=(f[v+7+5]-y)*S,b+=(f[v+7+6]-b)*S;break;case 1:d=f[v+1],g=f[v+2],p=f[v+3],x=f[v+4],y=f[v+5],b=f[v+6];break;default:d=this.getBezierValue(s,v,1,C-2),g=this.getBezierValue(s,v,2,C+18-2),p=this.getBezierValue(s,v,3,C+18*2-2),x=this.getBezierValue(s,v,4,C+18*3-2),y=this.getBezierValue(s,v,5,C+18*4-2),b=this.getBezierValue(s,v,6,C+18*5-2)}if(l==at.setup){let _=c.data;c.mixRotate=_.mixRotate+(d-_.mixRotate)*o,c.mixX=_.mixX+(g-_.mixX)*o,c.mixY=_.mixY+(p-_.mixY)*o,c.mixScaleX=_.mixScaleX+(x-_.mixScaleX)*o,c.mixScaleY=_.mixScaleY+(y-_.mixScaleY)*o,c.mixShearY=_.mixShearY+(b-_.mixShearY)*o}else c.mixRotate+=(d-c.mixRotate)*o,c.mixX+=(g-c.mixX)*o,c.mixY+=(p-c.mixY)*o,c.mixScaleX+=(x-c.mixScaleX)*o,c.mixScaleY+=(y-c.mixScaleY)*o,c.mixShearY+=(b-c.mixShearY)*o}}class x0 extends Gi{constructor(e,i,s){super(e,i,Bt.pathConstraintPosition+"|"+s);A(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,r,o,l,u){let c=e.pathConstraints[this.constraintIndex];c.active&&(c.position=this.getAbsoluteValue(s,o,l,c.position,c.data.position))}}class y0 extends Gi{constructor(e,i,s){super(e,i,Bt.pathConstraintSpacing+"|"+s);A(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,r,o,l,u){let c=e.pathConstraints[this.constraintIndex];c.active&&(c.spacing=this.getAbsoluteValue(s,o,l,c.spacing,c.data.spacing))}}class b0 extends ns{constructor(e,i,s){super(e,i,[Bt.pathConstraintMix+"|"+s]);A(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 4}setFrame(e,i,s,r,o){let l=this.frames;e<<=2,l[e]=i,l[e+1]=s,l[e+2]=r,l[e+3]=o}apply(e,i,s,r,o,l,u){let c=e.pathConstraints[this.constraintIndex];if(!c.active)return;let f=this.frames;if(s<f[0]){switch(l){case at.setup:c.mixRotate=c.data.mixRotate,c.mixX=c.data.mixX,c.mixY=c.data.mixY;return;case at.first:c.mixRotate+=(c.data.mixRotate-c.mixRotate)*o,c.mixX+=(c.data.mixX-c.mixX)*o,c.mixY+=(c.data.mixY-c.mixY)*o}return}let d,g,p,x=ce.search(f,s,4),y=this.curves[x>>2];switch(y){case 0:let b=f[x];d=f[x+1],g=f[x+2],p=f[x+3];let v=(s-b)/(f[x+4]-b);d+=(f[x+4+1]-d)*v,g+=(f[x+4+2]-g)*v,p+=(f[x+4+3]-p)*v;break;case 1:d=f[x+1],g=f[x+2],p=f[x+3];break;default:d=this.getBezierValue(s,x,1,y-2),g=this.getBezierValue(s,x,2,y+18-2),p=this.getBezierValue(s,x,3,y+18*2-2)}if(l==at.setup){let b=c.data;c.mixRotate=b.mixRotate+(d-b.mixRotate)*o,c.mixX=b.mixX+(g-b.mixX)*o,c.mixY=b.mixY+(p-b.mixY)*o}else c.mixRotate+=(d-c.mixRotate)*o,c.mixX+=(g-c.mixX)*o,c.mixY+=(p-c.mixY)*o}}class yn extends Gi{constructor(e,i,s,r){super(e,i,r+"|"+s);A(this,"constraintIndex",0);this.constraintIndex=s}apply(e,i,s,r,o,l,u){let c;if(this.constraintIndex==-1){const f=s>=this.frames[0]?this.getCurveValue(s):0;for(const d of e.physicsConstraints)d.active&&this.global(d.data)&&this.set(d,this.getAbsoluteValue2(s,o,l,this.get(d),this.setup(d),f))}else c=e.physicsConstraints[this.constraintIndex],c.active&&this.set(c,this.getAbsoluteValue(s,o,l,this.get(c),this.setup(c)))}}class _0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintInertia)}setup(t){return t.data.inertia}get(t){return t.inertia}set(t,e){t.inertia=e}global(t){return t.inertiaGlobal}}class w0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintStrength)}setup(t){return t.data.strength}get(t){return t.strength}set(t,e){t.strength=e}global(t){return t.strengthGlobal}}class v0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintDamping)}setup(t){return t.data.damping}get(t){return t.damping}set(t,e){t.damping=e}global(t){return t.dampingGlobal}}class S0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintMass)}setup(t){return 1/t.data.massInverse}get(t){return 1/t.massInverse}set(t,e){t.massInverse=1/e}global(t){return t.massGlobal}}class A0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintWind)}setup(t){return t.data.wind}get(t){return t.wind}set(t,e){t.wind=e}global(t){return t.windGlobal}}class C0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintGravity)}setup(t){return t.data.gravity}get(t){return t.gravity}set(t,e){t.gravity=e}global(t){return t.gravityGlobal}}class T0 extends yn{constructor(t,e,i){super(t,e,i,Bt.physicsConstraintMix)}setup(t){return t.data.mix}get(t){return t.mix}set(t,e){t.mix=e}global(t){return t.mixGlobal}}const yo=class yo extends ce{constructor(e,i){super(e,yo.propertyIds);A(this,"constraintIndex");this.constraintIndex=i}getFrameCount(){return this.frames.length}setFrame(e,i){this.frames[e]=i}apply(e,i,s,r,o,l,u){let c;if(this.constraintIndex!=-1&&(c=e.physicsConstraints[this.constraintIndex],!c.active))return;const f=this.frames;if(i>s)this.apply(e,i,Number.MAX_VALUE,[],o,l,u),i=-1;else if(i>=f[f.length-1])return;if(!(s<f[0])&&(i<f[0]||s>=f[ce.search1(f,i)+1]))if(c!=null)c.reset();else for(const d of e.physicsConstraints)d.active&&d.reset()}};A(yo,"propertyIds",[Bt.physicsConstraintReset.toString()]);let ho=yo;const Si=class Si extends ce{constructor(e,i,s){super(e,[Bt.sequence+"|"+i+"|"+s.sequence.id]);A(this,"slotIndex");A(this,"attachment");this.slotIndex=i,this.attachment=s}getFrameEntries(){return Si.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(e,i,s,r,o){let l=this.frames;e*=Si.ENTRIES,l[e]=i,l[e+Si.MODE]=s|r<<4,l[e+Si.DELAY]=o}apply(e,i,s,r,o,l,u){let c=e.slots[this.slotIndex];if(!c.bone.active)return;let f=c.attachment,d=this.attachment;if(f!=d&&(!(f instanceof Xi)||f.timelineAttachment!=d))return;if(u==Ge.mixOut){l==at.setup&&(c.sequenceIndex=-1);return}let g=this.frames;if(s<g[0]){(l==at.setup||l==at.first)&&(c.sequenceIndex=-1);return}let p=ce.search(g,s,Si.ENTRIES),x=g[p],y=g[p+Si.MODE],b=g[p+Si.DELAY];if(!this.attachment.sequence)return;let v=y>>4,C=this.attachment.sequence.regions.length,_=Qg[y&15];if(_!=Ne.hold)switch(v+=(s-x)/b+1e-5|0,_){case Ne.once:v=Math.min(C-1,v);break;case Ne.loop:v%=C;break;case Ne.pingpong:{let S=(C<<1)-2;v=S==0?0:v%S,v>=C&&(v=S-v);break}case Ne.onceReverse:v=Math.max(C-1-v,0);break;case Ne.loopReverse:v=C-1-v%C;break;case Ne.pingpongReverse:{let S=(C<<1)-2;v=S==0?0:(v+C-1)%S,v>=C&&(v=S-v)}}c.sequenceIndex=v}};A(Si,"ENTRIES",3),A(Si,"MODE",1),A(Si,"DELAY",2);let co=Si;const qn=class qn{constructor(t){A(this,"data");A(this,"tracks",new Array);A(this,"timeScale",1);A(this,"unkeyedState",0);A(this,"events",new Array);A(this,"listeners",new Array);A(this,"queue",new pP(this));A(this,"propertyIDs",new Kg);A(this,"animationsChanged",!1);A(this,"trackEntryPool",new Br(()=>new dP));this.data=t}static emptyAnimation(){return qn._emptyAnimation}update(t){t*=this.timeScale;let e=this.tracks;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let o=t*r.timeScale;if(r.delay>0){if(r.delay-=o,r.delay>0)continue;o=-r.delay,r.delay=0}let l=r.next;if(l){let u=r.trackLast-l.delay;if(u>=0){for(l.delay=0,l.trackTime+=r.timeScale==0?0:(u/r.timeScale+t)*l.timeScale,r.trackTime+=o,this.setCurrent(i,l,!0);l.mixingFrom;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){e[i]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,t)){let u=r.mixingFrom;for(r.mixingFrom=null,u&&(u.mixingTo=null);u;)this.queue.end(u),u=u.mixingFrom}r.trackTime+=o}this.queue.drain()}updateMixingFrom(t,e){let i=t.mixingFrom;if(!i)return!0;let s=this.updateMixingFrom(i,e);if(i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.nextTrackLast!=-1){const r=t.mixTime==0&&i.mixTime==0;if(t.mixTime>=t.mixDuration||r)return(i.totalAlpha==0||t.mixDuration==0||r)&&(t.mixingFrom=i.mixingFrom,i.mixingFrom!=null&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),s}return i.trackTime+=e*i.timeScale,t.mixTime+=e,!1}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,i=this.tracks,s=!1;for(let g=0,p=i.length;g<p;g++){let x=i[g];if(!x||x.delay>0)continue;s=!0;let y=g==0?at.first:x.mixBlend,b=x.alpha;x.mixingFrom?b*=this.applyMixingFrom(x,t,y):x.trackTime>=x.trackEnd&&!x.next&&(b=0);let v=b>=x.alphaAttachmentThreshold,C=x.animationLast,_=x.getAnimationTime(),S=_,M=e;x.reverse&&(S=x.animation.duration-S,M=null);let T=x.animation.timelines,P=T.length;if(g==0&&b==1||y==at.add){g==0&&(v=!0);for(let B=0;B<P;B++){var r=T[B];r instanceof $n?this.applyAttachmentTimeline(r,t,S,y,v):r.apply(t,C,S,M,b,y,Ge.mixIn)}}else{let B=x.timelineMode,O=x.shortestRotation,U=!O&&x.timelinesRotation.length!=P<<1;U&&(x.timelinesRotation.length=P<<1);for(let N=0;N<P;N++){let et=T[N],K=B[N]==_h?y:at.setup;!O&&et instanceof lo?this.applyRotateTimeline(et,t,S,b,K,x.timelinesRotation,N<<1,U):et instanceof $n?this.applyAttachmentTimeline(et,t,S,y,v):et.apply(t,C,S,M,b,K,Ge.mixIn)}}this.queueEvents(x,_),e.length=0,x.nextAnimationLast=_,x.nextTrackLast=x.trackTime}for(var o=this.unkeyedState+rm,l=t.slots,u=0,c=t.slots.length;u<c;u++){var f=l[u];if(f.attachmentState==o){var d=f.data.attachmentName;f.setAttachment(d?t.getAttachment(f.data.index,d):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,i){let s=t.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,e,i);let r=0;t.mixDuration==0?(r=1,i==at.first&&(i=at.setup)):(r=t.mixTime/t.mixDuration,r>1&&(r=1),i!=at.first&&(i=s.mixBlend));let o=r<s.mixAttachmentThreshold,l=r<s.mixDrawOrderThreshold,u=s.animation.timelines,c=u.length,f=s.alpha*t.interruptAlpha,d=f*(1-r),g=s.animationLast,p=s.getAnimationTime(),x=p,y=null;if(s.reverse?x=s.animation.duration-x:r<s.eventThreshold&&(y=this.events),i==at.add)for(let b=0;b<c;b++)u[b].apply(e,g,x,y,d,i,Ge.mixOut);else{let b=s.timelineMode,v=s.timelineHoldMix,C=s.shortestRotation,_=!C&&s.timelinesRotation.length!=c<<1;_&&(s.timelinesRotation.length=c<<1),s.totalAlpha=0;for(let S=0;S<c;S++){let M=u[S],T=Ge.mixOut,P,B=0;switch(b[S]){case _h:if(!l&&M instanceof un)continue;P=i,B=d;break;case sm:P=at.setup,B=d;break;case nm:P=i,B=f;break;case wh:P=at.setup,B=f;break;default:P=at.setup;let O=v[S];B=f*Math.max(0,1-O.mixTime/O.mixDuration);break}s.totalAlpha+=B,!C&&M instanceof lo?this.applyRotateTimeline(M,e,x,B,P,s.timelinesRotation,S<<1,_):M instanceof $n?this.applyAttachmentTimeline(M,e,x,P,o&&B>=s.alphaAttachmentThreshold):(l&&M instanceof un&&P==at.setup&&(T=Ge.mixIn),M.apply(e,g,x,y,B,P,T))}}return t.mixDuration>0&&this.queueEvents(s,p),this.events.length=0,s.nextAnimationLast=p,s.nextTrackLast=s.trackTime,r}applyAttachmentTimeline(t,e,i,s,r){var o=e.slots[t.slotIndex];o.bone.active&&(i<t.frames[0]?(s==at.setup||s==at.first)&&this.setAttachment(e,o,o.data.attachmentName,r):this.setAttachment(e,o,t.attachmentNames[ce.search1(t.frames,i)],r),o.attachmentState<=this.unkeyedState&&(o.attachmentState=this.unkeyedState+rm))}setAttachment(t,e,i,s){e.setAttachment(i?t.getAttachment(e.data.index,i):null),s&&(e.attachmentState=this.unkeyedState+gP)}applyRotateTimeline(t,e,i,s,r,o,l,u){if(u&&(o[l]=0),s==1){t.apply(e,0,i,null,1,r,Ge.mixIn);return}let c=e.bones[t.boneIndex];if(!c.active)return;let f=t.frames,d=0,g=0;if(i<f[0])switch(r){case at.setup:c.rotation=c.data.rotation;default:return;case at.first:d=c.rotation,g=c.data.rotation}else d=r==at.setup?c.data.rotation:c.rotation,g=c.data.rotation+t.getCurveValue(i);let p=0,x=g-d;if(x-=Math.ceil(x/360-.5)*360,x==0)p=o[l];else{let y=0,b=0;u?(y=0,b=x):(y=o[l],b=o[l+1]);let v=y-y%360;p=x+v;let C=x>=0,_=y>=0;Math.abs(b)<=90&&ft.signum(b)!=ft.signum(x)&&(Math.abs(y-v)>180?(p+=360*ft.signum(y),_=C):v!=0?p-=360*ft.signum(y):_=C),_!=C&&(p+=360*ft.signum(y)),o[l]=p}o[l+1]=x,c.rotation=d+p*s}queueEvents(t,e){let i=t.animationStart,s=t.animationEnd,r=s-i,o=t.trackLast%r,l=this.events,u=0,c=l.length;for(;u<c;u++){let d=l[u];if(d.time<o)break;d.time>s||this.queue.event(t,d)}let f=!1;if(t.loop)if(r==0)f=!0;else{const d=Math.floor(t.trackTime/r);f=d>0&&d>Math.floor(t.trackLast/r)}else f=e>=s&&t.animationLast<s;for(f&&this.queue.complete(t);u<c;u++){let d=l[u];d.time<i||this.queue.event(t,d)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let i=e;for(;;){let s=i.mixingFrom;if(!s)break;this.queue.end(s),i.mixingFrom=null,i.mixingTo=null,i=s}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){let s=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,s&&(i&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i=!1){let s=this.data.skeletonData.findAnimation(e);if(!s)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,s,i)}setAnimationWith(t,e,i=!1){if(!e)throw new Error("animation cannot be null.");let s=!0,r=this.expandToIndex(t);r&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,s=!1):this.clearNext(r));let o=this.trackEntry(t,e,i,r);return this.setCurrent(t,o,s),this.queue.drain(),o}addAnimation(t,e,i=!1,s=0){let r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,i,s)}addAnimationWith(t,e,i=!1,s=0){if(!e)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r)for(;r.next;)r=r.next;let o=this.trackEntry(t,e,i,r);return r?(r.next=o,o.previous=r,s<=0&&(s+=r.getTrackComplete()-o.mixDuration)):(this.setCurrent(t,o,!0),this.queue.drain()),o.delay=s,o}setEmptyAnimation(t,e=0){let i=this.setAnimationWith(t,qn.emptyAnimation(),!1);return i.mixDuration=e,i.trackEnd=e,i}addEmptyAnimation(t,e=0,i=0){let s=this.addAnimationWith(t,qn.emptyAnimation(),!1,i);return i<=0&&(s.delay+=s.mixDuration-e),s.mixDuration=e,s.trackEnd=e,s}setEmptyAnimations(t=0){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,s=this.tracks.length;i<s;i++){let r=this.tracks[i];r&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(dt.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,s){let r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=t,r.animation=e,r.loop=i,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.alphaAttachmentThreshold=0,r.mixAttachmentThreshold=0,r.mixDrawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=s?this.data.getMix(s.animation,e):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=at.replace,r}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let s=t[e];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do(!s.mixingTo||s.mixBlend!=at.add)&&this.computeHold(s),s=s.mixingTo;while(s)}}}computeHold(t){let e=t.mixingTo,i=t.animation.timelines,s=t.animation.timelines.length,r=t.timelineMode;r.length=s;let o=t.timelineHoldMix;o.length=0;let l=this.propertyIDs;if(e&&e.holdPrevious){for(let u=0;u<s;u++)r[u]=l.addAll(i[u].getPropertyIds())?wh:nm;return}t:for(let u=0;u<s;u++){let c=i[u],f=c.getPropertyIds();if(!l.addAll(f))r[u]=_h;else if(!e||c instanceof $n||c instanceof un||c instanceof Lr||!e.animation.hasTimeline(f))r[u]=sm;else{for(let d=e.mixingTo;d;d=d.mixingTo)if(!d.animation.hasTimeline(f)){if(t.mixDuration>0){r[u]=mP,o[u]=d;continue t}break}r[u]=wh}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};A(qn,"_emptyAnimation",new Ac("<empty>",[],0));let Zh=qn;class dP{constructor(){A(this,"animation",null);A(this,"previous",null);A(this,"next",null);A(this,"mixingFrom",null);A(this,"mixingTo",null);A(this,"listener",null);A(this,"trackIndex",0);A(this,"loop",!1);A(this,"holdPrevious",!1);A(this,"reverse",!1);A(this,"shortestRotation",!1);A(this,"eventThreshold",0);A(this,"mixAttachmentThreshold",0);A(this,"alphaAttachmentThreshold",0);A(this,"mixDrawOrderThreshold",0);A(this,"animationStart",0);A(this,"animationEnd",0);A(this,"animationLast",0);A(this,"nextAnimationLast",0);A(this,"delay",0);A(this,"trackTime",0);A(this,"trackLast",0);A(this,"nextTrackLast",0);A(this,"trackEnd",0);A(this,"timeScale",0);A(this,"alpha",0);A(this,"mixTime",0);A(this,"_mixDuration",0);A(this,"interruptAlpha",0);A(this,"totalAlpha",0);A(this,"mixBlend",at.replace);A(this,"timelineMode",new Array);A(this,"timelineHoldMix",new Array);A(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(t){this._mixDuration=t}setMixDurationWithDelay(t,e){this._mixDuration=t,this.previous!=null&&e<=0&&(e+=this.previous.getTrackComplete()-t),this.delay=e}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(t!=0){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}wasApplied(){return this.nextTrackLast!=-1}isNextReady(){return this.next!=null&&this.nextTrackLast-this.next.delay>=0}}class pP{constructor(t){A(this,"objects",[]);A(this,"drainDisabled",!1);A(this,"animState");this.animState=t}start(t){this.objects.push(ti.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(ti.interrupt),this.objects.push(t)}end(t){this.objects.push(ti.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(ti.dispose),this.objects.push(t)}complete(t){this.objects.push(ti.complete),this.objects.push(t)}event(t,e){this.objects.push(ti.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){let s=t[i],r=t[i+1];switch(s){case ti.start:r.listener&&r.listener.start&&r.listener.start(r);for(let l=0;l<e.length;l++){let u=e[l];u.start&&u.start(r)}break;case ti.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(let l=0;l<e.length;l++){let u=e[l];u.interrupt&&u.interrupt(r)}break;case ti.end:r.listener&&r.listener.end&&r.listener.end(r);for(let l=0;l<e.length;l++){let u=e[l];u.end&&u.end(r)}case ti.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(let l=0;l<e.length;l++){let u=e[l];u.dispose&&u.dispose(r)}this.animState.trackEntryPool.free(r);break;case ti.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(let l=0;l<e.length;l++){let u=e[l];u.complete&&u.complete(r)}break;case ti.event:let o=t[i+++2];r.listener&&r.listener.event&&r.listener.event(r,o);for(let l=0;l<e.length;l++){let u=e[l];u.event&&u.event(r,o)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var ti;(function(n){n[n.start=0]="start",n[n.interrupt=1]="interrupt",n[n.end=2]="end",n[n.dispose=3]="dispose",n[n.complete=4]="complete",n[n.event=5]="event"})(ti||(ti={}));const _h=0,sm=1,nm=2,wh=3,mP=4,rm=1,gP=2;class xP{constructor(t){A(this,"skeletonData");A(this,"animationToMixTime",{});A(this,"defaultMix",0);if(!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){let s=this.skeletonData.findAnimation(t);if(!s)throw new Error("Animation not found: "+t);let r=this.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);this.setMixWith(s,r,i)}setMixWith(t,e,i){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let s=t.name+"."+e.name;this.animationToMixTime[s]=i}getMix(t,e){let i=t.name+"."+e.name,s=this.animationToMixTime[i];return s===void 0?this.defaultMix:s}}class Co extends Xi{constructor(e){super(e);A(this,"color",new kt(1,1,1,1))}copy(){let e=new Co(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}}class fn extends Xi{constructor(e){super(e);A(this,"endSlot",null);A(this,"color",new kt(.2275,.2275,.8078,1))}copy(){let e=new fn(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}}class yP{constructor(t){A(this,"_image");this._image=t}getImage(){return this._image}}var ke;(function(n){n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear"})(ke||(ke={}));var vs;(function(n){n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat"})(vs||(vs={}));class bP{constructor(){A(this,"texture");A(this,"u",0);A(this,"v",0);A(this,"u2",0);A(this,"v2",0);A(this,"width",0);A(this,"height",0);A(this,"degrees",0);A(this,"offsetX",0);A(this,"offsetY",0);A(this,"originalWidth",0);A(this,"originalHeight",0)}}class _P{constructor(t){A(this,"pages",new Array);A(this,"regions",new Array);let e=new wP(t),i=new Array(4),s={};s.size=f=>{f.width=parseInt(i[1]),f.height=parseInt(i[2])},s.format=()=>{},s.filter=f=>{f.minFilter=dt.enumValue(ke,i[1]),f.magFilter=dt.enumValue(ke,i[2])},s.repeat=f=>{i[1].indexOf("x")!=-1&&(f.uWrap=vs.Repeat),i[1].indexOf("y")!=-1&&(f.vWrap=vs.Repeat)},s.pma=f=>{f.pma=i[1]=="true"};var r={};r.xy=f=>{f.x=parseInt(i[1]),f.y=parseInt(i[2])},r.size=f=>{f.width=parseInt(i[1]),f.height=parseInt(i[2])},r.bounds=f=>{f.x=parseInt(i[1]),f.y=parseInt(i[2]),f.width=parseInt(i[3]),f.height=parseInt(i[4])},r.offset=f=>{f.offsetX=parseInt(i[1]),f.offsetY=parseInt(i[2])},r.orig=f=>{f.originalWidth=parseInt(i[1]),f.originalHeight=parseInt(i[2])},r.offsets=f=>{f.offsetX=parseInt(i[1]),f.offsetY=parseInt(i[2]),f.originalWidth=parseInt(i[3]),f.originalHeight=parseInt(i[4])},r.rotate=f=>{let d=i[1];d=="true"?f.degrees=90:d!="false"&&(f.degrees=parseInt(d))},r.index=f=>{f.index=parseInt(i[1])};let o=e.readLine();for(;o&&o.trim().length==0;)o=e.readLine();for(;!(!o||o.trim().length==0||e.readEntry(i,o)==0);)o=e.readLine();let l=null,u=null,c=null;for(;o!==null;)if(o.trim().length==0)l=null,o=e.readLine();else if(l){let f=new M0(l,o);for(;;){let d=e.readEntry(i,o=e.readLine());if(d==0)break;let g=r[i[0]];if(g)g(f);else{u||(u=[]),c||(c=[]),u.push(i[0]);let p=[];for(let x=0;x<d;x++)p.push(parseInt(i[x+1]));c.push(p)}}f.originalWidth==0&&f.originalHeight==0&&(f.originalWidth=f.width,f.originalHeight=f.height),u&&u.length>0&&c&&c.length>0&&(f.names=u,f.values=c,u=null,c=null),f.u=f.x/l.width,f.v=f.y/l.height,f.degrees==90?(f.u2=(f.x+f.height)/l.width,f.v2=(f.y+f.width)/l.height):(f.u2=(f.x+f.width)/l.width,f.v2=(f.y+f.height)/l.height),this.regions.push(f)}else{for(l=new vP(o.trim());e.readEntry(i,o=e.readLine())!=0;){let f=s[i[0]];f&&f(l)}this.pages.push(l)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t,e=""){for(let i of this.pages)i.setTexture(t.get(e+i.name))}dispose(){var t;for(let e=0;e<this.pages.length;e++)(t=this.pages[e].texture)==null||t.dispose()}}class wP{constructor(t){A(this,"lines");A(this,"index",0);this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e||(e=e.trim(),e.length==0))return 0;let i=e.indexOf(":");if(i==-1)return 0;t[0]=e.substr(0,i).trim();for(let s=1,r=i+1;;s++){let o=e.indexOf(",",r);if(o==-1)return t[s]=e.substr(r).trim(),s;if(t[s]=e.substr(r,o-r).trim(),r=o+1,s==4)return 4}}}class vP{constructor(t){A(this,"name");A(this,"minFilter",ke.Nearest);A(this,"magFilter",ke.Nearest);A(this,"uWrap",vs.ClampToEdge);A(this,"vWrap",vs.ClampToEdge);A(this,"texture",null);A(this,"width",0);A(this,"height",0);A(this,"pma",!1);A(this,"regions",new Array);this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(let e of this.regions)e.texture=t}}class M0 extends bP{constructor(e,i){super();A(this,"page");A(this,"name");A(this,"x",0);A(this,"y",0);A(this,"offsetX",0);A(this,"offsetY",0);A(this,"originalWidth",0);A(this,"originalHeight",0);A(this,"index",0);A(this,"degrees",0);A(this,"names",null);A(this,"values",null);this.page=e,this.name=i,e.regions.push(this)}}class Ni extends Xi{constructor(e,i){super(e);A(this,"region",null);A(this,"path");A(this,"regionUVs",[]);A(this,"uvs",[]);A(this,"triangles",[]);A(this,"color",new kt(1,1,1,1));A(this,"width",0);A(this,"height",0);A(this,"hullLength",0);A(this,"edges",[]);A(this,"parentMesh",null);A(this,"sequence",null);A(this,"tempColor",new kt(0,0,0,0));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.regionUVs;(!this.uvs||this.uvs.length!=e.length)&&(this.uvs=dt.newFloatArray(e.length));let i=this.uvs,s=this.uvs.length,r=this.region.u,o=this.region.v,l=0,u=0;if(this.region instanceof M0){let c=this.region,f=c.page,d=f.width,g=f.height;switch(c.degrees){case 90:r-=(c.originalHeight-c.offsetY-c.height)/d,o-=(c.originalWidth-c.offsetX-c.width)/g,l=c.originalHeight/d,u=c.originalWidth/g;for(let p=0;p<s;p+=2)i[p]=r+e[p+1]*l,i[p+1]=o+(1-e[p])*u;return;case 180:r-=(c.originalWidth-c.offsetX-c.width)/d,o-=c.offsetY/g,l=c.originalWidth/d,u=c.originalHeight/g;for(let p=0;p<s;p+=2)i[p]=r+(1-e[p])*l,i[p+1]=o+(1-e[p+1])*u;return;case 270:r-=c.offsetY/d,o-=c.offsetX/g,l=c.originalHeight/d,u=c.originalWidth/g;for(let p=0;p<s;p+=2)i[p]=r+(1-e[p+1])*l,i[p+1]=o+e[p]*u;return}r-=c.offsetX/d,o-=(c.originalHeight-c.offsetY-c.height)/g,l=c.originalWidth/d,u=c.originalHeight/g}else this.region?(l=this.region.u2-r,u=this.region.v2-o):(r=o=0,l=u=1);for(let c=0;c<s;c+=2)i[c]=r+e[c]*l,i[c+1]=o+e[c+1]*u}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let e=new Ni(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),dt.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),dt.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),dt.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),dt.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}computeWorldVertices(e,i,s,r,o,l){this.sequence!=null&&this.sequence.apply(e,this),super.computeWorldVertices(e,i,s,r,o,l)}newLinkedMesh(){let e=new Ni(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),e.region!=null&&e.updateRegion(),e}}class ir extends Xi{constructor(e){super(e);A(this,"lengths",[]);A(this,"closed",!1);A(this,"constantSpeed",!1);A(this,"color",new kt(1,1,1,1))}copy(){let e=new ir(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),dt.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}}class Tc extends Xi{constructor(e){super(e);A(this,"x",0);A(this,"y",0);A(this,"rotation",0);A(this,"color",new kt(.38,.94,0,1))}computeWorldPosition(e,i){return i.x=this.x*e.a+this.y*e.b+e.worldX,i.y=this.x*e.c+this.y*e.d+e.worldY,i}computeWorldRotation(e){const i=this.rotation*ft.degRad,s=Math.cos(i),r=Math.sin(i),o=s*e.a+r*e.b,l=s*e.c+r*e.d;return ft.atan2Deg(l,o)}copy(){let e=new Tc(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}}const zt=class zt extends Zg{constructor(e,i){super(e);A(this,"x",0);A(this,"y",0);A(this,"scaleX",1);A(this,"scaleY",1);A(this,"rotation",0);A(this,"width",0);A(this,"height",0);A(this,"color",new kt(1,1,1,1));A(this,"path");A(this,"region",null);A(this,"sequence",null);A(this,"offset",dt.newFloatArray(8));A(this,"uvs",dt.newFloatArray(8));A(this,"tempColor",new kt(1,1,1,1));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.region,i=this.uvs;if(e==null){i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=1,i[5]=1,i[6]=1,i[7]=0;return}let s=this.width/this.region.originalWidth*this.scaleX,r=this.height/this.region.originalHeight*this.scaleY,o=-this.width/2*this.scaleX+this.region.offsetX*s,l=-this.height/2*this.scaleY+this.region.offsetY*r,u=o+this.region.width*s,c=l+this.region.height*r,f=this.rotation*ft.degRad,d=Math.cos(f),g=Math.sin(f),p=this.x,x=this.y,y=o*d+p,b=o*g,v=l*d+x,C=l*g,_=u*d+p,S=u*g,M=c*d+x,T=c*g,P=this.offset;P[0]=y-C,P[1]=v+b,P[2]=y-T,P[3]=M+b,P[4]=_-T,P[5]=M+S,P[6]=_-C,P[7]=v+S,e.degrees==90?(i[0]=e.u2,i[1]=e.v2,i[2]=e.u,i[3]=e.v2,i[4]=e.u,i[5]=e.v,i[6]=e.u2,i[7]=e.v):(i[0]=e.u,i[1]=e.v2,i[2]=e.u,i[3]=e.v,i[4]=e.u2,i[5]=e.v,i[6]=e.u2,i[7]=e.v2)}computeWorldVertices(e,i,s,r){this.sequence!=null&&this.sequence.apply(e,this);let o=e.bone,l=this.offset,u=o.worldX,c=o.worldY,f=o.a,d=o.b,g=o.c,p=o.d,x=0,y=0;x=l[0],y=l[1],i[s]=x*f+y*d+u,i[s+1]=x*g+y*p+c,s+=r,x=l[2],y=l[3],i[s]=x*f+y*d+u,i[s+1]=x*g+y*p+c,s+=r,x=l[4],y=l[5],i[s]=x*f+y*d+u,i[s+1]=x*g+y*p+c,s+=r,x=l[6],y=l[7],i[s]=x*f+y*d+u,i[s+1]=x*g+y*p+c}copy(){let e=new zt(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,dt.arrayCopy(this.uvs,0,e.uvs,0,8),dt.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=this.sequence!=null?this.sequence.copy():null,e}};A(zt,"X1",0),A(zt,"Y1",1),A(zt,"C1R",2),A(zt,"C1G",3),A(zt,"C1B",4),A(zt,"C1A",5),A(zt,"U1",6),A(zt,"V1",7),A(zt,"X2",8),A(zt,"Y2",9),A(zt,"C2R",10),A(zt,"C2G",11),A(zt,"C2B",12),A(zt,"C2A",13),A(zt,"U2",14),A(zt,"V2",15),A(zt,"X3",16),A(zt,"Y3",17),A(zt,"C3R",18),A(zt,"C3G",19),A(zt,"C3B",20),A(zt,"C3A",21),A(zt,"U3",22),A(zt,"V3",23),A(zt,"X4",24),A(zt,"Y4",25),A(zt,"C4R",26),A(zt,"C4G",27),A(zt,"C4B",28),A(zt,"C4A",29),A(zt,"U4",30),A(zt,"V4",31);let Yi=zt;class SP{constructor(t){A(this,"atlas");this.atlas=t}loadSequence(t,e,i){let s=i.regions;for(let r=0,o=s.length;r<o;r++){let l=i.getPath(e,r),u=this.atlas.findRegion(l);if(u==null)throw new Error("Region not found in atlas: "+l+" (sequence: "+t+")");s[r]=u}}newRegionAttachment(t,e,i,s){let r=new Yi(e,i);if(s!=null)this.loadSequence(e,i,s);else{let o=this.atlas.findRegion(i);if(!o)throw new Error("Region not found in atlas: "+i+" (region attachment: "+e+")");r.region=o}return r}newMeshAttachment(t,e,i,s){let r=new Ni(e,i);if(s!=null)this.loadSequence(e,i,s);else{let o=this.atlas.findRegion(i);if(!o)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");r.region=o}return r}newBoundingBoxAttachment(t,e){return new Co(e)}newPathAttachment(t,e){return new ir(e)}newPointAttachment(t,e){return new Tc(e)}newClippingAttachment(t,e){return new fn(e)}}class P0{constructor(t,e,i){A(this,"index",0);A(this,"name");A(this,"parent",null);A(this,"length",0);A(this,"x",0);A(this,"y",0);A(this,"rotation",0);A(this,"scaleX",1);A(this,"scaleY",1);A(this,"shearX",0);A(this,"shearY",0);A(this,"inherit",me.Normal);A(this,"skinRequired",!1);A(this,"color",new kt);A(this,"icon");A(this,"visible",!1);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}}var me;(function(n){n[n.Normal=0]="Normal",n[n.OnlyTranslation=1]="OnlyTranslation",n[n.NoRotationOrReflection=2]="NoRotationOrReflection",n[n.NoScale=3]="NoScale",n[n.NoScaleOrReflection=4]="NoScaleOrReflection"})(me||(me={}));class am{constructor(t,e,i){A(this,"data");A(this,"skeleton");A(this,"parent",null);A(this,"children",new Array);A(this,"x",0);A(this,"y",0);A(this,"rotation",0);A(this,"scaleX",0);A(this,"scaleY",0);A(this,"shearX",0);A(this,"shearY",0);A(this,"ax",0);A(this,"ay",0);A(this,"arotation",0);A(this,"ascaleX",0);A(this,"ascaleY",0);A(this,"ashearX",0);A(this,"ashearY",0);A(this,"a",0);A(this,"b",0);A(this,"c",0);A(this,"d",0);A(this,"worldY",0);A(this,"worldX",0);A(this,"inherit",me.Normal);A(this,"sorted",!1);A(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}isActive(){return this.active}update(t){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,s,r,o,l){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=s,this.ascaleY=r,this.ashearX=o,this.ashearY=l;let u=this.parent;if(!u){let p=this.skeleton;const x=p.scaleX,y=p.scaleY,b=(i+o)*ft.degRad,v=(i+90+l)*ft.degRad;this.a=Math.cos(b)*s*x,this.b=Math.cos(v)*r*x,this.c=Math.sin(b)*s*y,this.d=Math.sin(v)*r*y,this.worldX=t*x+p.x,this.worldY=e*y+p.y;return}let c=u.a,f=u.b,d=u.c,g=u.d;switch(this.worldX=c*t+f*e+u.worldX,this.worldY=d*t+g*e+u.worldY,this.inherit){case me.Normal:{const p=(i+o)*ft.degRad,x=(i+90+l)*ft.degRad,y=Math.cos(p)*s,b=Math.cos(x)*r,v=Math.sin(p)*s,C=Math.sin(x)*r;this.a=c*y+f*v,this.b=c*b+f*C,this.c=d*y+g*v,this.d=d*b+g*C;return}case me.OnlyTranslation:{const p=(i+o)*ft.degRad,x=(i+90+l)*ft.degRad;this.a=Math.cos(p)*s,this.b=Math.cos(x)*r,this.c=Math.sin(p)*s,this.d=Math.sin(x)*r;break}case me.NoRotationOrReflection:{let p=1/this.skeleton.scaleX,x=1/this.skeleton.scaleY;c*=p,d*=x;let y=c*c+d*d,b=0;y>1e-4?(y=Math.abs(c*g*x-f*p*d)/y,f=d*y,g=c*y,b=Math.atan2(d,c)*ft.radDeg):(c=0,d=0,b=90-Math.atan2(g,f)*ft.radDeg);const v=(i+o-b)*ft.degRad,C=(i+l-b+90)*ft.degRad,_=Math.cos(v)*s,S=Math.cos(C)*r,M=Math.sin(v)*s,T=Math.sin(C)*r;this.a=c*_-f*M,this.b=c*S-f*T,this.c=d*_+g*M,this.d=d*S+g*T;break}case me.NoScale:case me.NoScaleOrReflection:{i*=ft.degRad;const p=Math.cos(i),x=Math.sin(i);let y=(c*p+f*x)/this.skeleton.scaleX,b=(d*p+g*x)/this.skeleton.scaleY,v=Math.sqrt(y*y+b*b);v>1e-5&&(v=1/v),y*=v,b*=v,v=Math.sqrt(y*y+b*b),this.inherit==me.NoScale&&c*g-f*d<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(v=-v),i=Math.PI/2+Math.atan2(b,y);const C=Math.cos(i)*v,_=Math.sin(i)*v;o*=ft.degRad,l=(90+l)*ft.degRad;const S=Math.cos(o)*s,M=Math.cos(l)*r,T=Math.sin(o)*s,P=Math.sin(l)*r;this.a=y*S+C*T,this.b=y*M+C*P,this.c=b*S+_*T,this.d=b*M+_*P;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY,this.inherit=t.inherit}updateAppliedTransform(){let t=this.parent;if(!t){this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*ft.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*ft.radDeg;return}let e=t.a,i=t.b,s=t.c,r=t.d,o=1/(e*r-i*s),l=r*o,u=i*o,c=s*o,f=e*o,d=this.worldX-t.worldX,g=this.worldY-t.worldY;this.ax=d*l-g*u,this.ay=g*f-d*c;let p,x,y,b;if(this.inherit==me.OnlyTranslation)p=this.a,x=this.b,y=this.c,b=this.d;else{switch(this.inherit){case me.NoRotationOrReflection:{let M=Math.abs(e*r-i*s)/(e*e+s*s);i=-s*this.skeleton.scaleX*M/this.skeleton.scaleY,r=e*this.skeleton.scaleY*M/this.skeleton.scaleX,o=1/(e*r-i*s),l=r*o,u=i*o;break}case me.NoScale:case me.NoScaleOrReflection:let v=ft.cosDeg(this.rotation),C=ft.sinDeg(this.rotation);e=(e*v+i*C)/this.skeleton.scaleX,s=(s*v+r*C)/this.skeleton.scaleY;let _=Math.sqrt(e*e+s*s);_>1e-5&&(_=1/_),e*=_,s*=_,_=Math.sqrt(e*e+s*s),this.inherit==me.NoScale&&o<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(_=-_);let S=ft.PI/2+Math.atan2(s,e);i=Math.cos(S)*_,r=Math.sin(S)*_,o=1/(e*r-i*s),l=r*o,u=i*o,c=s*o,f=e*o}p=l*this.a-u*this.c,x=l*this.b-u*this.d,y=f*this.c-c*this.a,b=f*this.d-c*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(p*p+y*y),this.ascaleX>1e-4){let v=p*b-x*y;this.ascaleY=v/this.ascaleX,this.ashearY=-Math.atan2(p*x+y*b,v)*ft.radDeg,this.arotation=Math.atan2(y,p)*ft.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(x*x+b*b),this.ashearY=0,this.arotation=90-Math.atan2(b,x)*ft.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*ft.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*ft.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),i=t.x-this.worldX,s=t.y-this.worldY;return t.x=i*this.d*e-s*this.b*e,t.y=s*this.a*e-i*this.c*e,t}localToWorld(t){let e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t}worldToParent(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.worldToLocal(t)}parentToWorld(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.localToWorld(t)}worldToLocalRotation(t){let e=ft.sinDeg(t),i=ft.cosDeg(t);return Math.atan2(this.a*e-this.c*i,this.d*i-this.b*e)*ft.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=ft.sinDeg(t),i=ft.cosDeg(t);return Math.atan2(i*this.c+e*this.d,i*this.a+e*this.b)*ft.radDeg}rotateWorld(t){t*=ft.degRad;const e=Math.sin(t),i=Math.cos(t),s=this.a,r=this.b;this.a=i*s-e*this.c,this.b=i*r-e*this.d,this.c=e*s+i*this.c,this.d=e*r+i*this.d}}class To{constructor(t,e,i){A(this,"name");A(this,"order");A(this,"skinRequired");this.name=t,this.order=e,this.skinRequired=i}}class I0{constructor(t,e){A(this,"data");A(this,"intValue",0);A(this,"floatValue",0);A(this,"stringValue",null);A(this,"time",0);A(this,"volume",0);A(this,"balance",0);if(!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class k0{constructor(t){A(this,"name");A(this,"intValue",0);A(this,"floatValue",0);A(this,"stringValue",null);A(this,"audioPath",null);A(this,"volume",0);A(this,"balance",0);this.name=t}}class AP{constructor(t,e){A(this,"data");A(this,"bones");A(this,"target");A(this,"bendDirection",0);A(this,"compress",!1);A(this,"stretch",!1);A(this,"mix",1);A(this,"softness",0);A(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let r=e.findBone(t.bones[s].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[s].name}`);this.bones.push(r)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=i,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}update(t){if(this.mix==0)return;let e=this.target,i=this.bones;switch(i.length){case 1:this.apply1(i[0],e.worldX,e.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(i[0],i[1],e.worldX,e.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,i,s,r,o,l){let u=t.parent;if(!u)throw new Error("IK bone must have parent.");let c=u.a,f=u.b,d=u.c,g=u.d,p=-t.ashearX-t.arotation,x=0,y=0;switch(t.inherit){case me.OnlyTranslation:x=(e-t.worldX)*ft.signum(t.skeleton.scaleX),y=(i-t.worldY)*ft.signum(t.skeleton.scaleY);break;case me.NoRotationOrReflection:let C=Math.abs(c*g-f*d)/Math.max(1e-4,c*c+d*d),_=c/t.skeleton.scaleX,S=d/t.skeleton.scaleY;f=-S*C*t.skeleton.scaleX,g=_*C*t.skeleton.scaleY,p+=Math.atan2(S,_)*ft.radDeg;default:let M=e-u.worldX,T=i-u.worldY,P=c*g-f*d;Math.abs(P)<=1e-4?(x=0,y=0):(x=(M*g-T*f)/P-t.ax,y=(T*c-M*d)/P-t.ay)}p+=Math.atan2(y,x)*ft.radDeg,t.ascaleX<0&&(p+=180),p>180?p-=360:p<-180&&(p+=360);let b=t.ascaleX,v=t.ascaleY;if(s||r){switch(t.inherit){case me.NoScale:case me.NoScaleOrReflection:x=e-t.worldX,y=i-t.worldY}const C=t.data.length*b;if(C>1e-4){const _=x*x+y*y;if(s&&_<C*C||r&&_>C*C){const S=(Math.sqrt(_)/C-1)*l+1;b*=S,o&&(v*=S)}}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+p*l,b,v,t.ashearX,t.ashearY)}apply2(t,e,i,s,r,o,l,u,c){if(t.inherit!=me.Normal||e.inherit!=me.Normal)return;let f=t.ax,d=t.ay,g=t.ascaleX,p=t.ascaleY,x=g,y=p,b=e.ascaleX,v=0,C=0,_=0;g<0?(g=-g,v=180,_=-1):(v=0,_=1),p<0&&(p=-p,_=-_),b<0?(b=-b,C=180):C=0;let S=e.ax,M=0,T=0,P=0,B=t.a,O=t.b,U=t.c,N=t.d,et=Math.abs(g-p)<=1e-4;!et||o?(M=0,T=B*S+t.worldX,P=U*S+t.worldY):(M=e.ay,T=B*S+O*M+t.worldX,P=U*S+N*M+t.worldY);let K=t.parent;if(!K)throw new Error("IK parent must itself have a parent.");B=K.a,O=K.b,U=K.c,N=K.d;let V=B*N-O*U,J=T-K.worldX,E=P-K.worldY;V=Math.abs(V)<=1e-4?0:1/V;let L=(J*N-E*O)*V-f,Y=(E*B-J*U)*V-d,W=Math.sqrt(L*L+Y*Y),q=e.data.length*b,j,tt;if(W<1e-4){this.apply1(t,i,s,!1,o,!1,c),e.updateWorldTransformWith(S,M,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}J=i-K.worldX,E=s-K.worldY;let Z=(J*N-E*O)*V-f,ct=(E*B-J*U)*V-d,lt=Z*Z+ct*ct;if(u!=0){u*=g*(b+1)*.5;let gt=Math.sqrt(lt),It=gt-W-q*g+u;if(It>0){let wt=Math.min(1,It/(u*2))-1;wt=(It-u*(1-wt*wt))/gt,Z-=wt*Z,ct-=wt*ct,lt=Z*Z+ct*ct}}t:if(et){q*=g;let gt=(lt-W*W-q*q)/(2*W*q);gt<-1?(gt=-1,tt=Math.PI*r):gt>1?(gt=1,tt=0,o&&(B=(Math.sqrt(lt)/(W+q)-1)*c+1,x*=B,l&&(y*=B))):tt=Math.acos(gt)*r,B=W+q*gt,O=q*Math.sin(tt),j=Math.atan2(ct*B-Z*O,Z*B+ct*O)}else{B=g*q,O=p*q;let gt=B*B,It=O*O,wt=Math.atan2(ct,Z);U=It*W*W+gt*lt-gt*It;let ee=-2*It*W,ie=It-gt;if(N=ee*ee-4*ie*U,N>=0){let be=Math.sqrt(N);ee<0&&(be=-be),be=-(ee+be)*.5;let ii=be/ie,rs=U/be,Cs=Math.abs(ii)<Math.abs(rs)?ii:rs;if(ii=lt-Cs*Cs,ii>=0){E=Math.sqrt(ii)*r,j=wt-Math.atan2(E,Cs),tt=Math.atan2(E/p,(Cs-W)/g);break t}}let Pe=ft.PI,Kt=W-B,St=Kt*Kt,Dt=0,Le=0,Ii=W+B,As=Ii*Ii,Vi=0;U=-B*W/(gt-It),U>=-1&&U<=1&&(U=Math.acos(U),J=B*Math.cos(U)+W,E=O*Math.sin(U),N=J*J+E*E,N<St&&(Pe=U,St=N,Kt=J,Dt=E),N>As&&(Le=U,As=N,Ii=J,Vi=E)),lt<=(St+As)*.5?(j=wt-Math.atan2(Dt*r,Kt),tt=Pe*r):(j=wt-Math.atan2(Vi*r,Ii),tt=Le*r)}let Pt=Math.atan2(M,S)*_,Ct=t.arotation;j=(j-Pt)*ft.radDeg+v-Ct,j>180?j-=360:j<-180&&(j+=360),t.updateWorldTransformWith(f,d,Ct+j*c,x,y,0,0),Ct=e.arotation,tt=((tt+Pt)*ft.radDeg-e.ashearX)*_+C-Ct,tt>180?tt-=360:tt<-180&&(tt+=360),e.updateWorldTransformWith(S,M,Ct+tt*c,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class E0 extends To{constructor(e){super(e,0,!1);A(this,"bones",new Array);A(this,"_target",null);A(this,"bendDirection",0);A(this,"compress",!1);A(this,"stretch",!1);A(this,"uniform",!1);A(this,"mix",0);A(this,"softness",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class R0 extends To{constructor(e){super(e,0,!1);A(this,"bones",new Array);A(this,"_target",null);A(this,"positionMode",es.Fixed);A(this,"spacingMode",Me.Fixed);A(this,"rotateMode",dn.Chain);A(this,"offsetRotation",0);A(this,"position",0);A(this,"spacing",0);A(this,"mixRotate",0);A(this,"mixX",0);A(this,"mixY",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var es;(function(n){n[n.Fixed=0]="Fixed",n[n.Percent=1]="Percent"})(es||(es={}));var Me;(function(n){n[n.Length=0]="Length",n[n.Fixed=1]="Fixed",n[n.Percent=2]="Percent",n[n.Proportional=3]="Proportional"})(Me||(Me={}));var dn;(function(n){n[n.Tangent=0]="Tangent",n[n.Chain=1]="Chain",n[n.ChainScale=2]="ChainScale"})(dn||(dn={}));const fi=class fi{constructor(t,e){A(this,"data");A(this,"bones");A(this,"target");A(this,"position",0);A(this,"spacing",0);A(this,"mixRotate",0);A(this,"mixX",0);A(this,"mixY",0);A(this,"spaces",new Array);A(this,"positions",new Array);A(this,"world",new Array);A(this,"curves",new Array);A(this,"lengths",new Array);A(this,"segments",new Array);A(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,r=t.bones.length;s<r;s++){let o=e.findBone(t.bones[s].name);if(!o)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(o)}let i=e.findSlot(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=i,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}update(t){let e=this.target.getAttachment();if(!(e instanceof ir))return;let i=this.mixRotate,s=this.mixX,r=this.mixY;if(i==0&&s==0&&r==0)return;let o=this.data,l=o.rotateMode==dn.Tangent,u=o.rotateMode==dn.ChainScale,c=this.bones,f=c.length,d=l?f:f+1,g=dt.setArraySize(this.spaces,d),p=u?this.lengths=dt.setArraySize(this.lengths,f):[],x=this.spacing;switch(o.spacingMode){case Me.Percent:if(u)for(let T=0,P=d-1;T<P;T++){let B=c[T],O=B.data.length,U=O*B.a,N=O*B.c;p[T]=Math.sqrt(U*U+N*N)}dt.arrayFill(g,1,d,x);break;case Me.Proportional:let S=0;for(let T=0,P=d-1;T<P;){let B=c[T],O=B.data.length;if(O<fi.epsilon)u&&(p[T]=0),g[++T]=x;else{let U=O*B.a,N=O*B.c,et=Math.sqrt(U*U+N*N);u&&(p[T]=et),g[++T]=et,S+=et}}if(S>0){S=d/S*x;for(let T=1;T<d;T++)g[T]*=S}break;default:let M=o.spacingMode==Me.Length;for(let T=0,P=d-1;T<P;){let B=c[T],O=B.data.length;if(O<fi.epsilon)u&&(p[T]=0),g[++T]=x;else{let U=O*B.a,N=O*B.c,et=Math.sqrt(U*U+N*N);u&&(p[T]=et),g[++T]=(M?O+x:x)*et/O}}}let y=this.computeWorldPositions(e,d,l),b=y[0],v=y[1],C=o.offsetRotation,_=!1;if(C==0)_=o.rotateMode==dn.Chain;else{_=!1;let S=this.target.bone;C*=S.a*S.d-S.b*S.c>0?ft.degRad:-.01745329277777778}for(let S=0,M=3;S<f;S++,M+=3){let T=c[S];T.worldX+=(b-T.worldX)*s,T.worldY+=(v-T.worldY)*r;let P=y[M],B=y[M+1],O=P-b,U=B-v;if(u){let N=p[S];if(N!=0){let et=(Math.sqrt(O*O+U*U)/N-1)*i+1;T.a*=et,T.c*=et}}if(b=P,v=B,i>0){let N=T.a,et=T.b,K=T.c,V=T.d,J=0,E=0,L=0;if(l?J=y[M-1]:g[S+1]==0?J=y[M+2]:J=Math.atan2(U,O),J-=Math.atan2(K,N),_){E=Math.cos(J),L=Math.sin(J);let Y=T.data.length;b+=(Y*(E*N-L*K)-O)*i,v+=(Y*(L*N+E*K)-U)*i}else J+=C;J>ft.PI?J-=ft.PI2:J<-3.1415927&&(J+=ft.PI2),J*=i,E=Math.cos(J),L=Math.sin(J),T.a=E*N-L*K,T.b=E*et-L*V,T.c=L*N+E*K,T.d=L*et+E*V}T.updateAppliedTransform()}}computeWorldPositions(t,e,i){let s=this.target,r=this.position,o=this.spaces,l=dt.setArraySize(this.positions,e*3+2),u=this.world,c=t.closed,f=t.worldVerticesLength,d=f/6,g=fi.NONE;if(!t.constantSpeed){let Y=t.lengths;d-=c?1:2;let W=Y[d];this.data.positionMode==es.Percent&&(r*=W);let q;switch(this.data.spacingMode){case Me.Percent:q=W;break;case Me.Proportional:q=W/e;break;default:q=1}u=dt.setArraySize(this.world,8);for(let j=0,tt=0,Z=0;j<e;j++,tt+=3){let ct=o[j]*q;r+=ct;let lt=r;if(c)lt%=W,lt<0&&(lt+=W),Z=0;else if(lt<0){g!=fi.BEFORE&&(g=fi.BEFORE,t.computeWorldVertices(s,2,4,u,0,2)),this.addBeforePosition(lt,u,0,l,tt);continue}else if(lt>W){g!=fi.AFTER&&(g=fi.AFTER,t.computeWorldVertices(s,f-6,4,u,0,2)),this.addAfterPosition(lt-W,u,0,l,tt);continue}for(;;Z++){let Pt=Y[Z];if(!(lt>Pt)){if(Z==0)lt/=Pt;else{let Ct=Y[Z-1];lt=(lt-Ct)/(Pt-Ct)}break}}Z!=g&&(g=Z,c&&Z==d?(t.computeWorldVertices(s,f-4,4,u,0,2),t.computeWorldVertices(s,0,4,u,4,2)):t.computeWorldVertices(s,Z*6+2,8,u,0,2)),this.addCurvePosition(lt,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,tt,i||j>0&&ct==0)}return l}c?(f+=2,u=dt.setArraySize(this.world,f),t.computeWorldVertices(s,2,f-4,u,0,2),t.computeWorldVertices(s,0,2,u,f-4,2),u[f-2]=u[0],u[f-1]=u[1]):(d--,f-=4,u=dt.setArraySize(this.world,f),t.computeWorldVertices(s,2,f,u,0,2));let p=dt.setArraySize(this.curves,d),x=0,y=u[0],b=u[1],v=0,C=0,_=0,S=0,M=0,T=0,P=0,B=0,O=0,U=0,N=0,et=0,K=0,V=0;for(let Y=0,W=2;Y<d;Y++,W+=6)v=u[W],C=u[W+1],_=u[W+2],S=u[W+3],M=u[W+4],T=u[W+5],P=(y-v*2+_)*.1875,B=(b-C*2+S)*.1875,O=((v-_)*3-y+M)*.09375,U=((C-S)*3-b+T)*.09375,N=P*2+O,et=B*2+U,K=(v-y)*.75+P+O*.16666667,V=(C-b)*.75+B+U*.16666667,x+=Math.sqrt(K*K+V*V),K+=N,V+=et,N+=O,et+=U,x+=Math.sqrt(K*K+V*V),K+=N,V+=et,x+=Math.sqrt(K*K+V*V),K+=N+O,V+=et+U,x+=Math.sqrt(K*K+V*V),p[Y]=x,y=M,b=T;this.data.positionMode==es.Percent&&(r*=x);let J;switch(this.data.spacingMode){case Me.Percent:J=x;break;case Me.Proportional:J=x/e;break;default:J=1}let E=this.segments,L=0;for(let Y=0,W=0,q=0,j=0;Y<e;Y++,W+=3){let tt=o[Y]*J;r+=tt;let Z=r;if(c)Z%=x,Z<0&&(Z+=x),q=0;else if(Z<0){this.addBeforePosition(Z,u,0,l,W);continue}else if(Z>x){this.addAfterPosition(Z-x,u,f-4,l,W);continue}for(;;q++){let ct=p[q];if(!(Z>ct)){if(q==0)Z/=ct;else{let lt=p[q-1];Z=(Z-lt)/(ct-lt)}break}}if(q!=g){g=q;let ct=q*6;for(y=u[ct],b=u[ct+1],v=u[ct+2],C=u[ct+3],_=u[ct+4],S=u[ct+5],M=u[ct+6],T=u[ct+7],P=(y-v*2+_)*.03,B=(b-C*2+S)*.03,O=((v-_)*3-y+M)*.006,U=((C-S)*3-b+T)*.006,N=P*2+O,et=B*2+U,K=(v-y)*.3+P+O*.16666667,V=(C-b)*.3+B+U*.16666667,L=Math.sqrt(K*K+V*V),E[0]=L,ct=1;ct<8;ct++)K+=N,V+=et,N+=O,et+=U,L+=Math.sqrt(K*K+V*V),E[ct]=L;K+=N,V+=et,L+=Math.sqrt(K*K+V*V),E[8]=L,K+=N+O,V+=et+U,L+=Math.sqrt(K*K+V*V),E[9]=L,j=0}for(Z*=L;;j++){let ct=E[j];if(!(Z>ct)){if(j==0)Z/=ct;else{let lt=E[j-1];Z=j+(Z-lt)/(ct-lt)}break}}this.addCurvePosition(Z*.1,y,b,v,C,_,S,M,T,l,W,i||Y>0&&tt==0)}return l}addBeforePosition(t,e,i,s,r){let o=e[i],l=e[i+1],u=e[i+2]-o,c=e[i+3]-l,f=Math.atan2(c,u);s[r]=o+t*Math.cos(f),s[r+1]=l+t*Math.sin(f),s[r+2]=f}addAfterPosition(t,e,i,s,r){let o=e[i+2],l=e[i+3],u=o-e[i],c=l-e[i+1],f=Math.atan2(c,u);s[r]=o+t*Math.cos(f),s[r+1]=l+t*Math.sin(f),s[r+2]=f}addCurvePosition(t,e,i,s,r,o,l,u,c,f,d,g){if(t==0||isNaN(t)){f[d]=e,f[d+1]=i,f[d+2]=Math.atan2(r-i,s-e);return}let p=t*t,x=p*t,y=1-t,b=y*y,v=b*y,C=y*t,_=C*3,S=y*_,M=_*t,T=e*v+s*S+o*M+u*x,P=i*v+r*S+l*M+c*x;f[d]=T,f[d+1]=P,g&&(t<.001?f[d+2]=Math.atan2(r-i,s-e):f[d+2]=Math.atan2(P-(i*b+r*C*2+l*p),T-(e*b+s*C*2+o*p)))}};A(fi,"NONE",-1),A(fi,"BEFORE",-2),A(fi,"AFTER",-3),A(fi,"epsilon",1e-5);let Qh=fi;class CP{constructor(t,e){A(this,"data");A(this,"_bone",null);A(this,"inertia",0);A(this,"strength",0);A(this,"damping",0);A(this,"massInverse",0);A(this,"wind",0);A(this,"gravity",0);A(this,"mix",0);A(this,"_reset",!0);A(this,"ux",0);A(this,"uy",0);A(this,"cx",0);A(this,"cy",0);A(this,"tx",0);A(this,"ty",0);A(this,"xOffset",0);A(this,"xVelocity",0);A(this,"yOffset",0);A(this,"yVelocity",0);A(this,"rotateOffset",0);A(this,"rotateVelocity",0);A(this,"scaleOffset",0);A(this,"scaleVelocity",0);A(this,"active",!1);A(this,"skeleton");A(this,"remaining",0);A(this,"lastTime",0);this.data=t,this.skeleton=e,this.bone=e.bones[t.bone.index],this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const t=this.data;this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}isActive(){return this.active}update(t){const e=this.mix;if(e==0)return;const i=this.data.x>0,s=this.data.y>0,r=this.data.rotate>0||this.data.shearX>0,o=this.data.scaleX>0,l=this.bone,u=l.data.length;switch(t){case Ys.none:return;case Ys.reset:this.reset();case Ys.update:const c=this.skeleton,f=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=f,this.lastTime=c.time;const d=l.worldX,g=l.worldY;if(this._reset)this._reset=!1,this.ux=d,this.uy=g;else{let p=this.remaining,x=this.inertia,y=this.data.step,b=this.skeleton.data.referenceScale,v=-1,C=this.data.limit*f,_=C*Math.abs(c.scaleY);if(C*=Math.abs(c.scaleX),i||s){if(i){const S=(this.ux-d)*x;this.xOffset+=S>C?C:S<-C?-C:S,this.ux=d}if(s){const S=(this.uy-g)*x;this.yOffset+=S>_?_:S<-_?-_:S,this.uy=g}if(p>=y){v=Math.pow(this.damping,60*y);const S=this.massInverse*y,M=this.strength,T=this.wind*b*c.scaleX,P=this.gravity*b*c.scaleY;do i&&(this.xVelocity+=(T-this.xOffset*M)*S,this.xOffset+=this.xVelocity*y,this.xVelocity*=v),s&&(this.yVelocity-=(P+this.yOffset*M)*S,this.yOffset+=this.yVelocity*y,this.yVelocity*=v),p-=y;while(p>=y)}i&&(l.worldX+=this.xOffset*e*this.data.x),s&&(l.worldY+=this.yOffset*e*this.data.y)}if(r||o){let S=Math.atan2(l.c,l.a),M=0,T=0,P=0,B=this.cx-l.worldX,O=this.cy-l.worldY;if(B>C?B=C:B<-C&&(B=-C),O>_?O=_:O<-_&&(O=-_),r){P=(this.data.rotate+this.data.shearX)*e;let U=Math.atan2(O+this.ty,B+this.tx)-S-this.rotateOffset*P;this.rotateOffset+=(U-Math.ceil(U*ft.invPI2-.5)*ft.PI2)*x,U=this.rotateOffset*P+S,M=Math.cos(U),T=Math.sin(U),o&&(U=u*l.getWorldScaleX(),U>0&&(this.scaleOffset+=(B*M+O*T)*x/U))}else{M=Math.cos(S),T=Math.sin(S);const U=u*l.getWorldScaleX();U>0&&(this.scaleOffset+=(B*M+O*T)*x/U)}if(p=this.remaining,p>=y){v==-1&&(v=Math.pow(this.damping,60*y));const U=this.massInverse*y,N=this.strength,et=this.wind,K=Or.yDown?-this.gravity:this.gravity,V=u/b;for(;;)if(p-=y,o&&(this.scaleVelocity+=(et*M-K*T-this.scaleOffset*N)*U,this.scaleOffset+=this.scaleVelocity*y,this.scaleVelocity*=v),r){if(this.rotateVelocity-=((et*T+K*M)*V+this.rotateOffset*N)*U,this.rotateOffset+=this.rotateVelocity*y,this.rotateVelocity*=v,p<y)break;const J=this.rotateOffset*P+S;M=Math.cos(J),T=Math.sin(J)}else if(p<y)break}}this.remaining=p}this.cx=l.worldX,this.cy=l.worldY;break;case Ys.pose:i&&(l.worldX+=this.xOffset*e*this.data.x),s&&(l.worldY+=this.yOffset*e*this.data.y)}if(r){let c=this.rotateOffset*e,f=0,d=0,g=0;if(this.data.shearX>0){let p=0;this.data.rotate>0&&(p=c*this.data.rotate,f=Math.sin(p),d=Math.cos(p),g=l.b,l.b=d*g-f*l.d,l.d=f*g+d*l.d),p+=c*this.data.shearX,f=Math.sin(p),d=Math.cos(p),g=l.a,l.a=d*g-f*l.c,l.c=f*g+d*l.c}else c*=this.data.rotate,f=Math.sin(c),d=Math.cos(c),g=l.a,l.a=d*g-f*l.c,l.c=f*g+d*l.c,g=l.b,l.b=d*g-f*l.d,l.d=f*g+d*l.d}if(o){const c=1+this.scaleOffset*e*this.data.scaleX;l.a*=c,l.c*=c}t!=Ys.pose&&(this.tx=u*l.a,this.ty=u*l.c),l.updateAppliedTransform()}translate(t,e){this.ux-=t,this.uy-=e,this.cx-=t,this.cy-=e}rotate(t,e,i){const s=i*ft.degRad,r=Math.cos(s),o=Math.sin(s),l=this.cx-t,u=this.cy-e;this.translate(l*r-u*o-l,l*o+u*r-u)}}class TP{constructor(t,e){A(this,"data");A(this,"bone");A(this,"color");A(this,"darkColor",null);A(this,"attachment",null);A(this,"attachmentState",0);A(this,"sequenceIndex",-1);A(this,"deform",new Array);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new kt,this.darkColor=t.darkColor?new kt:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof Xi)||!(this.attachment instanceof Xi)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class MP{constructor(t,e){A(this,"data");A(this,"bones");A(this,"target");A(this,"mixRotate",0);A(this,"mixX",0);A(this,"mixY",0);A(this,"mixScaleX",0);A(this,"mixScaleY",0);A(this,"mixShearY",0);A(this,"temp",new ao);A(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let r=e.findBone(t.bones[s].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(r)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=i,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}update(t){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleY==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,l=e!=0||i!=0,u=this.target,c=u.a,f=u.b,d=u.c,g=u.d,p=c*g-f*d>0?ft.degRad:-.01745329277777778,x=this.data.offsetRotation*p,y=this.data.offsetShearY*p,b=this.bones;for(let v=0,C=b.length;v<C;v++){let _=b[v];if(t!=0){let S=_.a,M=_.b,T=_.c,P=_.d,B=Math.atan2(d,c)-Math.atan2(T,S)+x;B>ft.PI?B-=ft.PI2:B<-3.1415927&&(B+=ft.PI2),B*=t;let O=Math.cos(B),U=Math.sin(B);_.a=O*S-U*T,_.b=O*M-U*P,_.c=U*S+O*T,_.d=U*M+O*P}if(l){let S=this.temp;u.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),_.worldX+=(S.x-_.worldX)*e,_.worldY+=(S.y-_.worldY)*i}if(s!=0){let S=Math.sqrt(_.a*_.a+_.c*_.c);S!=0&&(S=(S+(Math.sqrt(c*c+d*d)-S+this.data.offsetScaleX)*s)/S),_.a*=S,_.c*=S}if(r!=0){let S=Math.sqrt(_.b*_.b+_.d*_.d);S!=0&&(S=(S+(Math.sqrt(f*f+g*g)-S+this.data.offsetScaleY)*r)/S),_.b*=S,_.d*=S}if(o>0){let S=_.b,M=_.d,T=Math.atan2(M,S),P=Math.atan2(g,f)-Math.atan2(d,c)-(T-Math.atan2(_.c,_.a));P>ft.PI?P-=ft.PI2:P<-3.1415927&&(P+=ft.PI2),P=T+(P+y)*o;let B=Math.sqrt(S*S+M*M);_.b=Math.cos(P)*B,_.d=Math.sin(P)*B}_.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,l=e!=0||i!=0,u=this.target,c=u.a,f=u.b,d=u.c,g=u.d,p=c*g-f*d>0?ft.degRad:-.01745329277777778,x=this.data.offsetRotation*p,y=this.data.offsetShearY*p,b=this.bones;for(let v=0,C=b.length;v<C;v++){let _=b[v];if(t!=0){let S=_.a,M=_.b,T=_.c,P=_.d,B=Math.atan2(d,c)+x;B>ft.PI?B-=ft.PI2:B<-3.1415927&&(B+=ft.PI2),B*=t;let O=Math.cos(B),U=Math.sin(B);_.a=O*S-U*T,_.b=O*M-U*P,_.c=U*S+O*T,_.d=U*M+O*P}if(l){let S=this.temp;u.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),_.worldX+=S.x*e,_.worldY+=S.y*i}if(s!=0){let S=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleX)*s+1;_.a*=S,_.c*=S}if(r!=0){let S=(Math.sqrt(f*f+g*g)-1+this.data.offsetScaleY)*r+1;_.b*=S,_.d*=S}if(o>0){let S=Math.atan2(g,f)-Math.atan2(d,c);S>ft.PI?S-=ft.PI2:S<-3.1415927&&(S+=ft.PI2);let M=_.b,T=_.d;S=Math.atan2(T,M)+(S-ft.PI/2+y)*o;let P=Math.sqrt(M*M+T*T);_.b=Math.cos(S)*P,_.d=Math.sin(S)*P}_.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,l=this.target,u=this.bones;for(let c=0,f=u.length;c<f;c++){let d=u[c],g=d.arotation;t!=0&&(g+=(l.arotation-g+this.data.offsetRotation)*t);let p=d.ax,x=d.ay;p+=(l.ax-p+this.data.offsetX)*e,x+=(l.ay-x+this.data.offsetY)*i;let y=d.ascaleX,b=d.ascaleY;s!=0&&y!=0&&(y=(y+(l.ascaleX-y+this.data.offsetScaleX)*s)/y),r!=0&&b!=0&&(b=(b+(l.ascaleY-b+this.data.offsetScaleY)*r)/b);let v=d.ashearY;o!=0&&(v+=(l.ashearY-v+this.data.offsetShearY)*o),d.updateWorldTransformWith(p,x,g,y,b,d.ashearX,v)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,l=this.target,u=this.bones;for(let c=0,f=u.length;c<f;c++){let d=u[c],g=d.arotation+(l.arotation+this.data.offsetRotation)*t,p=d.ax+(l.ax+this.data.offsetX)*e,x=d.ay+(l.ay+this.data.offsetY)*i,y=d.ascaleX*((l.ascaleX-1+this.data.offsetScaleX)*s+1),b=d.ascaleY*((l.ascaleY-1+this.data.offsetScaleY)*r+1),v=d.ashearY+(l.ashearY+this.data.offsetShearY)*o;d.updateWorldTransformWith(p,x,g,y,b,d.ashearX,v)}}}const jn=class jn{constructor(t){A(this,"data");A(this,"bones");A(this,"slots");A(this,"drawOrder");A(this,"ikConstraints");A(this,"transformConstraints");A(this,"pathConstraints");A(this,"physicsConstraints");A(this,"_updateCache",new Array);A(this,"skin",null);A(this,"color");A(this,"scaleX",1);A(this,"_scaleY",1);A(this,"x",0);A(this,"y",0);A(this,"time",0);if(!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let i=t.bones[e],s;if(!i.parent)s=new am(i,this,null);else{let r=this.bones[i.parent.index];s=new am(i,this,r),r.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let i=t.slots[e],s=this.bones[i.boneData.index],r=new TP(i,s);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let i=t.ikConstraints[e];this.ikConstraints.push(new AP(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let i=t.transformConstraints[e];this.transformConstraints.push(new MP(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let i=t.pathConstraints[e];this.pathConstraints.push(new Qh(i,this))}this.physicsConstraints=new Array;for(let e=0;e<t.physicsConstraints.length;e++){let i=t.physicsConstraints[e];this.physicsConstraints.push(new CP(i,this))}this.color=new kt(1,1,1,1),this.updateCache()}get scaleY(){return jn.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}updateCache(){let t=this._updateCache;t.length=0;let e=this.bones;for(let g=0,p=e.length;g<p;g++){let x=e[g];x.sorted=x.data.skinRequired,x.active=!x.sorted}if(this.skin){let g=this.skin.bones;for(let p=0,x=this.skin.bones.length;p<x;p++){let y=this.bones[g[p].index];do y.sorted=!1,y.active=!0,y=y.parent;while(y)}}let i=this.ikConstraints,s=this.transformConstraints,r=this.pathConstraints,o=this.physicsConstraints,l=i.length,u=s.length,c=r.length,f=this.physicsConstraints.length,d=l+u+c+f;t:for(let g=0;g<d;g++){for(let p=0;p<l;p++){let x=i[p];if(x.data.order==g){this.sortIkConstraint(x);continue t}}for(let p=0;p<u;p++){let x=s[p];if(x.data.order==g){this.sortTransformConstraint(x);continue t}}for(let p=0;p<c;p++){let x=r[p];if(x.data.order==g){this.sortPathConstraint(x);continue t}}for(let p=0;p<f;p++){const x=o[p];if(x.data.order==g){this.sortPhysicsConstraint(x);continue t}}}for(let g=0,p=e.length;g<p;g++)this.sortBone(e[g])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&dt.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let i=t.bones,s=i[0];if(this.sortBone(s),i.length==1)this._updateCache.push(t),this.sortReset(s.children);else{let r=i[i.length-1];this.sortBone(r),this._updateCache.push(t),this.sortReset(s.children),r.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&dt.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,i=e.data.index,s=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,i,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,s);for(let u=0,c=this.data.skins.length;u<c;u++)this.sortPathConstraintAttachment(this.data.skins[u],i,s);let r=e.getAttachment();r instanceof ir&&this.sortPathConstraintAttachmentWith(r,s);let o=t.bones,l=o.length;for(let u=0;u<l;u++)this.sortBone(o[u]);this._updateCache.push(t);for(let u=0;u<l;u++)this.sortReset(o[u].children);for(let u=0;u<l;u++)o[u].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&dt.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,i=e.length;if(t.data.local)for(let s=0;s<i;s++){let r=e[s];this.sortBone(r.parent),this.sortBone(r)}else for(let s=0;s<i;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<i;s++)this.sortReset(e[s].children);for(let s=0;s<i;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,i){let s=t.attachments[e];if(s)for(let r in s)this.sortPathConstraintAttachmentWith(s[r],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof ir))return;let i=t.bones;if(!i)this.sortBone(e);else{let s=this.bones;for(let r=0,o=i.length;r<o;){let l=i[r++];for(l+=r;r<l;)this.sortBone(s[i[r++]])}}}sortPhysicsConstraint(t){const e=t.bone;t.active=e.active&&(!t.data.skinRequired||this.skin!=null&&dt.contains(this.skin.constraints,t.data,!0)),t.active&&(this.sortBone(e),this._updateCache.push(t),this.sortReset(e.children),e.sorted=!0)}sortBone(t){if(!t||t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){let s=t[e];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(t){if(t==null)throw new Error("physics is undefined");let e=this.bones;for(let s=0,r=e.length;s<r;s++){let o=e[s];o.ax=o.x,o.ay=o.y,o.arotation=o.rotation,o.ascaleX=o.scaleX,o.ascaleY=o.scaleY,o.ashearX=o.shearX,o.ashearY=o.shearY}let i=this._updateCache;for(let s=0,r=i.length;s<r;s++)i[s].update(t)}updateWorldTransformWith(t,e){if(!e)throw new Error("parent cannot be null.");let i=this.bones;for(let b=1,v=i.length;b<v;b++){let C=i[b];C.ax=C.x,C.ay=C.y,C.arotation=C.rotation,C.ascaleX=C.scaleX,C.ascaleY=C.scaleY,C.ashearX=C.shearX,C.ashearY=C.shearY}let s=this.getRootBone();if(!s)throw new Error("Root bone must not be null.");let r=e.a,o=e.b,l=e.c,u=e.d;s.worldX=r*this.x+o*this.y+e.worldX,s.worldY=l*this.x+u*this.y+e.worldY;const c=(s.rotation+s.shearX)*ft.degRad,f=(s.rotation+90+s.shearY)*ft.degRad,d=Math.cos(c)*s.scaleX,g=Math.cos(f)*s.scaleY,p=Math.sin(c)*s.scaleX,x=Math.sin(f)*s.scaleY;s.a=(r*d+o*p)*this.scaleX,s.b=(r*g+o*x)*this.scaleX,s.c=(l*d+u*p)*this.scaleY,s.d=(l*g+u*x)*this.scaleY;let y=this._updateCache;for(let b=0,v=y.length;b<v;b++){let C=y[b];C!=s&&C.update(t)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const t of this.bones)t.setToSetupPose();for(const t of this.ikConstraints)t.setToSetupPose();for(const t of this.transformConstraints)t.setToSetupPose();for(const t of this.pathConstraints)t.setToSetupPose();for(const t of this.physicsConstraints)t.setToSetupPose()}setSlotsToSetupPose(){let t=this.slots;dt.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.data.name==t)return r}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.data.name==t)return r}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let i=0,s=e.length;i<s;i++){let r=e[i],o=r.data.attachmentName;if(o){let l=t.getAttachment(i,o);l&&r.setAttachment(l)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let i=this.data.findSlot(t);if(!i)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(i.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let i=this.slots;for(let s=0,r=i.length;s<r;s++){let o=i[s];if(o.data.name==t){let l=null;if(e&&(l=this.getAttachment(s,e),!l))throw new Error("Attachment not found: "+e+", for slot: "+t);o.setAttachment(l);return}}throw new Error("Slot not found: "+t)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.ikConstraints.find(e=>e.data.name==t)??null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.transformConstraints.find(e=>e.data.name==t)??null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.pathConstraints.find(e=>e.data.name==t)??null}findPhysicsConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find(e=>e.data.name==t)??null}getBoundsRect(t){let e=new ao,i=new ao;return this.getBounds(e,i,void 0,t),{x:e.x,y:e.y,width:i.x,height:i.y}}getBounds(t,e,i=new Array(2),s=null){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");let r=this.drawOrder,o=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let f=0,d=r.length;f<d;f++){let g=r[f];if(!g.bone.active)continue;let p=0,x=null,y=null,b=g.getAttachment();if(b instanceof Yi)p=8,x=dt.setArraySize(i,p,0),b.computeWorldVertices(g,x,0,2),y=jn.quadTriangles;else if(b instanceof Ni){let v=b;p=v.worldVerticesLength,x=dt.setArraySize(i,p,0),v.computeWorldVertices(g,0,p,x,0,2),y=v.triangles}else if(b instanceof fn&&s!=null){s.clipStart(g,b);continue}if(x&&y){s!=null&&s.isClipping()&&(s.clipTriangles(x,y,y.length),x=s.clippedVertices,p=s.clippedVertices.length);for(let v=0,C=x.length;v<C;v+=2){let _=x[v],S=x[v+1];o=Math.min(o,_),l=Math.min(l,S),u=Math.max(u,_),c=Math.max(c,S)}}s!=null&&s.clipEndWithSlot(g)}s!=null&&s.clipEnd(),t.set(o,l),e.set(u-o,c-l)}update(t){this.time+=t}physicsTranslate(t,e){const i=this.physicsConstraints;for(let s=0,r=i.length;s<r;s++)i[s].translate(t,e)}physicsRotate(t,e,i){const s=this.physicsConstraints;for(let r=0,o=s.length;r<o;r++)s[r].rotate(t,e,i)}};A(jn,"quadTriangles",[0,1,2,2,3,0]),A(jn,"yDown",!1);let Or=jn;var Ys;(function(n){n[n.none=0]="none",n[n.reset=1]="reset",n[n.update=2]="update",n[n.pose=3]="pose"})(Ys||(Ys={}));class F0 extends To{constructor(e){super(e,0,!1);A(this,"_bone",null);A(this,"x",0);A(this,"y",0);A(this,"rotate",0);A(this,"scaleX",0);A(this,"shearX",0);A(this,"limit",0);A(this,"step",0);A(this,"inertia",0);A(this,"strength",0);A(this,"damping",0);A(this,"massInverse",0);A(this,"wind",0);A(this,"gravity",0);A(this,"mix",0);A(this,"inertiaGlobal",!1);A(this,"strengthGlobal",!1);A(this,"dampingGlobal",!1);A(this,"massGlobal",!1);A(this,"windGlobal",!1);A(this,"gravityGlobal",!1);A(this,"mixGlobal",!1)}set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class uo{constructor(){A(this,"name",null);A(this,"bones",new Array);A(this,"slots",new Array);A(this,"skins",new Array);A(this,"defaultSkin",null);A(this,"events",new Array);A(this,"animations",new Array);A(this,"ikConstraints",new Array);A(this,"transformConstraints",new Array);A(this,"pathConstraints",new Array);A(this,"physicsConstraints",new Array);A(this,"x",0);A(this,"y",0);A(this,"width",0);A(this,"height",0);A(this,"referenceScale",100);A(this,"version",null);A(this,"hash",null);A(this,"fps",0);A(this,"imagesPath",null);A(this,"audioPath",null)}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.name==t)return r}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.name==t)return r}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.name==t)return r}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.name==t)return r}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,s=e.length;i<s;i++){let r=e[i];if(r.name==t)return r}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,s=e.length;i<s;i++){const r=e[i];if(r.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,s=e.length;i<s;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++){const r=e[i];if(r.name==t)return r}return null}findPhysicsConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.physicsConstraints;for(let i=0,s=e.length;i<s;i++){const r=e[i];if(r.name==t)return r}return null}}class om{constructor(t=0,e,i){A(this,"slotIndex");A(this,"name");A(this,"attachment");this.slotIndex=t,this.name=e,this.attachment=i}}class Jh{constructor(t){A(this,"name");A(this,"attachments",new Array);A(this,"bones",Array());A(this,"constraints",new Array);A(this,"color",new kt(.99607843,.61960787,.30980393,1));if(!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(!i)throw new Error("attachment cannot be null.");let s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=i}addSkin(t){for(let s=0;s<t.bones.length;s++){let r=t.bones[s],o=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){let r=t.constraints[s],o=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){o=!0;break}o||this.constraints.push(r)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){let r=t.bones[s],o=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<t.constraints.length;s++){let r=t.constraints[s],o=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){o=!0;break}o||this.constraints.push(r)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];i.attachment&&(i.attachment instanceof Ni?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&delete i[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let s in i){let r=i[s];r&&t.push(new om(e,s,r))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let s in i){let r=i[s];r&&e.push(new om(t,s,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let s=0;s<t.slots.length;s++){let r=t.slots[s],o=r.getAttachment();if(o&&i<e.attachments.length){let l=e.attachments[i];for(let u in l){let c=l[u];if(o==c){let f=this.getAttachment(i,u);f&&r.setAttachment(f);break}}}i++}}}class B0{constructor(t,e,i){A(this,"index",0);A(this,"name");A(this,"boneData");A(this,"color",new kt(1,1,1,1));A(this,"darkColor",null);A(this,"attachmentName",null);A(this,"blendMode",Xs.Normal);A(this,"visible",!0);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}var Xs;(function(n){n[n.Normal=0]="Normal",n[n.Additive=1]="Additive",n[n.Multiply=2]="Multiply",n[n.Screen=3]="Screen"})(Xs||(Xs={}));class L0 extends To{constructor(e){super(e,0,!1);A(this,"bones",new Array);A(this,"_target",null);A(this,"mixRotate",0);A(this,"mixX",0);A(this,"mixY",0);A(this,"mixScaleX",0);A(this,"mixScaleY",0);A(this,"mixShearY",0);A(this,"offsetRotation",0);A(this,"offsetX",0);A(this,"offsetY",0);A(this,"offsetScaleX",0);A(this,"offsetScaleY",0);A(this,"offsetShearY",0);A(this,"relative",!1);A(this,"local",!1)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class PP{constructor(t){A(this,"scale",1);A(this,"attachmentLoader");A(this,"linkedMeshes",new Array);this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new uo;i.name="";let s=new IP(t),r=s.readInt32(),o=s.readInt32();i.hash=o==0&&r==0?null:o.toString(16)+r.toString(16),i.version=s.readString(),i.x=s.readFloat(),i.y=s.readFloat(),i.width=s.readFloat(),i.height=s.readFloat(),i.referenceScale=s.readFloat()*e;let l=s.readBoolean();l&&(i.fps=s.readFloat(),i.imagesPath=s.readString(),i.audioPath=s.readString());let u=0;u=s.readInt(!0);for(let f=0;f<u;f++){let d=s.readString();if(!d)throw new Error("String in string table must not be null.");s.strings.push(d)}u=s.readInt(!0);for(let f=0;f<u;f++){let d=s.readString();if(!d)throw new Error("Bone name must not be null.");let g=f==0?null:i.bones[s.readInt(!0)],p=new P0(f,d,g);p.rotation=s.readFloat(),p.x=s.readFloat()*e,p.y=s.readFloat()*e,p.scaleX=s.readFloat(),p.scaleY=s.readFloat(),p.shearX=s.readFloat(),p.shearY=s.readFloat(),p.length=s.readFloat()*e,p.inherit=s.readByte(),p.skinRequired=s.readBoolean(),l&&(kt.rgba8888ToColor(p.color,s.readInt32()),p.icon=s.readString()??void 0,p.visible=s.readBoolean()),i.bones.push(p)}u=s.readInt(!0);for(let f=0;f<u;f++){let d=s.readString();if(!d)throw new Error("Slot name must not be null.");let g=i.bones[s.readInt(!0)],p=new B0(f,d,g);kt.rgba8888ToColor(p.color,s.readInt32());let x=s.readInt32();x!=-1&&kt.rgb888ToColor(p.darkColor=new kt,x),p.attachmentName=s.readStringRef(),p.blendMode=s.readInt(!0),l&&(p.visible=s.readBoolean()),i.slots.push(p)}u=s.readInt(!0);for(let f=0,d;f<u;f++){let g=s.readString();if(!g)throw new Error("IK constraint data name must not be null.");let p=new E0(g);p.order=s.readInt(!0),d=s.readInt(!0);for(let y=0;y<d;y++)p.bones.push(i.bones[s.readInt(!0)]);p.target=i.bones[s.readInt(!0)];let x=s.readByte();p.skinRequired=(x&1)!=0,p.bendDirection=(x&2)!=0?1:-1,p.compress=(x&4)!=0,p.stretch=(x&8)!=0,p.uniform=(x&16)!=0,(x&32)!=0&&(p.mix=(x&64)!=0?s.readFloat():1),(x&128)!=0&&(p.softness=s.readFloat()*e),i.ikConstraints.push(p)}u=s.readInt(!0);for(let f=0,d;f<u;f++){let g=s.readString();if(!g)throw new Error("Transform constraint data name must not be null.");let p=new L0(g);p.order=s.readInt(!0),d=s.readInt(!0);for(let y=0;y<d;y++)p.bones.push(i.bones[s.readInt(!0)]);p.target=i.bones[s.readInt(!0)];let x=s.readByte();p.skinRequired=(x&1)!=0,p.local=(x&2)!=0,p.relative=(x&4)!=0,(x&8)!=0&&(p.offsetRotation=s.readFloat()),(x&16)!=0&&(p.offsetX=s.readFloat()*e),(x&32)!=0&&(p.offsetY=s.readFloat()*e),(x&64)!=0&&(p.offsetScaleX=s.readFloat()),(x&128)!=0&&(p.offsetScaleY=s.readFloat()),x=s.readByte(),(x&1)!=0&&(p.offsetShearY=s.readFloat()),(x&2)!=0&&(p.mixRotate=s.readFloat()),(x&4)!=0&&(p.mixX=s.readFloat()),(x&8)!=0&&(p.mixY=s.readFloat()),(x&16)!=0&&(p.mixScaleX=s.readFloat()),(x&32)!=0&&(p.mixScaleY=s.readFloat()),(x&64)!=0&&(p.mixShearY=s.readFloat()),i.transformConstraints.push(p)}u=s.readInt(!0);for(let f=0,d;f<u;f++){let g=s.readString();if(!g)throw new Error("Path constraint data name must not be null.");let p=new R0(g);p.order=s.readInt(!0),p.skinRequired=s.readBoolean(),d=s.readInt(!0);for(let y=0;y<d;y++)p.bones.push(i.bones[s.readInt(!0)]);p.target=i.slots[s.readInt(!0)];const x=s.readByte();p.positionMode=x&1,p.spacingMode=x>>1&3,p.rotateMode=x>>3&3,(x&128)!=0&&(p.offsetRotation=s.readFloat()),p.position=s.readFloat(),p.positionMode==es.Fixed&&(p.position*=e),p.spacing=s.readFloat(),(p.spacingMode==Me.Length||p.spacingMode==Me.Fixed)&&(p.spacing*=e),p.mixRotate=s.readFloat(),p.mixX=s.readFloat(),p.mixY=s.readFloat(),i.pathConstraints.push(p)}u=s.readInt(!0);for(let f=0,d;f<u;f++){const g=s.readString();if(!g)throw new Error("Physics constraint data name must not be null.");const p=new F0(g);p.order=s.readInt(!0),p.bone=i.bones[s.readInt(!0)];let x=s.readByte();p.skinRequired=(x&1)!=0,(x&2)!=0&&(p.x=s.readFloat()),(x&4)!=0&&(p.y=s.readFloat()),(x&8)!=0&&(p.rotate=s.readFloat()),(x&16)!=0&&(p.scaleX=s.readFloat()),(x&32)!=0&&(p.shearX=s.readFloat()),p.limit=((x&64)!=0?s.readFloat():5e3)*e,p.step=1/s.readUnsignedByte(),p.inertia=s.readFloat(),p.strength=s.readFloat(),p.damping=s.readFloat(),p.massInverse=(x&128)!=0?s.readFloat():1,p.wind=s.readFloat(),p.gravity=s.readFloat(),x=s.readByte(),(x&1)!=0&&(p.inertiaGlobal=!0),(x&2)!=0&&(p.strengthGlobal=!0),(x&4)!=0&&(p.dampingGlobal=!0),(x&8)!=0&&(p.massGlobal=!0),(x&16)!=0&&(p.windGlobal=!0),(x&32)!=0&&(p.gravityGlobal=!0),(x&64)!=0&&(p.mixGlobal=!0),p.mix=(x&128)!=0?s.readFloat():1,i.physicsConstraints.push(p)}let c=this.readSkin(s,i,!0,l);c&&(i.defaultSkin=c,i.skins.push(c));{let f=i.skins.length;for(dt.setArraySize(i.skins,u=f+s.readInt(!0));f<u;f++){let d=this.readSkin(s,i,!1,l);if(!d)throw new Error("readSkin() should not have returned null.");i.skins[f]=d}}u=this.linkedMeshes.length;for(let f=0;f<u;f++){let d=this.linkedMeshes[f];const g=i.skins[d.skinIndex];if(!d.parent)throw new Error("Linked mesh parent must not be null");let p=g.getAttachment(d.slotIndex,d.parent);if(!p)throw new Error(`Parent mesh not found: ${d.parent}`);d.mesh.timelineAttachment=d.inheritTimeline?p:d.mesh,d.mesh.setParentMesh(p),d.mesh.region!=null&&d.mesh.updateRegion()}this.linkedMeshes.length=0,u=s.readInt(!0);for(let f=0;f<u;f++){let d=s.readString();if(!d)throw new Error("Event data name must not be null");let g=new k0(d);g.intValue=s.readInt(!1),g.floatValue=s.readFloat(),g.stringValue=s.readString(),g.audioPath=s.readString(),g.audioPath&&(g.volume=s.readFloat(),g.balance=s.readFloat()),i.events.push(g)}u=s.readInt(!0);for(let f=0;f<u;f++){let d=s.readString();if(!d)throw new Error("Animatio name must not be null.");i.animations.push(this.readAnimation(s,d,i))}return i}readSkin(t,e,i,s){let r=null,o=0;if(i){if(o=t.readInt(!0),o==0)return null;r=new Jh("default")}else{let l=t.readString();if(!l)throw new Error("Skin name must not be null.");r=new Jh(l),s&&kt.rgba8888ToColor(r.color,t.readInt32()),r.bones.length=t.readInt(!0);for(let u=0,c=r.bones.length;u<c;u++)r.bones[u]=e.bones[t.readInt(!0)];for(let u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.pathConstraints[t.readInt(!0)]);for(let u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.physicsConstraints[t.readInt(!0)]);o=t.readInt(!0)}for(let l=0;l<o;l++){let u=t.readInt(!0);for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readStringRef();if(!d)throw new Error("Attachment name must not be null");let g=this.readAttachment(t,e,r,u,d,s);g&&r.setAttachment(u,d,g)}}return r}readAttachment(t,e,i,s,r,o){let l=this.scale,u=t.readByte();const c=(u&8)!=0?t.readStringRef():r;if(!c)throw new Error("Attachment name must not be null");switch(u&7){case xs.Region:{let f=(u&16)!=0?t.readStringRef():null;const d=(u&32)!=0?t.readInt32():4294967295,g=(u&64)!=0?this.readSequence(t):null;let p=(u&128)!=0?t.readFloat():0,x=t.readFloat(),y=t.readFloat(),b=t.readFloat(),v=t.readFloat(),C=t.readFloat(),_=t.readFloat();f||(f=c);let S=this.attachmentLoader.newRegionAttachment(i,c,f,g);return S?(S.path=f,S.x=x*l,S.y=y*l,S.scaleX=b,S.scaleY=v,S.rotation=p,S.width=C*l,S.height=_*l,kt.rgba8888ToColor(S.color,d),S.sequence=g,g==null&&S.updateRegion(),S):null}case xs.BoundingBox:{let f=this.readVertices(t,(u&16)!=0),d=o?t.readInt32():0,g=this.attachmentLoader.newBoundingBoxAttachment(i,c);return g?(g.worldVerticesLength=f.length,g.vertices=f.vertices,g.bones=f.bones,o&&kt.rgba8888ToColor(g.color,d),g):null}case xs.Mesh:{let f=(u&16)!=0?t.readStringRef():c;const d=(u&32)!=0?t.readInt32():4294967295,g=(u&64)!=0?this.readSequence(t):null,p=t.readInt(!0),x=this.readVertices(t,(u&128)!=0),y=this.readFloatArray(t,x.length,1),b=this.readShortArray(t,(x.length-p-2)*3);let v=[],C=0,_=0;o&&(v=this.readShortArray(t,t.readInt(!0)),C=t.readFloat(),_=t.readFloat()),f||(f=c);let S=this.attachmentLoader.newMeshAttachment(i,c,f,g);return S?(S.path=f,kt.rgba8888ToColor(S.color,d),S.bones=x.bones,S.vertices=x.vertices,S.worldVerticesLength=x.length,S.triangles=b,S.regionUVs=y,g==null&&S.updateRegion(),S.hullLength=p<<1,S.sequence=g,o&&(S.edges=v,S.width=C*l,S.height=_*l),S):null}case xs.LinkedMesh:{const f=(u&16)!=0?t.readStringRef():c;if(f==null)throw new Error("Path of linked mesh must not be null");const d=(u&32)!=0?t.readInt32():4294967295,g=(u&64)!=0?this.readSequence(t):null,p=(u&128)!=0,x=t.readInt(!0),y=t.readStringRef();let b=0,v=0;o&&(b=t.readFloat(),v=t.readFloat());let C=this.attachmentLoader.newMeshAttachment(i,c,f,g);return C?(C.path=f,kt.rgba8888ToColor(C.color,d),C.sequence=g,o&&(C.width=b*l,C.height=v*l),this.linkedMeshes.push(new kP(C,x,s,y,p)),C):null}case xs.Path:{const f=(u&16)!=0,d=(u&32)!=0,g=this.readVertices(t,(u&64)!=0),p=dt.newArray(g.length/6,0);for(let b=0,v=p.length;b<v;b++)p[b]=t.readFloat()*l;const x=o?t.readInt32():0,y=this.attachmentLoader.newPathAttachment(i,c);return y?(y.closed=f,y.constantSpeed=d,y.worldVerticesLength=g.length,y.vertices=g.vertices,y.bones=g.bones,y.lengths=p,o&&kt.rgba8888ToColor(y.color,x),y):null}case xs.Point:{const f=t.readFloat(),d=t.readFloat(),g=t.readFloat(),p=o?t.readInt32():0,x=this.attachmentLoader.newPointAttachment(i,c);return x?(x.x=d*l,x.y=g*l,x.rotation=f,o&&kt.rgba8888ToColor(x.color,p),x):null}case xs.Clipping:{const f=t.readInt(!0),d=this.readVertices(t,(u&16)!=0);let g=o?t.readInt32():0,p=this.attachmentLoader.newClippingAttachment(i,c);return p?(p.endSlot=e.slots[f],p.worldVerticesLength=d.length,p.vertices=d.vertices,p.bones=d.bones,o&&kt.rgba8888ToColor(p.color,g),p):null}}return null}readSequence(t){let e=new oo(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readVertices(t,e){const i=this.scale,s=t.readInt(!0),r=new EP;if(r.length=s<<1,!e)return r.vertices=this.readFloatArray(t,r.length,i),r;let o=new Array,l=new Array;for(let u=0;u<s;u++){let c=t.readInt(!0);l.push(c);for(let f=0;f<c;f++)l.push(t.readInt(!0)),o.push(t.readFloat()*i),o.push(t.readFloat()*i),o.push(t.readFloat())}return r.vertices=dt.toFloatArray(o),r.bones=l,r}readFloatArray(t,e,i){let s=new Array(e);if(i==1)for(let r=0;r<e;r++)s[r]=t.readFloat();else for(let r=0;r<e;r++)s[r]=t.readFloat()*i;return s}readShortArray(t,e){let i=new Array(e);for(let s=0;s<e;s++)i[s]=t.readInt(!0);return i}readAnimation(t,e,i){t.readInt(!0);let s=new Array,r=this.scale;for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readInt(!0);for(let g=0,p=t.readInt(!0);g<p;g++){let x=t.readByte(),y=t.readInt(!0),b=y-1;switch(x){case zP:{let v=new $n(y,d);for(let C=0;C<y;C++)v.setFrame(C,t.readFloat(),t.readStringRef());s.push(v);break}case GP:{let v=t.readInt(!0),C=new h0(y,v,d),_=t.readFloat(),S=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255;for(let B=0,O=0;C.setFrame(B,_,S,M,T,P),B!=b;B++){let U=t.readFloat(),N=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255,K=t.readUnsignedByte()/255,V=t.readUnsignedByte()/255;switch(t.readByte()){case Zi:C.setStepped(B);break;case Qi:Xt(t,C,O++,B,0,_,U,S,N,1),Xt(t,C,O++,B,1,_,U,M,et,1),Xt(t,C,O++,B,2,_,U,T,K,1),Xt(t,C,O++,B,3,_,U,P,V,1)}_=U,S=N,M=et,T=K,P=V}s.push(C);break}case VP:{let v=t.readInt(!0),C=new c0(y,v,d),_=t.readFloat(),S=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255;for(let P=0,B=0;C.setFrame(P,_,S,M,T),P!=b;P++){let O=t.readFloat(),U=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255,et=t.readUnsignedByte()/255;switch(t.readByte()){case Zi:C.setStepped(P);break;case Qi:Xt(t,C,B++,P,0,_,O,S,U,1),Xt(t,C,B++,P,1,_,O,M,N,1),Xt(t,C,B++,P,2,_,O,T,et,1)}_=O,S=U,M=N,T=et}s.push(C);break}case $P:{let v=t.readInt(!0),C=new f0(y,v,d),_=t.readFloat(),S=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,U=t.readUnsignedByte()/255;for(let N=0,et=0;C.setFrame(N,_,S,M,T,P,B,O,U),N!=b;N++){let K=t.readFloat(),V=t.readUnsignedByte()/255,J=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,Y=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,q=t.readUnsignedByte()/255;switch(t.readByte()){case Zi:C.setStepped(N);break;case Qi:Xt(t,C,et++,N,0,_,K,S,V,1),Xt(t,C,et++,N,1,_,K,M,J,1),Xt(t,C,et++,N,2,_,K,T,E,1),Xt(t,C,et++,N,3,_,K,P,L,1),Xt(t,C,et++,N,4,_,K,B,Y,1),Xt(t,C,et++,N,5,_,K,O,W,1),Xt(t,C,et++,N,6,_,K,U,q,1)}_=K,S=V,M=J,T=E,P=L,B=Y,O=W,U=q}s.push(C);break}case HP:{let v=t.readInt(!0),C=new d0(y,v,d),_=t.readFloat(),S=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255;for(let U=0,N=0;C.setFrame(U,_,S,M,T,P,B,O),U!=b;U++){let et=t.readFloat(),K=t.readUnsignedByte()/255,V=t.readUnsignedByte()/255,J=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,Y=t.readUnsignedByte()/255;switch(t.readByte()){case Zi:C.setStepped(U);break;case Qi:Xt(t,C,N++,U,0,_,et,S,K,1),Xt(t,C,N++,U,1,_,et,M,V,1),Xt(t,C,N++,U,2,_,et,T,J,1),Xt(t,C,N++,U,3,_,et,P,E,1),Xt(t,C,N++,U,4,_,et,B,L,1),Xt(t,C,N++,U,5,_,et,O,Y,1)}_=et,S=K,M=V,T=J,P=E,B=L,O=Y}s.push(C);break}case qP:{let v=new u0(y,t.readInt(!0),d),C=t.readFloat(),_=t.readUnsignedByte()/255;for(let S=0,M=0;v.setFrame(S,C,_),S!=b;S++){let T=t.readFloat(),P=t.readUnsignedByte()/255;switch(t.readByte()){case Zi:v.setStepped(S);break;case Qi:Xt(t,v,M++,S,0,C,T,_,P,1)}C=T,_=P}s.push(v)}}}}for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readInt(!0);for(let g=0,p=t.readInt(!0);g<p;g++){let x=t.readByte(),y=t.readInt(!0);if(x==WP){let v=new l0(y,d);for(let C=0;C<y;C++)v.setFrame(C,t.readFloat(),t.readByte());s.push(v);continue}let b=t.readInt(!0);switch(x){case RP:s.push(ze(t,new lo(y,b,d),1));break;case FP:s.push(vh(t,new Jg(y,b,d),r));break;case BP:s.push(ze(t,new t0(y,b,d),r));break;case LP:s.push(ze(t,new e0(y,b,d),r));break;case OP:s.push(vh(t,new i0(y,b,d),1));break;case DP:s.push(ze(t,new s0(y,b,d),1));break;case YP:s.push(ze(t,new n0(y,b,d),1));break;case NP:s.push(vh(t,new r0(y,b,d),1));break;case UP:s.push(ze(t,new a0(y,b,d),1));break;case XP:s.push(ze(t,new o0(y,b,d),1))}}}for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readInt(!0),g=t.readInt(!0),p=g-1,x=new m0(g,t.readInt(!0),d),y=t.readByte(),b=t.readFloat(),v=(y&1)!=0?(y&2)!=0?t.readFloat():1:0,C=(y&4)!=0?t.readFloat()*r:0;for(let _=0,S=0;x.setFrame(_,b,v,C,(y&8)!=0?1:-1,(y&16)!=0,(y&32)!=0),_!=p;_++){y=t.readByte();const M=t.readFloat(),T=(y&1)!=0?(y&2)!=0?t.readFloat():1:0,P=(y&4)!=0?t.readFloat()*r:0;(y&64)!=0?x.setStepped(_):(y&128)!=0&&(Xt(t,x,S++,_,0,b,M,v,T,1),Xt(t,x,S++,_,1,b,M,C,P,r)),b=M,v=T,C=P}s.push(x)}for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readInt(!0),g=t.readInt(!0),p=g-1,x=new g0(g,t.readInt(!0),d),y=t.readFloat(),b=t.readFloat(),v=t.readFloat(),C=t.readFloat(),_=t.readFloat(),S=t.readFloat(),M=t.readFloat();for(let T=0,P=0;x.setFrame(T,y,b,v,C,_,S,M),T!=p;T++){let B=t.readFloat(),O=t.readFloat(),U=t.readFloat(),N=t.readFloat(),et=t.readFloat(),K=t.readFloat(),V=t.readFloat();switch(t.readByte()){case Zi:x.setStepped(T);break;case Qi:Xt(t,x,P++,T,0,y,B,b,O,1),Xt(t,x,P++,T,1,y,B,v,U,1),Xt(t,x,P++,T,2,y,B,C,N,1),Xt(t,x,P++,T,3,y,B,_,et,1),Xt(t,x,P++,T,4,y,B,S,K,1),Xt(t,x,P++,T,5,y,B,M,V,1)}y=B,b=O,v=U,C=N,_=et,S=K,M=V}s.push(x)}for(let c=0,f=t.readInt(!0);c<f;c++){let d=t.readInt(!0),g=i.pathConstraints[d];for(let p=0,x=t.readInt(!0);p<x;p++){const y=t.readByte(),b=t.readInt(!0),v=t.readInt(!0);switch(y){case ZP:s.push(ze(t,new x0(b,v,d),g.positionMode==es.Fixed?r:1));break;case QP:s.push(ze(t,new y0(b,v,d),g.spacingMode==Me.Length||g.spacingMode==Me.Fixed?r:1));break;case JP:let C=new b0(b,v,d),_=t.readFloat(),S=t.readFloat(),M=t.readFloat(),T=t.readFloat();for(let P=0,B=0,O=C.getFrameCount()-1;C.setFrame(P,_,S,M,T),P!=O;P++){let U=t.readFloat(),N=t.readFloat(),et=t.readFloat(),K=t.readFloat();switch(t.readByte()){case Zi:C.setStepped(P);break;case Qi:Xt(t,C,B++,P,0,_,U,S,N,1),Xt(t,C,B++,P,1,_,U,M,et,1),Xt(t,C,B++,P,2,_,U,T,K,1)}_=U,S=N,M=et,T=K}s.push(C)}}}for(let c=0,f=t.readInt(!0);c<f;c++){const d=t.readInt(!0)-1;for(let g=0,p=t.readInt(!0);g<p;g++){const x=t.readByte(),y=t.readInt(!0);if(x==oI){const v=new ho(y,d);for(let C=0;C<y;C++)v.setFrame(C,t.readFloat());s.push(v);continue}const b=t.readInt(!0);switch(x){case tI:s.push(ze(t,new _0(y,b,d),1));break;case eI:s.push(ze(t,new w0(y,b,d),1));break;case iI:s.push(ze(t,new v0(y,b,d),1));break;case sI:s.push(ze(t,new S0(y,b,d),1));break;case nI:s.push(ze(t,new A0(y,b,d),1));break;case rI:s.push(ze(t,new C0(y,b,d),1));break;case aI:s.push(ze(t,new T0(y,b,d),1))}}}for(let c=0,f=t.readInt(!0);c<f;c++){let d=i.skins[t.readInt(!0)];for(let g=0,p=t.readInt(!0);g<p;g++){let x=t.readInt(!0);for(let y=0,b=t.readInt(!0);y<b;y++){let v=t.readStringRef();if(!v)throw new Error("attachmentName must not be null.");let C=d.getAttachment(x,v),_=t.readByte(),S=t.readInt(!0),M=S-1;switch(_){case jP:{let T=C,P=T.bones,B=T.vertices,O=P?B.length/3*2:B.length,U=t.readInt(!0),N=new p0(S,U,x,T),et=t.readFloat();for(let K=0,V=0;;K++){let J,E=t.readInt(!0);if(E==0)J=P?dt.newFloatArray(O):B;else{J=dt.newFloatArray(O);let Y=t.readInt(!0);if(E+=Y,r==1)for(let W=Y;W<E;W++)J[W]=t.readFloat();else for(let W=Y;W<E;W++)J[W]=t.readFloat()*r;if(!P)for(let W=0,q=J.length;W<q;W++)J[W]+=B[W]}if(N.setFrame(K,et,J),K==M)break;let L=t.readFloat();switch(t.readByte()){case Zi:N.setStepped(K);break;case Qi:Xt(t,N,V++,K,0,et,L,0,1,1)}et=L}s.push(N);break}case KP:{let T=new co(S,x,C);for(let P=0;P<S;P++){let B=t.readFloat(),O=t.readInt32();T.setFrame(P,B,Qg[O&15],O>>4,t.readFloat())}s.push(T);break}}}}}let o=t.readInt(!0);if(o>0){let c=new un(o),f=i.slots.length;for(let d=0;d<o;d++){let g=t.readFloat(),p=t.readInt(!0),x=dt.newArray(f,0);for(let C=f-1;C>=0;C--)x[C]=-1;let y=dt.newArray(f-p,0),b=0,v=0;for(let C=0;C<p;C++){let _=t.readInt(!0);for(;b!=_;)y[v++]=b++;x[b+t.readInt(!0)]=b++}for(;b<f;)y[v++]=b++;for(let C=f-1;C>=0;C--)x[C]==-1&&(x[C]=y[--v]);c.setFrame(d,g,x)}s.push(c)}let l=t.readInt(!0);if(l>0){let c=new Lr(l);for(let f=0;f<l;f++){let d=t.readFloat(),g=i.events[t.readInt(!0)],p=new I0(d,g);p.intValue=t.readInt(!1),p.floatValue=t.readFloat(),p.stringValue=t.readString(),p.stringValue==null&&(p.stringValue=g.stringValue),p.data.audioPath&&(p.volume=t.readFloat(),p.balance=t.readFloat()),c.setFrame(f,p)}s.push(c)}let u=0;for(let c=0,f=s.length;c<f;c++)u=Math.max(u,s[c].getDuration());return new Ac(e,s,u)}}class IP{constructor(t,e=new Array,i=0,s=new DataView(t instanceof ArrayBuffer?t:t.buffer)){A(this,"strings");A(this,"index");A(this,"buffer");this.strings=e,this.index=i,this.buffer=s}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),i=e&127;return(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<7,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<14,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<21,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<28)))),t?i:i>>>1^-(i&1)}readStringRef(){let t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let i=0;i<t;){let s=this.readUnsignedByte();switch(s>>4){case 12:case 13:e+=String.fromCharCode((s&31)<<6|this.readByte()&63),i+=2;break;case 14:e+=String.fromCharCode((s&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),i+=3;break;default:e+=String.fromCharCode(s),i++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}let kP=class{constructor(t,e,i,s,r){A(this,"parent");A(this,"skinIndex");A(this,"slotIndex");A(this,"mesh");A(this,"inheritTimeline");this.mesh=t,this.skinIndex=e,this.slotIndex=i,this.parent=s,this.inheritTimeline=r}};class EP{constructor(t=null,e=null,i=0){A(this,"bones");A(this,"vertices");A(this,"length");this.bones=t,this.vertices=e,this.length=i}}var xs;(function(n){n[n.Region=0]="Region",n[n.BoundingBox=1]="BoundingBox",n[n.Mesh=2]="Mesh",n[n.LinkedMesh=3]="LinkedMesh",n[n.Path=4]="Path",n[n.Point=5]="Point",n[n.Clipping=6]="Clipping"})(xs||(xs={}));function ze(n,t,e){let i=n.readFloat(),s=n.readFloat()*e;for(let r=0,o=0,l=t.getFrameCount()-1;t.setFrame(r,i,s),r!=l;r++){let u=n.readFloat(),c=n.readFloat()*e;switch(n.readByte()){case Zi:t.setStepped(r);break;case Qi:Xt(n,t,o++,r,0,i,u,s,c,e)}i=u,s=c}return t}function vh(n,t,e){let i=n.readFloat(),s=n.readFloat()*e,r=n.readFloat()*e;for(let o=0,l=0,u=t.getFrameCount()-1;t.setFrame(o,i,s,r),o!=u;o++){let c=n.readFloat(),f=n.readFloat()*e,d=n.readFloat()*e;switch(n.readByte()){case Zi:t.setStepped(o);break;case Qi:Xt(n,t,l++,o,0,i,c,s,f,e),Xt(n,t,l++,o,1,i,c,r,d,e)}i=c,s=f,r=d}return t}function Xt(n,t,e,i,s,r,o,l,u,c){t.setBezier(e,i,s,r,l,n.readFloat(),n.readFloat()*c,n.readFloat(),n.readFloat()*c,o,u)}const RP=0,FP=1,BP=2,LP=3,OP=4,DP=5,YP=6,NP=7,UP=8,XP=9,WP=10,zP=0,GP=1,VP=2,$P=3,HP=4,qP=5,jP=0,KP=1,ZP=0,QP=1,JP=2,tI=0,eI=1,iI=2,sI=4,nI=5,rI=6,aI=7,oI=8,Zi=1,Qi=2;class lI{constructor(){A(this,"minX",0);A(this,"minY",0);A(this,"maxX",0);A(this,"maxY",0);A(this,"boundingBoxes",new Array);A(this,"polygons",new Array);A(this,"polygonPool",new Br(()=>dt.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,s=this.polygons,r=this.polygonPool,o=t.slots,l=o.length;i.length=0,r.freeAll(s),s.length=0;for(let u=0;u<l;u++){let c=o[u];if(!c.bone.active)continue;let f=c.getAttachment();if(f instanceof Co){let d=f;i.push(d);let g=r.obtain();g.length!=d.worldVerticesLength&&(g=dt.newFloatArray(d.worldVerticesLength)),s.push(g),d.computeWorldVertices(c,0,d.worldVerticesLength,g,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,r=this.polygons;for(let o=0,l=r.length;o<l;o++){let u=r[o],c=u;for(let f=0,d=u.length;f<d;f+=2){let g=c[f],p=c[f+1];t=Math.min(t,g),e=Math.min(e,p),i=Math.max(i,g),s=Math.max(s,p)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,s){let r=this.minX,o=this.minY,l=this.maxX,u=this.maxY;if(t<=r&&i<=r||e<=o&&s<=o||t>=l&&i>=l||e>=u&&s>=u)return!1;let c=(s-e)/(i-t),f=c*(r-t)+e;if(f>o&&f<u||(f=c*(l-t)+e,f>o&&f<u))return!0;let d=(o-e)/c+t;return d>r&&d<l||(d=(u-e)/c+t,d>r&&d<l)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let i=this.polygons;for(let s=0,r=i.length;s<r;s++)if(this.containsPointPolygon(i[s],t,e))return this.boundingBoxes[s];return null}containsPointPolygon(t,e,i){let s=t,r=t.length,o=r-2,l=!1;for(let u=0;u<r;u+=2){let c=s[u+1],f=s[o+1];if(c<i&&f>=i||f<i&&c>=i){let d=s[u];d+(i-c)/(f-c)*(s[o]-d)<e&&(l=!l)}o=u}return l}intersectsSegment(t,e,i,s){let r=this.polygons;for(let o=0,l=r.length;o<l;o++)if(this.intersectsSegmentPolygon(r[o],t,e,i,s))return this.boundingBoxes[o];return null}intersectsSegmentPolygon(t,e,i,s,r){let o=t,l=t.length,u=e-s,c=i-r,f=e*r-i*s,d=o[l-2],g=o[l-1];for(let p=0;p<l;p+=2){let x=o[p],y=o[p+1],b=d*y-g*x,v=d-x,C=g-y,_=u*C-c*v,S=(f*v-u*b)/_;if((S>=d&&S<=x||S>=x&&S<=d)&&(S>=e&&S<=s||S>=s&&S<=e)){let M=(f*C-c*b)/_;if((M>=g&&M<=y||M>=y&&M<=g)&&(M>=i&&M<=r||M>=r&&M<=i))return!0}d=x,g=y}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class ei{constructor(){A(this,"convexPolygons",new Array);A(this,"convexPolygonsIndices",new Array);A(this,"indicesArray",new Array);A(this,"isConcaveArray",new Array);A(this,"triangles",new Array);A(this,"polygonPool",new Br(()=>new Array));A(this,"polygonIndicesPool",new Br(()=>new Array))}triangulate(t){let e=t,i=t.length>>1,s=this.indicesArray;s.length=0;for(let l=0;l<i;l++)s[l]=l;let r=this.isConcaveArray;r.length=0;for(let l=0,u=i;l<u;++l)r[l]=ei.isConcave(l,i,e,s);let o=this.triangles;for(o.length=0;i>3;){let l=i-1,u=0,c=1;for(;;){t:if(!r[u]){let g=s[l]<<1,p=s[u]<<1,x=s[c]<<1,y=e[g],b=e[g+1],v=e[p],C=e[p+1],_=e[x],S=e[x+1];for(let M=(c+1)%i;M!=l;M=(M+1)%i){if(!r[M])continue;let T=s[M]<<1,P=e[T],B=e[T+1];if(ei.positiveArea(_,S,y,b,P,B)&&ei.positiveArea(y,b,v,C,P,B)&&ei.positiveArea(v,C,_,S,P,B))break t}break}if(c==0){do{if(!r[u])break;u--}while(u>0);break}l=u,u=c,c=(c+1)%i}o.push(s[(i+u-1)%i]),o.push(s[u]),o.push(s[(u+1)%i]),s.splice(u,1),r.splice(u,1),i--;let f=(i+u-1)%i,d=u==i?0:u;r[f]=ei.isConcave(f,i,e,s),r[d]=ei.isConcave(d,i,e,s)}return i==3&&(o.push(s[2]),o.push(s[0]),o.push(s[1])),o}decompose(t,e){let i=t,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;let r=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(r),r.length=0;let o=this.polygonIndicesPool.obtain();o.length=0;let l=this.polygonPool.obtain();l.length=0;let u=-1,c=0;for(let f=0,d=e.length;f<d;f+=3){let g=e[f]<<1,p=e[f+1]<<1,x=e[f+2]<<1,y=i[g],b=i[g+1],v=i[p],C=i[p+1],_=i[x],S=i[x+1],M=!1;if(u==g){let T=l.length-4,P=ei.winding(l[T],l[T+1],l[T+2],l[T+3],_,S),B=ei.winding(_,S,l[0],l[1],l[2],l[3]);P==c&&B==c&&(l.push(_),l.push(S),o.push(x),M=!0)}M||(l.length>0?(s.push(l),r.push(o)):(this.polygonPool.free(l),this.polygonIndicesPool.free(o)),l=this.polygonPool.obtain(),l.length=0,l.push(y),l.push(b),l.push(v),l.push(C),l.push(_),l.push(S),o=this.polygonIndicesPool.obtain(),o.length=0,o.push(g),o.push(p),o.push(x),c=ei.winding(y,b,v,C,_,S),u=g)}l.length>0&&(s.push(l),r.push(o));for(let f=0,d=s.length;f<d;f++){if(o=r[f],o.length==0)continue;let g=o[0],p=o[o.length-1];l=s[f];let x=l.length-4,y=l[x],b=l[x+1],v=l[x+2],C=l[x+3],_=l[0],S=l[1],M=l[2],T=l[3],P=ei.winding(y,b,v,C,_,S);for(let B=0;B<d;B++){if(B==f)continue;let O=r[B];if(O.length!=3)continue;let U=O[0],N=O[1],et=O[2],K=s[B],V=K[K.length-2],J=K[K.length-1];if(U!=g||N!=p)continue;let E=ei.winding(y,b,v,C,V,J),L=ei.winding(V,J,_,S,M,T);E==P&&L==P&&(K.length=0,O.length=0,l.push(V),l.push(J),o.push(et),y=v,b=C,v=V,C=J,B=0)}}for(let f=s.length-1;f>=0;f--)l=s[f],l.length==0&&(s.splice(f,1),this.polygonPool.free(l),o=r[f],r.splice(f,1),this.polygonIndicesPool.free(o));return s}static isConcave(t,e,i,s){let r=s[(e+t-1)%e]<<1,o=s[t]<<1,l=s[(t+1)%e]<<1;return!this.positiveArea(i[r],i[r+1],i[o],i[o+1],i[l],i[l+1])}static positiveArea(t,e,i,s,r,o){return t*(o-s)+i*(e-o)+r*(s-e)>=0}static winding(t,e,i,s,r,o){let l=i-t,u=s-e;return r*u-o*l+l*e-t*u>=0?1:-1}}class fo{constructor(){A(this,"triangulator",new ei);A(this,"clippingPolygon",new Array);A(this,"clipOutput",new Array);A(this,"clippedVertices",new Array);A(this,"clippedUVs",new Array);A(this,"clippedTriangles",new Array);A(this,"scratch",new Array);A(this,"clipAttachment",null);A(this,"clippingPolygons",null)}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let i=e.worldVerticesLength,s=dt.setArraySize(this.clippingPolygon,i);e.computeWorldVertices(t,0,i,s,0,2);let r=this.clippingPolygon;fo.makeClockwise(r);let o=this.clippingPolygons=this.triangulator.decompose(r,this.triangulator.triangulate(r));for(let l=0,u=o.length;l<u;l++){let c=o[l];fo.makeClockwise(c),c.push(c[0]),c.push(c[1])}return o.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return this.clipAttachment!=null}clipTriangles(t,e,i,s,r,o,l,u){let c,f,d,g,p,x;typeof e=="number"?(c=i,f=s,d=r,g=o,p=l,x=u):(c=e,f=i,d=s,g=r,p=o,x=l),d&&g&&p&&typeof x=="boolean"?this.clipTrianglesRender(t,c,f,d,g,p,x):this.clipTrianglesNoRender(t,c,f)}clipTrianglesNoRender(t,e,i){let s=this.clipOutput,r=this.clippedVertices,o=this.clippedTriangles,l=this.clippingPolygons,u=l.length,c=0;r.length=0,o.length=0;for(let f=0;f<i;f+=3){let d=e[f]<<1,g=t[d],p=t[d+1];d=e[f+1]<<1;let x=t[d],y=t[d+1];d=e[f+2]<<1;let b=t[d],v=t[d+1];for(let C=0;C<u;C++){let _=r.length;if(this.clip(g,p,x,y,b,v,l[C],s)){let S=s.length;if(S==0)continue;let M=S>>1,T=this.clipOutput,P=dt.setArraySize(r,_+M*2);for(let O=0;O<S;O+=2,_+=2){let U=T[O],N=T[O+1];P[_]=U,P[_+1]=N}_=o.length;let B=dt.setArraySize(o,_+3*(M-2));M--;for(let O=1;O<M;O++,_+=3)B[_]=c,B[_+1]=c+O,B[_+2]=c+O+1;c+=M+1}else{let S=dt.setArraySize(r,_+6);S[_]=g,S[_+1]=p,S[_+2]=x,S[_+3]=y,S[_+4]=b,S[_+5]=v,_=o.length;let M=dt.setArraySize(o,_+3);M[_]=c,M[_+1]=c+1,M[_+2]=c+2,c+=3;break}}}}clipTrianglesRender(t,e,i,s,r,o,l){let u=this.clipOutput,c=this.clippedVertices,f=this.clippedTriangles,d=this.clippingPolygons,g=d.length,p=l?12:8,x=0;c.length=0,f.length=0;for(let y=0;y<i;y+=3){let b=e[y]<<1,v=t[b],C=t[b+1],_=s[b],S=s[b+1];b=e[y+1]<<1;let M=t[b],T=t[b+1],P=s[b],B=s[b+1];b=e[y+2]<<1;let O=t[b],U=t[b+1],N=s[b],et=s[b+1];for(let K=0;K<g;K++){let V=c.length;if(this.clip(v,C,M,T,O,U,d[K],u)){let J=u.length;if(J==0)continue;let E=T-U,L=O-M,Y=v-O,W=U-C,q=1/(E*Y+L*(C-U)),j=J>>1,tt=this.clipOutput,Z=dt.setArraySize(c,V+j*p);for(let lt=0;lt<J;lt+=2,V+=p){let Pt=tt[lt],Ct=tt[lt+1];Z[V]=Pt,Z[V+1]=Ct,Z[V+2]=r.r,Z[V+3]=r.g,Z[V+4]=r.b,Z[V+5]=r.a;let gt=Pt-O,It=Ct-U,wt=(E*gt+L*It)*q,ee=(W*gt+Y*It)*q,ie=1-wt-ee;Z[V+6]=_*wt+P*ee+N*ie,Z[V+7]=S*wt+B*ee+et*ie,l&&(Z[V+8]=o.r,Z[V+9]=o.g,Z[V+10]=o.b,Z[V+11]=o.a)}V=f.length;let ct=dt.setArraySize(f,V+3*(j-2));j--;for(let lt=1;lt<j;lt++,V+=3)ct[V]=x,ct[V+1]=x+lt,ct[V+2]=x+lt+1;x+=j+1}else{let J=dt.setArraySize(c,V+3*p);J[V]=v,J[V+1]=C,J[V+2]=r.r,J[V+3]=r.g,J[V+4]=r.b,J[V+5]=r.a,l?(J[V+6]=_,J[V+7]=S,J[V+8]=o.r,J[V+9]=o.g,J[V+10]=o.b,J[V+11]=o.a,J[V+12]=M,J[V+13]=T,J[V+14]=r.r,J[V+15]=r.g,J[V+16]=r.b,J[V+17]=r.a,J[V+18]=P,J[V+19]=B,J[V+20]=o.r,J[V+21]=o.g,J[V+22]=o.b,J[V+23]=o.a,J[V+24]=O,J[V+25]=U,J[V+26]=r.r,J[V+27]=r.g,J[V+28]=r.b,J[V+29]=r.a,J[V+30]=N,J[V+31]=et,J[V+32]=o.r,J[V+33]=o.g,J[V+34]=o.b,J[V+35]=o.a):(J[V+6]=_,J[V+7]=S,J[V+8]=M,J[V+9]=T,J[V+10]=r.r,J[V+11]=r.g,J[V+12]=r.b,J[V+13]=r.a,J[V+14]=P,J[V+15]=B,J[V+16]=O,J[V+17]=U,J[V+18]=r.r,J[V+19]=r.g,J[V+20]=r.b,J[V+21]=r.a,J[V+22]=N,J[V+23]=et),V=f.length;let E=dt.setArraySize(f,V+3);E[V]=x,E[V+1]=x+1,E[V+2]=x+2,x+=3;break}}}}clipTrianglesUnpacked(t,e,i,s){let r=this.clipOutput,o=this.clippedVertices,l=this.clippedUVs,u=this.clippedTriangles,c=this.clippingPolygons,f=c.length,d=0;o.length=0,l.length=0,u.length=0;for(let g=0;g<i;g+=3){let p=e[g]<<1,x=t[p],y=t[p+1],b=s[p],v=s[p+1];p=e[g+1]<<1;let C=t[p],_=t[p+1],S=s[p],M=s[p+1];p=e[g+2]<<1;let T=t[p],P=t[p+1],B=s[p],O=s[p+1];for(let U=0;U<f;U++){let N=o.length;if(this.clip(x,y,C,_,T,P,c[U],r)){let et=r.length;if(et==0)continue;let K=_-P,V=T-C,J=x-T,E=P-y,L=1/(K*J+V*(y-P)),Y=et>>1,W=this.clipOutput,q=dt.setArraySize(o,N+Y*2),j=dt.setArraySize(l,N+Y*2);for(let Z=0;Z<et;Z+=2,N+=2){let ct=W[Z],lt=W[Z+1];q[N]=ct,q[N+1]=lt;let Pt=ct-T,Ct=lt-P,gt=(K*Pt+V*Ct)*L,It=(E*Pt+J*Ct)*L,wt=1-gt-It;j[N]=b*gt+S*It+B*wt,j[N+1]=v*gt+M*It+O*wt}N=u.length;let tt=dt.setArraySize(u,N+3*(Y-2));Y--;for(let Z=1;Z<Y;Z++,N+=3)tt[N]=d,tt[N+1]=d+Z,tt[N+2]=d+Z+1;d+=Y+1}else{let et=dt.setArraySize(o,N+6);et[N]=x,et[N+1]=y,et[N+2]=C,et[N+3]=_,et[N+4]=T,et[N+5]=P;let K=dt.setArraySize(l,N+3*2);K[N]=b,K[N+1]=v,K[N+2]=S,K[N+3]=M,K[N+4]=B,K[N+5]=O,N=u.length;let V=dt.setArraySize(u,N+3);V[N]=d,V[N+1]=d+1,V[N+2]=d+2,d+=3;break}}}}clip(t,e,i,s,r,o,l,u){let c=u,f=!1,d;l.length%4>=2?(d=u,u=this.scratch):d=this.scratch,d.length=0,d.push(t),d.push(e),d.push(i),d.push(s),d.push(r),d.push(o),d.push(t),d.push(e),u.length=0;let g=l.length-4,p=l;for(let x=0;;x+=2){let y=p[x],b=p[x+1],v=y-p[x+2],C=b-p[x+3],_=u.length,S=d;for(let T=0,P=d.length-2;T<P;){let B=S[T],O=S[T+1];T+=2;let U=S[T],N=S[T+1],et=C*(y-U)>v*(b-N),K=C*(y-B)-v*(b-O);if(K>0){if(et){u.push(U),u.push(N);continue}let V=U-B,J=N-O,E=K/(V*C-J*v);if(E>=0&&E<=1)u.push(B+V*E),u.push(O+J*E);else{u.push(U),u.push(N);continue}}else if(et){let V=U-B,J=N-O,E=K/(V*C-J*v);if(E>=0&&E<=1)u.push(B+V*E),u.push(O+J*E),u.push(U),u.push(N);else{u.push(U),u.push(N);continue}}f=!0}if(_==u.length)return c.length=0,!0;if(u.push(u[0]),u.push(u[1]),x==g)break;let M=u;u=d,u.length=0,d=M}if(c!=u){c.length=0;for(let x=0,y=u.length-2;x<y;x++)c[x]=u[x]}else c.length=c.length-2;return f}static makeClockwise(t){let e=t,i=t.length,s=e[i-2]*e[1]-e[0]*e[i-1],r=0,o=0,l=0,u=0;for(let c=0,f=i-3;c<f;c+=2)r=e[c],o=e[c+1],l=e[c+2],u=e[c+3],s+=r*u-l*o;if(!(s<0))for(let c=0,f=i-2,d=i>>1;c<d;c+=2){let g=e[c],p=e[c+1],x=f-c;e[c]=e[x],e[c+1]=e[x+1],e[x]=g,e[x+1]=p}}}class hI{constructor(t){A(this,"attachmentLoader");A(this,"scale",1);A(this,"linkedMeshes",new Array);this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new uo,s=typeof t=="string"?JSON.parse(t):t,r=s.skeleton;if(r&&(i.hash=r.hash,i.version=r.spine,i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height,i.referenceScale=G(r,"referenceScale",100)*e,i.fps=r.fps,i.imagesPath=r.images??null,i.audioPath=r.audio??null),s.bones)for(let o=0;o<s.bones.length;o++){let l=s.bones[o],u=null,c=G(l,"parent",null);c&&(u=i.findBone(c));let f=new P0(i.bones.length,l.name,u);f.length=G(l,"length",0)*e,f.x=G(l,"x",0)*e,f.y=G(l,"y",0)*e,f.rotation=G(l,"rotation",0),f.scaleX=G(l,"scaleX",1),f.scaleY=G(l,"scaleY",1),f.shearX=G(l,"shearX",0),f.shearY=G(l,"shearY",0),f.inherit=dt.enumValue(me,G(l,"inherit","Normal")),f.skinRequired=G(l,"skin",!1);let d=G(l,"color",null);d&&f.color.setFromString(d),i.bones.push(f)}if(s.slots)for(let o=0;o<s.slots.length;o++){let l=s.slots[o],u=l.name,c=i.findBone(l.bone);if(!c)throw new Error(`Couldn't find bone ${l.bone} for slot ${u}`);let f=new B0(i.slots.length,u,c),d=G(l,"color",null);d&&f.color.setFromString(d);let g=G(l,"dark",null);g&&(f.darkColor=kt.fromString(g)),f.attachmentName=G(l,"attachment",null),f.blendMode=dt.enumValue(Xs,G(l,"blend","normal")),f.visible=G(l,"visible",!0),i.slots.push(f)}if(s.ik)for(let o=0;o<s.ik.length;o++){let l=s.ik[o],u=new E0(l.name);u.order=G(l,"order",0),u.skinRequired=G(l,"skin",!1);for(let f=0;f<l.bones.length;f++){let d=i.findBone(l.bones[f]);if(!d)throw new Error(`Couldn't find bone ${l.bones[f]} for IK constraint ${l.name}.`);u.bones.push(d)}let c=i.findBone(l.target);if(!c)throw new Error(`Couldn't find target bone ${l.target} for IK constraint ${l.name}.`);u.target=c,u.mix=G(l,"mix",1),u.softness=G(l,"softness",0)*e,u.bendDirection=G(l,"bendPositive",!0)?1:-1,u.compress=G(l,"compress",!1),u.stretch=G(l,"stretch",!1),u.uniform=G(l,"uniform",!1),i.ikConstraints.push(u)}if(s.transform)for(let o=0;o<s.transform.length;o++){let l=s.transform[o],u=new L0(l.name);u.order=G(l,"order",0),u.skinRequired=G(l,"skin",!1);for(let d=0;d<l.bones.length;d++){let g=l.bones[d],p=i.findBone(g);if(!p)throw new Error(`Couldn't find bone ${g} for transform constraint ${l.name}.`);u.bones.push(p)}let c=l.target,f=i.findBone(c);if(!f)throw new Error(`Couldn't find target bone ${c} for transform constraint ${l.name}.`);u.target=f,u.local=G(l,"local",!1),u.relative=G(l,"relative",!1),u.offsetRotation=G(l,"rotation",0),u.offsetX=G(l,"x",0)*e,u.offsetY=G(l,"y",0)*e,u.offsetScaleX=G(l,"scaleX",0),u.offsetScaleY=G(l,"scaleY",0),u.offsetShearY=G(l,"shearY",0),u.mixRotate=G(l,"mixRotate",1),u.mixX=G(l,"mixX",1),u.mixY=G(l,"mixY",u.mixX),u.mixScaleX=G(l,"mixScaleX",1),u.mixScaleY=G(l,"mixScaleY",u.mixScaleX),u.mixShearY=G(l,"mixShearY",1),i.transformConstraints.push(u)}if(s.path)for(let o=0;o<s.path.length;o++){let l=s.path[o],u=new R0(l.name);u.order=G(l,"order",0),u.skinRequired=G(l,"skin",!1);for(let d=0;d<l.bones.length;d++){let g=l.bones[d],p=i.findBone(g);if(!p)throw new Error(`Couldn't find bone ${g} for path constraint ${l.name}.`);u.bones.push(p)}let c=l.target,f=i.findSlot(c);if(!f)throw new Error(`Couldn't find target slot ${c} for path constraint ${l.name}.`);u.target=f,u.positionMode=dt.enumValue(es,G(l,"positionMode","Percent")),u.spacingMode=dt.enumValue(Me,G(l,"spacingMode","Length")),u.rotateMode=dt.enumValue(dn,G(l,"rotateMode","Tangent")),u.offsetRotation=G(l,"rotation",0),u.position=G(l,"position",0),u.positionMode==es.Fixed&&(u.position*=e),u.spacing=G(l,"spacing",0),(u.spacingMode==Me.Length||u.spacingMode==Me.Fixed)&&(u.spacing*=e),u.mixRotate=G(l,"mixRotate",1),u.mixX=G(l,"mixX",1),u.mixY=G(l,"mixY",u.mixX),i.pathConstraints.push(u)}if(s.physics)for(let o=0;o<s.physics.length;o++){const l=s.physics[o],u=new F0(l.name);u.order=G(l,"order",0),u.skinRequired=G(l,"skin",!1);const c=l.bone,f=i.findBone(c);if(f==null)throw new Error("Physics bone not found: "+c);u.bone=f,u.x=G(l,"x",0),u.y=G(l,"y",0),u.rotate=G(l,"rotate",0),u.scaleX=G(l,"scaleX",0),u.shearX=G(l,"shearX",0),u.limit=G(l,"limit",5e3)*e,u.step=1/G(l,"fps",60),u.inertia=G(l,"inertia",1),u.strength=G(l,"strength",100),u.damping=G(l,"damping",1),u.massInverse=1/G(l,"mass",1),u.wind=G(l,"wind",0),u.gravity=G(l,"gravity",0),u.mix=G(l,"mix",1),u.inertiaGlobal=G(l,"inertiaGlobal",!1),u.strengthGlobal=G(l,"strengthGlobal",!1),u.dampingGlobal=G(l,"dampingGlobal",!1),u.massGlobal=G(l,"massGlobal",!1),u.windGlobal=G(l,"windGlobal",!1),u.gravityGlobal=G(l,"gravityGlobal",!1),u.mixGlobal=G(l,"mixGlobal",!1),i.physicsConstraints.push(u)}if(s.skins)for(let o=0;o<s.skins.length;o++){let l=s.skins[o],u=new Jh(l.name);if(l.bones)for(let c=0;c<l.bones.length;c++){let f=l.bones[c],d=i.findBone(f);if(!d)throw new Error(`Couldn't find bone ${f} for skin ${l.name}.`);u.bones.push(d)}if(l.ik)for(let c=0;c<l.ik.length;c++){let f=l.ik[c],d=i.findIkConstraint(f);if(!d)throw new Error(`Couldn't find IK constraint ${f} for skin ${l.name}.`);u.constraints.push(d)}if(l.transform)for(let c=0;c<l.transform.length;c++){let f=l.transform[c],d=i.findTransformConstraint(f);if(!d)throw new Error(`Couldn't find transform constraint ${f} for skin ${l.name}.`);u.constraints.push(d)}if(l.path)for(let c=0;c<l.path.length;c++){let f=l.path[c],d=i.findPathConstraint(f);if(!d)throw new Error(`Couldn't find path constraint ${f} for skin ${l.name}.`);u.constraints.push(d)}if(l.physics)for(let c=0;c<l.physics.length;c++){let f=l.physics[c],d=i.findPhysicsConstraint(f);if(!d)throw new Error(`Couldn't find physics constraint ${f} for skin ${l.name}.`);u.constraints.push(d)}for(let c in l.attachments){let f=i.findSlot(c);if(!f)throw new Error(`Couldn't find slot ${c} for skin ${l.name}.`);let d=l.attachments[c];for(let g in d){let p=this.readAttachment(d[g],u,f.index,g,i);p&&u.setAttachment(f.index,g,p)}}i.skins.push(u),u.name=="default"&&(i.defaultSkin=u)}for(let o=0,l=this.linkedMeshes.length;o<l;o++){let u=this.linkedMeshes[o],c=u.skin?i.findSkin(u.skin):i.defaultSkin;if(!c)throw new Error(`Skin not found: ${u.skin}`);let f=c.getAttachment(u.slotIndex,u.parent);if(!f)throw new Error(`Parent mesh not found: ${u.parent}`);u.mesh.timelineAttachment=u.inheritTimeline?f:u.mesh,u.mesh.setParentMesh(f),u.mesh.region!=null&&u.mesh.updateRegion()}if(this.linkedMeshes.length=0,s.events)for(let o in s.events){let l=s.events[o],u=new k0(o);u.intValue=G(l,"int",0),u.floatValue=G(l,"float",0),u.stringValue=G(l,"string",""),u.audioPath=G(l,"audio",null),u.audioPath&&(u.volume=G(l,"volume",1),u.balance=G(l,"balance",0)),i.events.push(u)}if(s.animations)for(let o in s.animations){let l=s.animations[o];this.readAnimation(l,o,i)}return i}readAttachment(t,e,i,s,r){let o=this.scale;switch(s=G(t,"name",s),G(t,"type","region")){case"region":{let l=G(t,"path",s),u=this.readSequence(G(t,"sequence",null)),c=this.attachmentLoader.newRegionAttachment(e,s,l,u);if(!c)return null;c.path=l,c.x=G(t,"x",0)*o,c.y=G(t,"y",0)*o,c.scaleX=G(t,"scaleX",1),c.scaleY=G(t,"scaleY",1),c.rotation=G(t,"rotation",0),c.width=t.width*o,c.height=t.height*o,c.sequence=u;let f=G(t,"color",null);return f&&c.color.setFromString(f),c.region!=null&&c.updateRegion(),c}case"boundingbox":{let l=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(!l)return null;this.readVertices(t,l,t.vertexCount<<1);let u=G(t,"color",null);return u&&l.color.setFromString(u),l}case"mesh":case"linkedmesh":{let l=G(t,"path",s),u=this.readSequence(G(t,"sequence",null)),c=this.attachmentLoader.newMeshAttachment(e,s,l,u);if(!c)return null;c.path=l;let f=G(t,"color",null);f&&c.color.setFromString(f),c.width=G(t,"width",0)*o,c.height=G(t,"height",0)*o,c.sequence=u;let d=G(t,"parent",null);if(d)return this.linkedMeshes.push(new cI(c,G(t,"skin",null),i,d,G(t,"timelines",!0))),c;let g=t.uvs;return this.readVertices(t,c,g.length),c.triangles=t.triangles,c.regionUVs=g,c.region!=null&&c.updateRegion(),c.edges=G(t,"edges",null),c.hullLength=G(t,"hull",0)*2,c}case"path":{let l=this.attachmentLoader.newPathAttachment(e,s);if(!l)return null;l.closed=G(t,"closed",!1),l.constantSpeed=G(t,"constantSpeed",!0);let u=t.vertexCount;this.readVertices(t,l,u<<1);let c=dt.newArray(u/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*o;l.lengths=c;let f=G(t,"color",null);return f&&l.color.setFromString(f),l}case"point":{let l=this.attachmentLoader.newPointAttachment(e,s);if(!l)return null;l.x=G(t,"x",0)*o,l.y=G(t,"y",0)*o,l.rotation=G(t,"rotation",0);let u=G(t,"color",null);return u&&l.color.setFromString(u),l}case"clipping":{let l=this.attachmentLoader.newClippingAttachment(e,s);if(!l)return null;let u=G(t,"end",null);u&&(l.endSlot=r.findSlot(u));let c=t.vertexCount;this.readVertices(t,l,c<<1);let f=G(t,"color",null);return f&&l.color.setFromString(f),l}}return null}readSequence(t){if(t==null)return null;let e=new oo(G(t,"count",0));return e.start=G(t,"start",1),e.digits=G(t,"digits",0),e.setupIndex=G(t,"setup",0),e}readVertices(t,e,i){let s=this.scale;e.worldVerticesLength=i;let r=t.vertices;if(i==r.length){let u=dt.toFloatArray(r);if(s!=1)for(let c=0,f=r.length;c<f;c++)u[c]*=s;e.vertices=u;return}let o=new Array,l=new Array;for(let u=0,c=r.length;u<c;){let f=r[u++];l.push(f);for(let d=u+f*4;u<d;u+=4)l.push(r[u]),o.push(r[u+1]*s),o.push(r[u+2]*s),o.push(r[u+3])}e.bones=l,e.vertices=dt.toFloatArray(o)}readAnimation(t,e,i){let s=this.scale,r=new Array;if(t.slots)for(let l in t.slots){let u=t.slots[l],c=i.findSlot(l);if(!c)throw new Error("Slot not found: "+l);let f=c.index;for(let d in u){let g=u[d];if(!g)continue;let p=g.length;if(d=="attachment"){let x=new $n(p,f);for(let y=0;y<p;y++){let b=g[y];x.setFrame(y,G(b,"time",0),G(b,"name",null))}r.push(x)}else if(d=="rgba"){let x=new h0(p,p<<2,f),y=g[0],b=G(y,"time",0),v=kt.fromString(y.color);for(let C=0,_=0;;C++){x.setFrame(C,b,v.r,v.g,v.b,v.a);let S=g[C+1];if(!S){x.shrink(_);break}let M=G(S,"time",0),T=kt.fromString(S.color),P=y.curve;P&&(_=Gt(P,x,_,C,0,b,M,v.r,T.r,1),_=Gt(P,x,_,C,1,b,M,v.g,T.g,1),_=Gt(P,x,_,C,2,b,M,v.b,T.b,1),_=Gt(P,x,_,C,3,b,M,v.a,T.a,1)),b=M,v=T,y=S}r.push(x)}else if(d=="rgb"){let x=new c0(p,p*3,f),y=g[0],b=G(y,"time",0),v=kt.fromString(y.color);for(let C=0,_=0;;C++){x.setFrame(C,b,v.r,v.g,v.b);let S=g[C+1];if(!S){x.shrink(_);break}let M=G(S,"time",0),T=kt.fromString(S.color),P=y.curve;P&&(_=Gt(P,x,_,C,0,b,M,v.r,T.r,1),_=Gt(P,x,_,C,1,b,M,v.g,T.g,1),_=Gt(P,x,_,C,2,b,M,v.b,T.b,1)),b=M,v=T,y=S}r.push(x)}else if(d=="alpha")r.push(Li(g,new u0(p,p,f),0,1));else if(d=="rgba2"){let x=new f0(p,p*7,f),y=g[0],b=G(y,"time",0),v=kt.fromString(y.light),C=kt.fromString(y.dark);for(let _=0,S=0;;_++){x.setFrame(_,b,v.r,v.g,v.b,v.a,C.r,C.g,C.b);let M=g[_+1];if(!M){x.shrink(S);break}let T=G(M,"time",0),P=kt.fromString(M.light),B=kt.fromString(M.dark),O=y.curve;O&&(S=Gt(O,x,S,_,0,b,T,v.r,P.r,1),S=Gt(O,x,S,_,1,b,T,v.g,P.g,1),S=Gt(O,x,S,_,2,b,T,v.b,P.b,1),S=Gt(O,x,S,_,3,b,T,v.a,P.a,1),S=Gt(O,x,S,_,4,b,T,C.r,B.r,1),S=Gt(O,x,S,_,5,b,T,C.g,B.g,1),S=Gt(O,x,S,_,6,b,T,C.b,B.b,1)),b=T,v=P,C=B,y=M}r.push(x)}else if(d=="rgb2"){let x=new d0(p,p*6,f),y=g[0],b=G(y,"time",0),v=kt.fromString(y.light),C=kt.fromString(y.dark);for(let _=0,S=0;;_++){x.setFrame(_,b,v.r,v.g,v.b,C.r,C.g,C.b);let M=g[_+1];if(!M){x.shrink(S);break}let T=G(M,"time",0),P=kt.fromString(M.light),B=kt.fromString(M.dark),O=y.curve;O&&(S=Gt(O,x,S,_,0,b,T,v.r,P.r,1),S=Gt(O,x,S,_,1,b,T,v.g,P.g,1),S=Gt(O,x,S,_,2,b,T,v.b,P.b,1),S=Gt(O,x,S,_,3,b,T,C.r,B.r,1),S=Gt(O,x,S,_,4,b,T,C.g,B.g,1),S=Gt(O,x,S,_,5,b,T,C.b,B.b,1)),b=T,v=P,C=B,y=M}r.push(x)}}}if(t.bones)for(let l in t.bones){let u=t.bones[l],c=i.findBone(l);if(!c)throw new Error("Bone not found: "+l);let f=c.index;for(let d in u){let g=u[d],p=g.length;if(p!=0){if(d==="rotate")r.push(Li(g,new lo(p,p,f),0,1));else if(d==="translate"){let x=new Jg(p,p<<1,f);r.push(Sh(g,x,"x","y",0,s))}else if(d==="translatex"){let x=new t0(p,p,f);r.push(Li(g,x,0,s))}else if(d==="translatey"){let x=new e0(p,p,f);r.push(Li(g,x,0,s))}else if(d==="scale"){let x=new i0(p,p<<1,f);r.push(Sh(g,x,"x","y",1,1))}else if(d==="scalex"){let x=new s0(p,p,f);r.push(Li(g,x,1,1))}else if(d==="scaley"){let x=new n0(p,p,f);r.push(Li(g,x,1,1))}else if(d==="shear"){let x=new r0(p,p<<1,f);r.push(Sh(g,x,"x","y",0,1))}else if(d==="shearx"){let x=new a0(p,p,f);r.push(Li(g,x,0,1))}else if(d==="sheary"){let x=new o0(p,p,f);r.push(Li(g,x,0,1))}else if(d==="inherit"){let x=new l0(p,c.index);for(let y=0;y<g.length;y++){let b=g[y];x.setFrame(y,G(b,"time",0),dt.enumValue(me,G(b,"inherit","Normal")))}r.push(x)}}}}if(t.ik)for(let l in t.ik){let u=t.ik[l],c=u[0];if(!c)continue;let f=i.findIkConstraint(l);if(!f)throw new Error("IK Constraint not found: "+l);let d=i.ikConstraints.indexOf(f),g=new m0(u.length,u.length<<1,d),p=G(c,"time",0),x=G(c,"mix",1),y=G(c,"softness",0)*s;for(let b=0,v=0;;b++){g.setFrame(b,p,x,y,G(c,"bendPositive",!0)?1:-1,G(c,"compress",!1),G(c,"stretch",!1));let C=u[b+1];if(!C){g.shrink(v);break}let _=G(C,"time",0),S=G(C,"mix",1),M=G(C,"softness",0)*s,T=c.curve;T&&(v=Gt(T,g,v,b,0,p,_,x,S,1),v=Gt(T,g,v,b,1,p,_,y,M,s)),p=_,x=S,y=M,c=C}r.push(g)}if(t.transform)for(let l in t.transform){let u=t.transform[l],c=u[0];if(!c)continue;let f=i.findTransformConstraint(l);if(!f)throw new Error("Transform constraint not found: "+l);let d=i.transformConstraints.indexOf(f),g=new g0(u.length,u.length*6,d),p=G(c,"time",0),x=G(c,"mixRotate",1),y=G(c,"mixX",1),b=G(c,"mixY",y),v=G(c,"mixScaleX",1),C=G(c,"mixScaleY",v),_=G(c,"mixShearY",1);for(let S=0,M=0;;S++){g.setFrame(S,p,x,y,b,v,C,_);let T=u[S+1];if(!T){g.shrink(M);break}let P=G(T,"time",0),B=G(T,"mixRotate",1),O=G(T,"mixX",1),U=G(T,"mixY",O),N=G(T,"mixScaleX",1),et=G(T,"mixScaleY",N),K=G(T,"mixShearY",1),V=c.curve;V&&(M=Gt(V,g,M,S,0,p,P,x,B,1),M=Gt(V,g,M,S,1,p,P,y,O,1),M=Gt(V,g,M,S,2,p,P,b,U,1),M=Gt(V,g,M,S,3,p,P,v,N,1),M=Gt(V,g,M,S,4,p,P,C,et,1),M=Gt(V,g,M,S,5,p,P,_,K,1)),p=P,x=B,y=O,b=U,v=N,C=et,v=N,c=T}r.push(g)}if(t.path)for(let l in t.path){let u=t.path[l],c=i.findPathConstraint(l);if(!c)throw new Error("Path constraint not found: "+l);let f=i.pathConstraints.indexOf(c);for(let d in u){let g=u[d],p=g[0];if(!p)continue;let x=g.length;if(d==="position"){let y=new x0(x,x,f);r.push(Li(g,y,0,c.positionMode==es.Fixed?s:1))}else if(d==="spacing"){let y=new y0(x,x,f);r.push(Li(g,y,0,c.spacingMode==Me.Length||c.spacingMode==Me.Fixed?s:1))}else if(d==="mix"){let y=new b0(x,x*3,f),b=G(p,"time",0),v=G(p,"mixRotate",1),C=G(p,"mixX",1),_=G(p,"mixY",C);for(let S=0,M=0;;S++){y.setFrame(S,b,v,C,_);let T=g[S+1];if(!T){y.shrink(M);break}let P=G(T,"time",0),B=G(T,"mixRotate",1),O=G(T,"mixX",1),U=G(T,"mixY",O),N=p.curve;N&&(M=Gt(N,y,M,S,0,b,P,v,B,1),M=Gt(N,y,M,S,1,b,P,C,O,1),M=Gt(N,y,M,S,2,b,P,_,U,1)),b=P,v=B,C=O,_=U,p=T}r.push(y)}}}if(t.physics)for(let l in t.physics){let u=t.physics[l],c=-1;if(l.length>0){let f=i.findPhysicsConstraint(l);if(!f)throw new Error("Physics constraint not found: "+l);c=i.physicsConstraints.indexOf(f)}for(let f in u){let d=u[f],g=d[0];if(!g)continue;let p=d.length;if(f=="reset"){const y=new ho(p,c);for(let b=0;g!=null;g=d[b+1],b++)y.setFrame(b,G(g,"time",0));r.push(y);continue}let x;if(f=="inertia")x=new _0(p,p,c);else if(f=="strength")x=new w0(p,p,c);else if(f=="damping")x=new v0(p,p,c);else if(f=="mass")x=new S0(p,p,c);else if(f=="wind")x=new A0(p,p,c);else if(f=="gravity")x=new C0(p,p,c);else if(f=="mix")x=new T0(p,p,c);else continue;r.push(Li(d,x,0,1))}}if(t.attachments)for(let l in t.attachments){let u=t.attachments[l],c=i.findSkin(l);if(!c)throw new Error("Skin not found: "+l);for(let f in u){let d=u[f],g=i.findSlot(f);if(!g)throw new Error("Slot not found: "+f);let p=g.index;for(let x in d){let y=d[x],b=c.getAttachment(p,x);for(let v in y){let C=y[v],_=C[0];if(_){if(v=="deform"){let S=b.bones,M=b.vertices,T=S?M.length/3*2:M.length,P=new p0(C.length,C.length,p,b),B=G(_,"time",0);for(let O=0,U=0;;O++){let N,et=G(_,"vertices",null);if(!et)N=S?dt.newFloatArray(T):M;else{N=dt.newFloatArray(T);let E=G(_,"offset",0);if(dt.arrayCopy(et,0,N,E,et.length),s!=1)for(let L=E,Y=L+et.length;L<Y;L++)N[L]*=s;if(!S)for(let L=0;L<T;L++)N[L]+=M[L]}P.setFrame(O,B,N);let K=C[O+1];if(!K){P.shrink(U);break}let V=G(K,"time",0),J=_.curve;J&&(U=Gt(J,P,U,O,0,B,V,0,1,1)),B=V,_=K}r.push(P)}else if(v=="sequence"){let S=new co(C.length,p,b),M=0;for(let T=0;T<C.length;T++){let P=G(_,"delay",M),B=G(_,"time",0),O=Ne[G(_,"mode","hold")],U=G(_,"index",0);S.setFrame(T,B,O,U,P),M=P,_=C[T+1]}r.push(S)}}}}}}if(t.drawOrder){let l=new un(t.drawOrder.length),u=i.slots.length,c=0;for(let f=0;f<t.drawOrder.length;f++,c++){let d=t.drawOrder[f],g=null,p=G(d,"offsets",null);if(p){g=dt.newArray(u,-1);let x=dt.newArray(u-p.length,0),y=0,b=0;for(let v=0;v<p.length;v++){let C=p[v],_=i.findSlot(C.slot);if(!_)throw new Error("Slot not found: "+_);let S=_.index;for(;y!=S;)x[b++]=y++;g[y+C.offset]=y++}for(;y<u;)x[b++]=y++;for(let v=u-1;v>=0;v--)g[v]==-1&&(g[v]=x[--b])}l.setFrame(c,G(d,"time",0),g)}r.push(l)}if(t.events){let l=new Lr(t.events.length),u=0;for(let c=0;c<t.events.length;c++,u++){let f=t.events[c],d=i.findEvent(f.name);if(!d)throw new Error("Event not found: "+f.name);let g=new I0(dt.toSinglePrecision(G(f,"time",0)),d);g.intValue=G(f,"int",d.intValue),g.floatValue=G(f,"float",d.floatValue),g.stringValue=G(f,"string",d.stringValue),g.data.audioPath&&(g.volume=G(f,"volume",1),g.balance=G(f,"balance",0)),l.setFrame(u,g)}r.push(l)}let o=0;for(let l=0,u=r.length;l<u;l++)o=Math.max(o,r[l].getDuration());i.animations.push(new Ac(e,r,o))}}class cI{constructor(t,e,i,s,r){A(this,"parent");A(this,"skin");A(this,"slotIndex");A(this,"mesh");A(this,"inheritTimeline");this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=s,this.inheritTimeline=r}}function Li(n,t,e,i){let s=n[0],r=G(s,"time",0),o=G(s,"value",e)*i,l=0;for(let u=0;;u++){t.setFrame(u,r,o);let c=n[u+1];if(!c)return t.shrink(l),t;let f=G(c,"time",0),d=G(c,"value",e)*i;s.curve&&(l=Gt(s.curve,t,l,u,0,r,f,o,d,i)),r=f,o=d,s=c}}function Sh(n,t,e,i,s,r){let o=n[0],l=G(o,"time",0),u=G(o,e,s)*r,c=G(o,i,s)*r,f=0;for(let d=0;;d++){t.setFrame(d,l,u,c);let g=n[d+1];if(!g)return t.shrink(f),t;let p=G(g,"time",0),x=G(g,e,s)*r,y=G(g,i,s)*r,b=o.curve;b&&(f=Gt(b,t,f,d,0,l,p,u,x,r),f=Gt(b,t,f,d,1,l,p,c,y,r)),l=p,u=x,c=y,o=g}}function Gt(n,t,e,i,s,r,o,l,u,c){if(n=="stepped")return t.setStepped(i),e;let f=s<<2,d=n[f],g=n[f+1]*c,p=n[f+2],x=n[f+3]*c;return t.setBezier(e,i,s,r,l,d,g,p,x,o,u),e+1}function G(n,t,e){return n[t]!==void 0?n[t]:e}typeof Math.fround>"u"&&(Math.fround=function(n){return function(t){return n[0]=t,n[0]}}(new Float32Array(1)));const Oi=class Oi extends yP{constructor(e){super(e.resource);A(this,"texture");this.texture=Ot.from(e)}static from(e){return Oi.textureMap.has(e)?Oi.textureMap.get(e):new Oi(e)}setFilters(e,i){const s=this.texture.source.style;s.minFilter=Oi.toPixiTextureFilter(e),s.magFilter=Oi.toPixiTextureFilter(i),this.texture.source.autoGenerateMipmaps=Oi.toPixiMipMap(e),this.texture.source.updateMipmaps()}setWraps(e,i){const s=this.texture.source.style;s.addressModeU=Oi.toPixiTextureWrap(e),s.addressModeV=Oi.toPixiTextureWrap(i)}dispose(){this.texture.destroy()}static toPixiMipMap(e){switch(e){case ke.Nearest:case ke.Linear:return!1;case ke.MipMapNearestLinear:case ke.MipMapNearestNearest:case ke.MipMapLinearLinear:case ke.MipMapLinearNearest:return!0;default:throw new Error(`Unknown texture filter: ${String(e)}`)}}static toPixiTextureFilter(e){switch(e){case ke.Nearest:case ke.MipMapNearestLinear:case ke.MipMapNearestNearest:return"nearest";case ke.Linear:case ke.MipMapLinearLinear:case ke.MipMapLinearNearest:return"linear";default:throw new Error(`Unknown texture filter: ${String(e)}`)}}static toPixiTextureWrap(e){switch(e){case vs.ClampToEdge:return"clamp-to-edge";case vs.MirroredRepeat:return"mirror-repeat";case vs.Repeat:return"repeat";default:throw new Error(`Unknown texture wrap: ${String(e)}`)}}static toPixiBlending(e){switch(e){case Xs.Normal:return"normal";case Xs.Additive:return"add";case Xs.Multiply:return"multiply";case Xs.Screen:return"screen";default:throw new Error(`Unknown blendMode: ${String(e)}`)}}};A(Oi,"textureMap",new Map);let po=Oi;const uI={extension:_t.Asset,resolver:{test:n=>Ti(n,".atlas"),parse:n=>{var e,i;const t=n.split(".");return{resolution:parseFloat(((i=(e=xn.RETINA_PREFIX)==null?void 0:e.exec(n))==null?void 0:i[1])??"1"),format:t[t.length-2],src:n}}},loader:{extension:{type:_t.LoadParser,priority:ss.Normal,name:"spineTextureAtlasLoader"},test(n){return Ti(n,".atlas")},async load(n){return await(await ve.get().fetch(n)).text()},testParse(n,t){const e=Ti(t.src,".atlas"),i=typeof n=="string";return Promise.resolve(e&&i)},unload(n){n.dispose()},async parse(n,t,e){const i=t.data||{};let s=Ue.dirname(t.src);s&&s.lastIndexOf("/")!==s.length-1&&(s+="/");const r=new _P(n);if(i.images instanceof Pi||typeof i.images=="string"){const l=i.images;i.images={},i.images[r.pages[0].name]=l}const o=[];for(const l of r.pages){const u=l.name,c=i!=null&&i.images?i.images[u]:void 0;if(c instanceof Pi)l.setTexture(po.from(c));else{const f=c??Ue.normalize([...s.split(Ue.sep),u].join(Ue.sep)),d={src:so(f,t.src),data:{...i.imageMetadata,alphaMode:l.pma?"premultiplied-alpha":"premultiply-alpha-on-upload"}},g=e.load(d).then(p=>{l.setTexture(po.from(p.source))});o.push(g)}}return await Promise.all(o),r}}};Fe.add(uI);function fI(n){return Object.prototype.hasOwnProperty.call(n,"bones")}function dI(n){return n instanceof Uint8Array}const pI={extension:_t.Asset,loader:{extension:{type:_t.LoadParser,priority:ss.Normal,name:"spineSkeletonLoader"},test(n){return Ti(n,".skel")},async load(n){const t=await ve.get().fetch(n);return new Uint8Array(await t.arrayBuffer())},testParse(n,t){const e=Ti(t.src,".json")&&fI(n),i=Ti(t.src,".skel")&&dI(n);return Promise.resolve(e||i)}}};Fe.add(pI);const mI=new Float32Array(1),gI=new Uint32Array(1);class xI extends xg{constructor(){const e=new gn({data:mI,label:"attribute-batch-buffer",usage:Re.VERTEX|Re.COPY_DST,shrinkToFit:!1}),i=new gn({data:gI,label:"index-batch-buffer",usage:Re.INDEX|Re.COPY_DST,shrinkToFit:!1}),s=7*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:s,offset:0},aUV:{buffer:e,format:"float32x2",stride:s,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:s,offset:4*4},aDarkColor:{buffer:e,format:"unorm8x4",stride:s,offset:5*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:s,offset:6*4}},indexBuffer:i})}}const yI={name:"color-bit",vertex:{header:`
            @in aDarkColor: vec4<f32>;
            @out vDarkColor: vec4<f32>;
        `,main:`
        vDarkColor = aDarkColor;
        `},fragment:{header:`
            @in vDarkColor: vec4<f32>;
        `,end:`

        let alpha = outColor.a * vColor.a;
        let rgb = ((outColor.a - 1.0) * vDarkColor.a + 1.0 - outColor.rgb) * vDarkColor.rgb + outColor.rgb * vColor.rgb;

        finalColor = vec4<f32>(rgb, alpha);

        `}},bI={name:"color-bit",vertex:{header:`
            in vec4 aDarkColor;
            out vec4 vDarkColor;
        `,main:`
            vDarkColor = aDarkColor;
        `},fragment:{header:`
            in vec4 vDarkColor;
        `,end:`

        finalColor.a = outColor.a * vColor.a;
        finalColor.rgb = ((outColor.a - 1.0) * vDarkColor.a + 1.0 - outColor.rgb) * vDarkColor.rgb + outColor.rgb * vColor.rgb;
        `}};class _I extends vo{constructor(t){const e=wg({name:"dark-tint-batch",bits:[Sg,bI,Cg(t),Mg]}),i=_g({name:"dark-tint-batch",bits:[vg,yI,Ag(t),Tg]});super({glProgram:e,gpuProgram:i,resources:{batchSamplers:Pg(t)}})}}let lm=null;const bo=class bo extends mg{constructor(){super(...arguments);A(this,"geometry",new xI);A(this,"shader",lm||(lm=new _I(this.maxTextures)));A(this,"name",bo.extension.name);A(this,"vertexSize",7)}packAttributes(e,i,s,r,o){const l=o<<16|e.roundPixels&65535,u=e.transform,c=u.a,f=u.b,d=u.c,g=u.d,p=u.tx,x=u.ty,{positions:y,uvs:b}=e,v=e.color,C=(v>>24&255)/255,_=Be.shared.setValue(e.darkColor).premultiply(C,!0).toPremultiplied(1,!1),S=e.attributeOffset,M=S+e.attributeSize;for(let T=S;T<M;T++){const P=T*2,B=y[P],O=y[P+1];i[r++]=c*B+d*O+p,i[r++]=g*O+f*B+x,i[r++]=b[P],i[r++]=b[P+1],s[r++]=v,s[r++]=_,s[r++]=l}}packQuadAttributes(e,i,s,r,o){const l=e.texture,u=e.transform,c=u.a,f=u.b,d=u.c,g=u.d,p=u.tx,x=u.ty,y=e.bounds,b=y.maxX,v=y.minX,C=y.maxY,_=y.minY,S=l.uvs,M=e.color,T=e.darkColor,P=o<<16|e.roundPixels&65535;i[r+0]=c*v+d*_+p,i[r+1]=g*_+f*v+x,i[r+2]=S.x0,i[r+3]=S.y0,s[r+4]=M,s[r+5]=T,s[r+6]=P,i[r+7]=c*b+d*_+p,i[r+8]=g*_+f*b+x,i[r+9]=S.x1,i[r+10]=S.y1,s[r+11]=M,s[r+12]=T,s[r+13]=P,i[r+14]=c*b+d*C+p,i[r+15]=g*C+f*b+x,i[r+16]=S.x2,i[r+17]=S.y2,s[r+18]=M,s[r+19]=T,s[r+20]=P,i[r+21]=c*v+d*C+p,i[r+22]=g*C+f*v+x,i[r+23]=S.x3,i[r+24]=S.y3,s[r+25]=M,s[r+26]=T,s[r+27]=P}};A(bo,"extension",{type:[_t.Batcher],name:"darkTint"});let tc=bo;Fe.add(tc);class wI{constructor(){A(this,"indexOffset",0);A(this,"attributeOffset",0);A(this,"indexSize");A(this,"attributeSize");A(this,"batcherName","darkTint");A(this,"topology","triangle-list");A(this,"packAsQuad",!1);A(this,"renderable");A(this,"positions");A(this,"indices");A(this,"uvs");A(this,"roundPixels");A(this,"data");A(this,"blendMode");A(this,"darkTint");A(this,"texture");A(this,"transform");A(this,"_textureId");A(this,"_attributeStart");A(this,"_indexStart");A(this,"_batcher");A(this,"_batch")}get color(){const t=this.data.color,e=this.renderable.groupColor,i=this.renderable.groupAlpha;let s;const r=t.a*i*255;if(e!==16777215){const o=e>>16&255,l=e>>8&255,u=e&255,c=t.r*u,f=t.g*l,d=t.b*o;s=r<<24|d<<16|f<<8|c}else s=r<<24|t.b*255<<16|t.g*255<<8|t.r*255;return s}get darkColor(){const t=this.data.darkColor;return t.b*255<<16|t.g*255<<8|t.r*255}get groupTransform(){return this.renderable.groupTransform}setData(t,e,i,s){if(this.renderable=t,this.transform=t.groupTransform,this.data=e,e.clipped){const r=e.clippedData;this.indexSize=r.indicesCount,this.attributeSize=r.vertexCount,this.positions=r.vertices,this.indices=r.indices,this.uvs=r.uvs}else this.indexSize=e.indices.length,this.attributeSize=e.vertices.length/2,this.positions=e.vertices,this.indices=e.indices,this.uvs=e.uvs;this.texture=e.texture,this.roundPixels=s,this.blendMode=i,this.batcherName=e.darkTint?"darkTint":"default"}}const vI={0:"normal",1:"add",2:"multiply",3:"screen"};class O0{constructor(t){A(this,"renderer");A(this,"gpuSpineData",{});A(this,"_destroyRenderableBound",this.destroyRenderable.bind(this));this.renderer=t}validateRenderable(t){if(t._validateAndTransformAttachments(),t.spineAttachmentsDirty)return!0;if(t.spineTexturesDirty){const e=t.skeleton.drawOrder,i=this.gpuSpineData[t.uid];for(let s=0,r=e.length;s<r;s++){const o=e[s],l=o.getAttachment();if(l instanceof Yi||l instanceof Ni){const u=t._getCachedData(o,l),c=i.slotBatches[u.id],f=u.texture;if(f!==c.texture&&!c._batcher.checkAndUpdateTexture(c,f))return!0}}}return!1}addRenderable(t,e){var l,u;const i=this._getSpineData(t),s=this.renderer.renderPipes.batch,r=t.skeleton.drawOrder,o=this.renderer._roundPixels|t._roundPixels;t._validateAndTransformAttachments(),t.spineAttachmentsDirty=!1,t.spineTexturesDirty=!1;for(let c=0,f=r.length;c<f;c++){const d=r[c],g=d.getAttachment(),p=vI[d.data.blendMode];if(g instanceof Yi||g instanceof Ni){const y=t._getCachedData(d,g),b=(l=i.slotBatches)[u=y.id]||(l[u]=new wI);b.setData(t,y,p,o),y.skipRender||s.addToBatch(b,e)}const x=t._slotsObject[d.data.name];if(x){const y=x.container;y.includeInBuild=!0,fP(y,e,this.renderer),y.includeInBuild=!1}}}updateRenderable(t){var s;const e=this.gpuSpineData[t.uid];t._validateAndTransformAttachments(),t.spineAttachmentsDirty=!1,t.spineTexturesDirty=!1;const i=t.skeleton.drawOrder;for(let r=0,o=i.length;r<o;r++){const l=i[r],u=l.getAttachment();if((u instanceof Yi||u instanceof Ni)&&!t._getCachedData(l,u).skipRender){const f=e.slotBatches[t._getCachedData(l,u).id];(s=f._batcher)==null||s.updateElement(f)}}}destroyRenderable(t){this.gpuSpineData[t.uid]=null,t.off("destroyed",this._destroyRenderableBound)}destroy(){this.gpuSpineData=null,this.renderer=null}_getSpineData(t){return this.gpuSpineData[t.uid]||this._initMeshData(t)}_initMeshData(t){return this.gpuSpineData[t.uid]={slotBatches:{}},t.on("destroyed",this._destroyRenderableBound),this.gpuSpineData[t.uid]}}A(O0,"extension",{type:[_t.WebGLPipes,_t.WebGPUPipes,_t.CanvasPipes],name:"spine"});Fe.add(O0);const Va=new ao;Or.yDown=!0;const Dn=new fo,hm=new Br(()=>new ro);class ec extends fc{constructor(e){e instanceof uo&&(e={skeletonData:e});super();A(this,"batched",!0);A(this,"buildId",0);A(this,"renderPipeId","spine");A(this,"_didSpineUpdate",!1);A(this,"beforeUpdateWorldTransforms",()=>{});A(this,"afterUpdateWorldTransforms",()=>{});A(this,"skeleton");A(this,"state");A(this,"skeletonBounds");A(this,"darkTint",!1);A(this,"_debug");A(this,"_slotsObject",Object.create(null));A(this,"clippingSlotToPixiMasks",Object.create(null));A(this,"spineAttachmentsDirty",!0);A(this,"spineTexturesDirty",!0);A(this,"_lastAttachments",[]);A(this,"_stateChanged",!0);A(this,"attachmentCacheData",[]);A(this,"_autoUpdate",!0);A(this,"_boundsProvider");A(this,"hasNeverUpdated",!0);A(this,"currentClippingSlot");const i=e instanceof uo?e:e.skeletonData;this.skeleton=new Or(i),this.state=new Zh(new xP(i)),this.autoUpdate=(e==null?void 0:e.autoUpdate)??!0,this.darkTint=(e==null?void 0:e.darkTint)===void 0?this.skeleton.slots.some(r=>!!r.data.darkColor):e==null?void 0:e.darkTint;const s=this.skeleton.slots;for(let r=0;r<s.length;r++)this.attachmentCacheData[r]=Object.create(null);this._boundsProvider=e.boundsProvider}getSlotFromRef(e){let i;if(typeof e=="number"?i=this.skeleton.slots[e]:typeof e=="string"?i=this.skeleton.findSlot(e):i=e,!i)throw new Error(`No slot found with the given slot reference: ${e}`);return i}get debug(){return this._debug}set debug(e){this._debug&&this._debug.unregisterSpine(this),e&&e.registerSpine(this),this._debug=e}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e?bs.shared.add(this.internalUpdate,this):bs.shared.remove(this.internalUpdate,this),this._autoUpdate=e}get boundsProvider(){return this._boundsProvider}set boundsProvider(e){this._boundsProvider=e,e&&(this._boundsDirty=!1),this.updateBounds()}update(e){this.internalUpdate(0,e)}internalUpdate(e,i){this._updateAndApplyState(i??bs.shared.deltaMS/1e3)}get bounds(){return this._boundsDirty&&this.updateBounds(),this._bounds}setBonePosition(e,i){const s=e;if(typeof e=="string"&&(e=this.skeleton.findBone(e)),!e)throw Error(`Cant set bone position, bone ${String(s)} not found`);if(Va.set(i.x,i.y),e.parent){const r=e.parent.worldToLocal(Va);e.x=r.x,e.y=-r.y}else e.x=Va.x,e.y=Va.y}getBonePosition(e,i){const s=e;return typeof e=="string"&&(e=this.skeleton.findBone(e)),e?(i||(i={x:0,y:0}),i.x=e.worldX,i.y=e.worldY,i):(console.error(`Cant set bone position! Bone ${String(s)} not found`),i)}_updateAndApplyState(e){this.hasNeverUpdated=!1,this.state.update(e),this.skeleton.update(e);const{skeleton:i}=this;this.state.apply(i),this.beforeUpdateWorldTransforms(this),i.updateWorldTransform(Ys.update),this.afterUpdateWorldTransforms(this),this.updateSlotObjects(),this._stateChanged=!0,this.onViewUpdate()}_validateAndTransformAttachments(){this._stateChanged&&(this._stateChanged=!1,this.validateAttachments(),this.transformAttachments())}validateAttachments(){const e=this.skeleton.drawOrder,i=this._lastAttachments;let s=0,r=!1;for(let o=0;o<e.length;o++){const u=e[o].getAttachment();u&&(u!==i[s]&&(r=!0,i[s]=u),s++)}s!==i.length&&(r=!0,i.length=s),this.spineAttachmentsDirty||(this.spineAttachmentsDirty=r)}updateAndSetPixiMask(e,i){var l,u;const s=e.attachment;if(s&&s instanceof fn){const c=(l=this.clippingSlotToPixiMasks)[u=e.data.name]||(l[u]={slot:e,vertices:new Array});c.maskComputed=!1,this.currentClippingSlot=this.clippingSlotToPixiMasks[e.data.name];return}let r=this.currentClippingSlot,o=this._slotsObject[e.data.name];if(r&&o){let c=r.slot,f=c.attachment,d=r.mask;if(d||(d=hm.obtain(),r.mask=d,this.addChild(d)),!r.maskComputed){r.maskComputed=!0;const g=f.worldVerticesLength,p=r.vertices;f.computeWorldVertices(c,0,g,p,0,2),d.clear().poly(p).stroke({width:0}).fill({alpha:.25})}o.container.mask=d}else o!=null&&o.container.mask&&(o.container.mask=null);if(r&&r.slot.attachment.endSlot==e.data&&(this.currentClippingSlot=void 0),i){for(const c in this.clippingSlotToPixiMasks){const f=this.clippingSlotToPixiMasks[c];(!(f.slot.attachment instanceof fn)||!f.maskComputed)&&f.mask&&(this.removeChild(f.mask),hm.free(f.mask),f.mask=void 0)}this.currentClippingSlot=void 0}}transformAttachments(){var i;const e=this.skeleton.drawOrder;for(let s=0;s<e.length;s++){const r=e[s];this.updateAndSetPixiMask(r,s===e.length-1);const o=r.getAttachment();if(o){if(o instanceof Ni||o instanceof Yi){const l=this._getCachedData(r,o);o instanceof Yi?o.computeWorldVertices(r,l.vertices,0,2):o.computeWorldVertices(r,0,o.worldVerticesLength,l.vertices,0,2),l.uvs.length<o.uvs.length&&(l.uvs=new Float32Array(o.uvs.length)),Gh(o.uvs.buffer,l.uvs.buffer);const c=r.bone.skeleton.color,f=r.color,d=o.color;l.color.set(c.r*f.r*d.r,c.g*f.g*d.g,c.b*f.b*d.b,c.a*f.a*d.a),r.darkColor&&l.darkColor.setFromColor(r.darkColor),l.skipRender=l.clipped=!1;const g=((i=o.region)==null?void 0:i.texture.texture)||Ot.EMPTY;l.texture!==g&&(l.texture=g,this.spineTexturesDirty=!0),Dn.isClipping()&&this.updateClippingData(l)}else if(o instanceof fn){Dn.clipStart(r,o);continue}}Dn.clipEndWithSlot(r)}Dn.clipEnd()}updateClippingData(e){e.clipped=!0,Dn.clipTrianglesUnpacked(e.vertices,e.indices,e.indices.length,e.uvs);const{clippedVertices:i,clippedUVs:s,clippedTriangles:r}=Dn,o=i.length/2,l=r.length;e.clippedData||(e.clippedData={vertices:new Float32Array(o*2),uvs:new Float32Array(o*2),vertexCount:o,indices:new Uint16Array(l),indicesCount:l},this.spineAttachmentsDirty=!0);const u=e.clippedData,c=u.vertexCount!==o||l!==u.indicesCount;e.skipRender=o===0,c&&(this.spineAttachmentsDirty=!0,u.vertexCount<o&&(u.vertices=new Float32Array(o*2),u.uvs=new Float32Array(o*2)),u.indices.length<l&&(u.indices=new Uint16Array(l)));const{vertices:f,uvs:d,indices:g}=u;for(let p=0;p<o;p++)f[p*2]=i[p*2],f[p*2+1]=i[p*2+1],d[p*2]=s[p*2],d[p*2+1]=s[p*2+1];u.vertexCount=o;for(let p=0;p<l;p++)g[p]!==r[p]&&(this.spineAttachmentsDirty=!0,g[p]=r[p]);u.indicesCount=l}updateSlotObjects(){for(const e in this._slotsObject){const i=this._slotsObject[e];i&&this.updateSlotObject(i)}}updateSlotObject(e){const{slot:i,container:s}=e,r=e.followAttachmentTimeline?!!i.attachment:!0;if(s.visible=this.skeleton.drawOrder.includes(i)&&r,s.visible){const o=i.bone;s.position.set(o.worldX,o.worldY),s.scale.x=o.getWorldScaleX(),s.scale.y=o.getWorldScaleY(),s.rotation=o.getWorldRotationX()*Cm,s.alpha=this.skeleton.color.a*i.color.a}}_getCachedData(e,i){return this.attachmentCacheData[e.data.index][i.name]||this.initCachedData(e,i)}initCachedData(e,i){var r,o;let s;return i instanceof Yi?(s=new Float32Array(8),this.attachmentCacheData[e.data.index][i.name]={id:`${e.data.index}-${i.name}`,vertices:s,clipped:!1,indices:[0,1,2,0,2,3],uvs:new Float32Array(i.uvs.length),color:new kt(1,1,1,1),darkColor:new kt(0,0,0,0),darkTint:this.darkTint,skipRender:!1,texture:(r=i.region)==null?void 0:r.texture.texture}):(s=new Float32Array(i.worldVerticesLength),this.attachmentCacheData[e.data.index][i.name]={id:`${e.data.index}-${i.name}`,vertices:s,clipped:!1,indices:i.triangles,uvs:new Float32Array(i.uvs.length),color:new kt(1,1,1,1),darkColor:new kt(0,0,0,0),darkTint:this.darkTint,skipRender:!1,texture:(o=i.region)==null?void 0:o.texture.texture}),this.attachmentCacheData[e.data.index][i.name]}onViewUpdate(){var i;if(this._didViewChangeTick++,this._boundsProvider||(this._boundsDirty=!0),this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this),(i=this.debug)==null||i.renderDebug(this)}addSlotObject(e,i,s){var o;e=this.getSlotFromRef(e);for(const l in this._slotsObject)((o=this._slotsObject[l])==null?void 0:o.container)===i&&this.removeSlotObject(this._slotsObject[l].slot);this.removeSlotObject(e),i.includeInBuild=!1,this.addChild(i);const r={container:i,slot:e,followAttachmentTimeline:(s==null?void 0:s.followAttachmentTimeline)||!1};this._slotsObject[e.data.name]=r,this.updateSlotObject(r)}removeSlotObject(e){var s,r;let i;if(e instanceof sr){for(const o in this._slotsObject)if(((s=this._slotsObject[o])==null?void 0:s.container)===e){this._slotsObject[o]=null,i=e;break}}else{const o=this.getSlotFromRef(e);i=(r=this._slotsObject[o.data.name])==null?void 0:r.container,this._slotsObject[o.data.name]=null}i&&(this.removeChild(i),i.includeInBuild=!0)}removeSlotObjects(){Object.entries(this._slotsObject).forEach(([e,i])=>{i&&i.container.removeFromParent(),delete this._slotsObject[e]})}getSlotObject(e){var i;return e=this.getSlotFromRef(e),(i=this._slotsObject[e.data.name])==null?void 0:i.container}updateBounds(){this._boundsDirty=!1,this.skeletonBounds||(this.skeletonBounds=new lI);const e=this.skeletonBounds;if(e.update(this.skeleton,!0),this._boundsProvider){const i=this._boundsProvider.calculateBounds(this),s=this._bounds;s.clear(),s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height}else if(e.minX===1/0){this.hasNeverUpdated&&(this._updateAndApplyState(0),this._boundsDirty=!1),this._validateAndTransformAttachments();const i=this.skeleton.drawOrder,s=this._bounds;s.clear();for(let r=0;r<i.length;r++){const o=i[r],l=o.getAttachment();if(l&&(l instanceof Yi||l instanceof Ni)){const u=this._getCachedData(o,l);s.addVertexData(u.vertices,0,u.vertices.length)}}}else this._bounds.minX=e.minX,this._bounds.minY=e.minY,this._bounds.maxX=e.maxX,this._bounds.maxY=e.maxY}addBounds(e){e.addBounds(this.bounds)}destroy(e=!1){super.destroy(e),bs.shared.remove(this.internalUpdate,this),this.state.clearListeners(),this.debug=void 0,this.skeleton=null,this.state=null,this._slotsObject=null,this._lastAttachments.length=0,this.attachmentCacheData=null}skeletonToPixiWorldCoordinates(e){this.worldTransform.apply(e,e)}pixiWorldCoordinatesToSkeleton(e){this.worldTransform.applyInverse(e,e)}pixiWorldCoordinatesToBone(e,i){this.pixiWorldCoordinatesToSkeleton(e),i.parent?i.parent.worldToLocal(e):i.worldToLocal(e)}static from({skeleton:e,atlas:i,scale:s=1,darkTint:r,autoUpdate:o=!0,boundsProvider:l}){const u=`${e}-${i}-${s}`;if(he.has(u))return new ec({skeletonData:he.get(u),darkTint:r,autoUpdate:o,boundsProvider:l});const c=Vn.get(e),f=Vn.get(i),d=new SP(f),g=c instanceof Uint8Array?new PP(d):new hI(d);g.scale=s;const p=g.readSkeletonData(c);return he.set(u,p),new ec({skeletonData:p,darkTint:r,autoUpdate:o,boundsProvider:l})}}var Ah={exports:{}},cm;function SI(){return cm||(cm=1,function(n){(function(){function t(F,z,ot){return F.call.apply(F.bind,arguments)}function e(F,z,ot){if(!F)throw Error();if(2<arguments.length){var st=Array.prototype.slice.call(arguments,2);return function(){var ut=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ut,st),F.apply(z,ut)}}return function(){return F.apply(z,arguments)}}function i(F,z,ot){return i=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?t:e,i.apply(null,arguments)}var s=Date.now||function(){return+new Date};function r(F,z){this.a=F,this.o=z||F,this.c=this.o.document}var o=!!window.FontFace;function l(F,z,ot,st){if(z=F.c.createElement(z),ot)for(var ut in ot)ot.hasOwnProperty(ut)&&(ut=="style"?z.style.cssText=ot[ut]:z.setAttribute(ut,ot[ut]));return st&&z.appendChild(F.c.createTextNode(st)),z}function u(F,z,ot){F=F.c.getElementsByTagName(z)[0],F||(F=document.documentElement),F.insertBefore(ot,F.lastChild)}function c(F){F.parentNode&&F.parentNode.removeChild(F)}function f(F,z,ot){z=z||[],ot=ot||[];for(var st=F.className.split(/\s+/),ut=0;ut<z.length;ut+=1){for(var xt=!1,vt=0;vt<st.length;vt+=1)if(z[ut]===st[vt]){xt=!0;break}xt||st.push(z[ut])}for(z=[],ut=0;ut<st.length;ut+=1){for(xt=!1,vt=0;vt<ot.length;vt+=1)if(st[ut]===ot[vt]){xt=!0;break}xt||z.push(st[ut])}F.className=z.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function d(F,z){for(var ot=F.className.split(/\s+/),st=0,ut=ot.length;st<ut;st++)if(ot[st]==z)return!0;return!1}function g(F){return F.o.location.hostname||F.a.location.hostname}function p(F,z,ot){function st(){$t&&ut&&xt&&($t(vt),$t=null)}z=l(F,"link",{rel:"stylesheet",href:z,media:"all"});var ut=!1,xt=!0,vt=null,$t=ot||null;o?(z.onload=function(){ut=!0,st()},z.onerror=function(){ut=!0,vt=Error("Stylesheet failed to load"),st()}):setTimeout(function(){ut=!0,st()},0),u(F,"head",z)}function x(F,z,ot,st){var ut=F.c.getElementsByTagName("head")[0];if(ut){var xt=l(F,"script",{src:z}),vt=!1;return xt.onload=xt.onreadystatechange=function(){vt||this.readyState&&this.readyState!="loaded"&&this.readyState!="complete"||(vt=!0,ot&&ot(null),xt.onload=xt.onreadystatechange=null,xt.parentNode.tagName=="HEAD"&&ut.removeChild(xt))},ut.appendChild(xt),setTimeout(function(){vt||(vt=!0,ot&&ot(Error("Script load timeout")))},st||5e3),xt}return null}function y(){this.a=0,this.c=null}function b(F){return F.a++,function(){F.a--,C(F)}}function v(F,z){F.c=z,C(F)}function C(F){F.a==0&&F.c&&(F.c(),F.c=null)}function _(F){this.a=F||"-"}_.prototype.c=function(F){for(var z=[],ot=0;ot<arguments.length;ot++)z.push(arguments[ot].replace(/[\W_]+/g,"").toLowerCase());return z.join(this.a)};function S(F,z){this.c=F,this.f=4,this.a="n";var ot=(z||"n4").match(/^([nio])([1-9])$/i);ot&&(this.a=ot[1],this.f=parseInt(ot[2],10))}function M(F){return B(F)+" "+(F.f+"00")+" 300px "+T(F.c)}function T(F){var z=[];F=F.split(/,\s*/);for(var ot=0;ot<F.length;ot++){var st=F[ot].replace(/['"]/g,"");st.indexOf(" ")!=-1||/^\d/.test(st)?z.push("'"+st+"'"):z.push(st)}return z.join(",")}function P(F){return F.a+F.f}function B(F){var z="normal";return F.a==="o"?z="oblique":F.a==="i"&&(z="italic"),z}function O(F){var z=4,ot="n",st=null;return F&&((st=F.match(/(normal|oblique|italic)/i))&&st[1]&&(ot=st[1].substr(0,1).toLowerCase()),(st=F.match(/([1-9]00|normal|bold)/i))&&st[1]&&(/bold/i.test(st[1])?z=7:/[1-9]00/.test(st[1])&&(z=parseInt(st[1].substr(0,1),10)))),ot+z}function U(F,z){this.c=F,this.f=F.o.document.documentElement,this.h=z,this.a=new _("-"),this.j=z.events!==!1,this.g=z.classes!==!1}function N(F){F.g&&f(F.f,[F.a.c("wf","loading")]),K(F,"loading")}function et(F){if(F.g){var z=d(F.f,F.a.c("wf","active")),ot=[],st=[F.a.c("wf","loading")];z||ot.push(F.a.c("wf","inactive")),f(F.f,ot,st)}K(F,"inactive")}function K(F,z,ot){F.j&&F.h[z]&&(ot?F.h[z](ot.c,P(ot)):F.h[z]())}function V(){this.c={}}function J(F,z,ot){var st=[],ut;for(ut in z)if(z.hasOwnProperty(ut)){var xt=F.c[ut];xt&&st.push(xt(z[ut],ot))}return st}function E(F,z){this.c=F,this.f=z,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function L(F){u(F.c,"body",F.a)}function Y(F){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+T(F.c)+";"+("font-style:"+B(F)+";font-weight:"+(F.f+"00")+";")}function W(F,z,ot,st,ut,xt){this.g=F,this.j=z,this.a=st,this.c=ot,this.f=ut||3e3,this.h=xt||void 0}W.prototype.start=function(){var F=this.c.o.document,z=this,ot=s(),st=new Promise(function(vt,$t){function Ht(){s()-ot>=z.f?$t():F.fonts.load(M(z.a),z.h).then(function(re){1<=re.length?vt():setTimeout(Ht,25)},function(){$t()})}Ht()}),ut=null,xt=new Promise(function(vt,$t){ut=setTimeout($t,z.f)});Promise.race([xt,st]).then(function(){ut&&(clearTimeout(ut),ut=null),z.g(z.a)},function(){z.j(z.a)})};function q(F,z,ot,st,ut,xt,vt){this.v=F,this.B=z,this.c=ot,this.a=st,this.s=vt||"BESbswy",this.f={},this.w=ut||3e3,this.u=xt||null,this.m=this.j=this.h=this.g=null,this.g=new E(this.c,this.s),this.h=new E(this.c,this.s),this.j=new E(this.c,this.s),this.m=new E(this.c,this.s),F=new S(this.a.c+",serif",P(this.a)),F=Y(F),this.g.a.style.cssText=F,F=new S(this.a.c+",sans-serif",P(this.a)),F=Y(F),this.h.a.style.cssText=F,F=new S("serif",P(this.a)),F=Y(F),this.j.a.style.cssText=F,F=new S("sans-serif",P(this.a)),F=Y(F),this.m.a.style.cssText=F,L(this.g),L(this.h),L(this.j),L(this.m)}var j={D:"serif",C:"sans-serif"},tt=null;function Z(){if(tt===null){var F=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);tt=!!F&&(536>parseInt(F[1],10)||parseInt(F[1],10)===536&&11>=parseInt(F[2],10))}return tt}q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=s(),lt(this)};function ct(F,z,ot){for(var st in j)if(j.hasOwnProperty(st)&&z===F.f[j[st]]&&ot===F.f[j[st]])return!0;return!1}function lt(F){var z=F.g.a.offsetWidth,ot=F.h.a.offsetWidth,st;(st=z===F.f.serif&&ot===F.f["sans-serif"])||(st=Z()&&ct(F,z,ot)),st?s()-F.A>=F.w?Z()&&ct(F,z,ot)&&(F.u===null||F.u.hasOwnProperty(F.a.c))?Ct(F,F.v):Ct(F,F.B):Pt(F):Ct(F,F.v)}function Pt(F){setTimeout(i(function(){lt(this)},F),50)}function Ct(F,z){setTimeout(i(function(){c(this.g.a),c(this.h.a),c(this.j.a),c(this.m.a),z(this.a)},F),0)}function gt(F,z,ot){this.c=F,this.a=z,this.f=0,this.m=this.j=!1,this.s=ot}var It=null;gt.prototype.g=function(F){var z=this.a;z.g&&f(z.f,[z.a.c("wf",F.c,P(F).toString(),"active")],[z.a.c("wf",F.c,P(F).toString(),"loading"),z.a.c("wf",F.c,P(F).toString(),"inactive")]),K(z,"fontactive",F),this.m=!0,wt(this)},gt.prototype.h=function(F){var z=this.a;if(z.g){var ot=d(z.f,z.a.c("wf",F.c,P(F).toString(),"active")),st=[],ut=[z.a.c("wf",F.c,P(F).toString(),"loading")];ot||st.push(z.a.c("wf",F.c,P(F).toString(),"inactive")),f(z.f,st,ut)}K(z,"fontinactive",F),wt(this)};function wt(F){--F.f==0&&F.j&&(F.m?(F=F.a,F.g&&f(F.f,[F.a.c("wf","active")],[F.a.c("wf","loading"),F.a.c("wf","inactive")]),K(F,"active")):et(F.a))}function ee(F){this.j=F,this.a=new V,this.h=0,this.f=this.g=!0}ee.prototype.load=function(F){this.c=new r(this.j,F.context||this.j),this.g=F.events!==!1,this.f=F.classes!==!1,Pe(this,new U(this.c,F),F)};function ie(F,z,ot,st,ut){var xt=--F.h==0;(F.f||F.g)&&setTimeout(function(){var vt=ut||null,$t=st||null||{};if(ot.length===0&&xt)et(z.a);else{z.f+=ot.length,xt&&(z.j=xt);var Ht,re=[];for(Ht=0;Ht<ot.length;Ht++){var ae=ot[Ht],Oe=$t[ae.c],si=z.a,Ts=ae;if(si.g&&f(si.f,[si.a.c("wf",Ts.c,P(Ts).toString(),"loading")]),K(si,"fontloading",Ts),si=null,It===null)if(window.FontFace){var Ts=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),Io=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);It=Ts?42<parseInt(Ts[1],10):!Io}else It=!1;It?si=new W(i(z.g,z),i(z.h,z),z.c,ae,z.s,Oe):si=new q(i(z.g,z),i(z.h,z),z.c,ae,z.s,vt,Oe),re.push(si)}for(Ht=0;Ht<re.length;Ht++)re[Ht].start()}},0)}function Pe(F,z,ot){var ut=[],st=ot.timeout;N(z);var ut=J(F.a,ot,F.c),xt=new gt(F.c,z,st);for(F.h=ut.length,z=0,ot=ut.length;z<ot;z++)ut[z].load(function(vt,$t,Ht){ie(F,xt,vt,$t,Ht)})}function Kt(F,z){this.c=F,this.a=z}Kt.prototype.load=function(F){function z(){if(xt["__mti_fntLst"+st]){var vt=xt["__mti_fntLst"+st](),$t=[],Ht;if(vt)for(var re=0;re<vt.length;re++){var ae=vt[re].fontfamily;vt[re].fontStyle!=null&&vt[re].fontWeight!=null?(Ht=vt[re].fontStyle+vt[re].fontWeight,$t.push(new S(ae,Ht))):$t.push(new S(ae))}F($t)}else setTimeout(function(){z()},50)}var ot=this,st=ot.a.projectId,ut=ot.a.version;if(st){var xt=ot.c.o;x(this.c,(ot.a.api||"https://fast.fonts.net/jsapi")+"/"+st+".js"+(ut?"?v="+ut:""),function(vt){vt?F([]):(xt["__MonotypeConfiguration__"+st]=function(){return ot.a},z())}).id="__MonotypeAPIScript__"+st}else F([])};function St(F,z){this.c=F,this.a=z}St.prototype.load=function(F){var z,ot,st=this.a.urls||[],ut=this.a.families||[],xt=this.a.testStrings||{},vt=new y;for(z=0,ot=st.length;z<ot;z++)p(this.c,st[z],b(vt));var $t=[];for(z=0,ot=ut.length;z<ot;z++)if(st=ut[z].split(":"),st[1])for(var Ht=st[1].split(","),re=0;re<Ht.length;re+=1)$t.push(new S(st[0],Ht[re]));else $t.push(new S(st[0]));v(vt,function(){F($t,xt)})};function Dt(F,z){F?this.c=F:this.c=Le,this.a=[],this.f=[],this.g=z||""}var Le="https://fonts.googleapis.com/css";function Ii(F,z){for(var ot=z.length,st=0;st<ot;st++){var ut=z[st].split(":");ut.length==3&&F.f.push(ut.pop());var xt="";ut.length==2&&ut[1]!=""&&(xt=":"),F.a.push(ut.join(xt))}}function As(F){if(F.a.length==0)throw Error("No fonts to load!");if(F.c.indexOf("kit=")!=-1)return F.c;for(var z=F.a.length,ot=[],st=0;st<z;st++)ot.push(F.a[st].replace(/ /g,"+"));return z=F.c+"?family="+ot.join("%7C"),0<F.f.length&&(z+="&subset="+F.f.join(",")),0<F.g.length&&(z+="&text="+encodeURIComponent(F.g)),z}function Vi(F){this.f=F,this.a=[],this.c={}}var be={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},ii={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},rs={i:"i",italic:"i",n:"n",normal:"n"},Cs=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Vs(F){for(var z=F.f.length,ot=0;ot<z;ot++){var st=F.f[ot].split(":"),ut=st[0].replace(/\+/g," "),xt=["n4"];if(2<=st.length){var vt,$t=st[1];if(vt=[],$t)for(var $t=$t.split(","),Ht=$t.length,re=0;re<Ht;re++){var ae;if(ae=$t[re],ae.match(/^[\w-]+$/)){var Oe=Cs.exec(ae.toLowerCase());if(Oe==null)ae="";else{if(ae=Oe[2],ae=ae==null||ae==""?"n":rs[ae],Oe=Oe[1],Oe==null||Oe=="")Oe="4";else var si=ii[Oe],Oe=si||(isNaN(Oe)?"4":Oe.substr(0,1));ae=[ae,Oe].join("")}}else ae="";ae&&vt.push(ae)}0<vt.length&&(xt=vt),st.length==3&&(st=st[2],vt=[],st=st?st.split(","):vt,0<st.length&&(st=be[st[0]])&&(F.c[ut]=st))}for(F.c[ut]||(st=be[ut])&&(F.c[ut]=st),st=0;st<xt.length;st+=1)F.a.push(new S(ut,xt[st]))}}function Xr(F,z){this.c=F,this.a=z}var $s={Arimo:!0,Cousine:!0,Tinos:!0};Xr.prototype.load=function(F){var z=new y,ot=this.c,st=new Dt(this.a.api,this.a.text),ut=this.a.families;Ii(st,ut);var xt=new Vi(ut);Vs(xt),p(ot,As(st),b(z)),v(z,function(){F(xt.a,xt.c,$s)})};function as(F,z){this.c=F,this.a=z}as.prototype.load=function(F){var z=this.a.id,ot=this.c.o;z?x(this.c,(this.a.api||"https://use.typekit.net")+"/"+z+".js",function(st){if(st)F([]);else if(ot.Typekit&&ot.Typekit.config&&ot.Typekit.config.fn){st=ot.Typekit.config.fn;for(var ut=[],xt=0;xt<st.length;xt+=2)for(var vt=st[xt],$t=st[xt+1],Ht=0;Ht<$t.length;Ht++)ut.push(new S(vt,$t[Ht]));try{ot.Typekit.load({events:!1,classes:!1,async:!0})}catch{}F(ut)}},2e3):F([])};function bn(F,z){this.c=F,this.f=z,this.a=[]}bn.prototype.load=function(F){var z=this.f.id,ot=this.c.o,st=this;z?(ot.__webfontfontdeckmodule__||(ot.__webfontfontdeckmodule__={}),ot.__webfontfontdeckmodule__[z]=function(ut,xt){for(var vt=0,$t=xt.fonts.length;vt<$t;++vt){var Ht=xt.fonts[vt];st.a.push(new S(Ht.name,O("font-weight:"+Ht.weight+";font-style:"+Ht.style)))}F(st.a)},x(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+g(this.c)+"/"+z+".js",function(ut){ut&&F([])})):F([])};var pi=new ee(window);pi.a.c.custom=function(F,z){return new St(z,F)},pi.a.c.fontdeck=function(F,z){return new bn(z,F)},pi.a.c.monotype=function(F,z){return new Kt(z,F)},pi.a.c.typekit=function(F,z){return new as(z,F)},pi.a.c.google=function(F,z){return new Xr(z,F)};var _n={load:i(pi.load,pi)};n.exports?n.exports=_n:(window.WebFont=_n,window.WebFontConfig&&pi.load(window.WebFontConfig))})()}(Ah)),Ah.exports}var AI=SI();const wk=Nr(AI);/*!
 * @barvynkoa/particle-emitter - v6.0.0
 * Compiled Mon, 27 May 2024 12:15:21 UTC
 *
 * @barvynkoa/particle-emitter is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */class Mc{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(!t||!t.length)this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});else if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const i=t[e];let s=i[0];for(let r=1;r<i.length;++r){const o=i[r];this.segments.push({p1:s,p2:o,l:0}),s=o}}else{let e=t[0];for(let i=1;i<t.length;++i){const s=t[i];this.segments.push({p1:e,p2:s,l:0}),e=s}}for(let e=0;e<this.segments.length;++e){const{p1:i,p2:s}=this.segments[e],r=Math.sqrt((s.x-i.x)*(s.x-i.x)+(s.y-i.y)*(s.y-i.y));this.segments[e].l=r,this.totalLength+=r,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let i,s;if(this.segments.length===1)i=this.segments[0],s=e;else for(let l=0;l<this.countingLengths.length;++l)if(e<this.countingLengths[l]){i=this.segments[l],s=l===0?e:e-this.countingLengths[l-1];break}s/=i.l||1;const{p1:r,p2:o}=i;t.x=r.x+s*(o.x-r.x),t.y=r.y+s*(o.y-r.y)}}Mc.type="polygonalChain";Mc.editorConfig=null;class Pc{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}Pc.type="rect";Pc.editorConfig=null;class ts{constructor(t,e,i){this.value=t,this.time=e,this.next=null,this.isStepped=!1,i?this.ease=typeof i=="function"?i:N0(i):this.ease=null}static createList(t){if("list"in t){const i=t.list;let s;const{value:r,time:o}=i[0],l=s=new ts(typeof r=="string"?$a(r):r,o,t.ease);if(i.length>2||i.length===2&&i[1].value!==r)for(let u=1;u<i.length;++u){const{value:c,time:f}=i[u];s.next=new ts(typeof c=="string"?$a(c):c,f),s=s.next}return l.isStepped=!!t.isStepped,l}const e=new ts(typeof t.start=="string"?$a(t.start):t.start,0);return t.end!==t.start&&(e.next=new ts(typeof t.end=="string"?$a(t.end):t.end,1)),e}}let Dr=Ot.from;const Ji=Math.PI/180;function Ss(n,t){if(!n)return;const e=Math.sin(n),i=Math.cos(n),s=t.x*i-t.y*e,r=t.x*e+t.y*i;t.x=s,t.y=r}function Mo(n,t,e){return n<<16|t<<8|e}function D0(n){return Math.sqrt(n.x*n.x+n.y*n.y)}function CI(n){const t=1/D0(n);n.x*=t,n.y*=t}function Y0(n,t){n.x*=t,n.y*=t}function $a(n,t){t||(t={}),n.charAt(0)==="#"?n=n.substr(1):n.indexOf("0x")===0&&(n=n.substr(2));let e;return n.length===8&&(e=n.substr(0,2),n=n.substr(2)),t.r=parseInt(n.substr(0,2),16),t.g=parseInt(n.substr(2,2),16),t.b=parseInt(n.substr(4,2),16),e&&(t.a=parseInt(e,16)),t}function N0(n){const t=n.length,e=1/t;return function(i){const s=t*i|0,r=(i-s*e)*t,o=n[s]||n[t-1];return o.s+r*(2*(1-r)*(o.cp-o.s)+r*(o.e-o.s))}}function TI(n){return n||"normal"}class Po{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),Ss(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}Po.type="torus";Po.editorConfig=null;var ne;(function(n){n[n.Spawn=0]="Spawn",n[n.Normal=2]="Normal",n[n.Late=5]="Late"})(ne||(ne={}));class Ic{constructor(t){this.order=ne.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=t.maxSpeed??0}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new fe(i,0),Ss(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity,s=i.x,r=i.y;if(i.x+=this.accel.x*e,i.y+=this.accel.y*e,this.maxSpeed){const o=D0(i);o>this.maxSpeed&&Y0(i,this.maxSpeed/o)}t.x+=(s+i.x)/2*e,t.y+=(r+i.y)/2*e,this.rotate&&(t.rotation=Math.atan2(i.y,i.x))}}Ic.type="moveAcceleration";Ic.editorConfig=null;function MI(n){return this.ease&&(n=this.ease(n)),(this.first.next.value-this.first.value)*n+this.first.value}function PI(n){this.ease&&(n=this.ease(n));const t=this.first.value,e=this.first.next.value,i=(e.r-t.r)*n+t.r,s=(e.g-t.g)*n+t.g,r=(e.b-t.b)*n+t.b;return Mo(i,s,r)}function II(n){this.ease&&(n=this.ease(n));let t=this.first,e=t.next;for(;n>e.time;)t=e,e=e.next;return n=(n-t.time)/(e.time-t.time),(e.value-t.value)*n+t.value}function kI(n){this.ease&&(n=this.ease(n));let t=this.first,e=t.next;for(;n>e.time;)t=e,e=e.next;n=(n-t.time)/(e.time-t.time);const i=t.value,s=e.value,r=(s.r-i.r)*n+i.r,o=(s.g-i.g)*n+i.g,l=(s.b-i.b)*n+i.b;return Mo(r,o,l)}function EI(n){this.ease&&(n=this.ease(n));let t=this.first;for(;t.next&&n>t.next.time;)t=t.next;return t.value}function RI(n){this.ease&&(n=this.ease(n));let t=this.first;for(;t.next&&n>t.next.time;)t=t.next;const e=t.value;return Mo(e.r,e.g,e.b)}class Ur{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t,t.next&&t.next.time>=1?this.interpolate=this.isColor?PI:MI:t.isStepped?this.interpolate=this.isColor?RI:EI:this.interpolate=this.isColor?kI:II,this.ease=this.first.ease}}class kc{constructor(t){this.order=ne.Normal,this.list=new Ur(!1),this.list.reset(ts.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}kc.type="alpha";kc.editorConfig=null;class Ec{constructor(t){this.order=ne.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}Ec.type="alphaStatic";Ec.editorConfig=null;function U0(n){const t=[];for(let e=0;e<n.length;++e){let i=n[e];if(typeof i=="string")t.push(Dr(i));else if(i instanceof Ot)t.push(i);else{let s=i.count||1;for(typeof i.texture=="string"?i=Dr(i.texture):i=i.texture;s>0;--s)t.push(i)}}return t}class Rc{constructor(t){this.order=ne.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const i=t.anims[e],s=U0(i.textures),r=i.framerate<0?-1:i.framerate>0?i.framerate:60,o={textures:s,duration:r>0?s.length/r:0,framerate:r,loop:r>0?!!i.loop:!1};this.anims.push(o)}}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.anims.length),s=e.config.anim=this.anims[i];e.texture=s.textures[0],e.config.animElapsed=0,s.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=s.textures.length/e.maxLife):(e.config.animDuration=s.duration,e.config.animFramerate=s.framerate),e=e.next}}updateParticle(t,e){const i=t.config,s=i.anim;i.animElapsed+=e,i.animElapsed>=i.animDuration&&(i.anim.loop?i.animElapsed=i.animElapsed%i.animDuration:i.animElapsed=i.animDuration-1e-6);const r=i.animElapsed*i.animFramerate+1e-7|0;t.texture=s.textures[r]||s.textures[s.textures.length-1]||Ot.EMPTY}}Rc.type="animatedRandom";Rc.editorConfig=null;class Fc{constructor(t){this.order=ne.Normal;const e=t.anim,i=U0(e.textures),s=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:i,duration:s>0?i.length/s:0,framerate:s,loop:s>0?!!e.loop:!1}}initParticles(t){let e=t;const i=this.anim;for(;e;)e.texture=i.textures[0],e.config.animElapsed=0,i.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=i.textures.length/e.maxLife):(e.config.animDuration=i.duration,e.config.animFramerate=i.framerate),e=e.next}updateParticle(t,e){const i=this.anim,s=t.config;s.animElapsed+=e,s.animElapsed>=s.animDuration&&(i.loop?s.animElapsed=s.animElapsed%s.animDuration:s.animElapsed=s.animDuration-1e-6);const r=s.animElapsed*s.animFramerate+1e-7|0;t.texture=i.textures[r]||i.textures[i.textures.length-1]||Ot.EMPTY}}Fc.type="animatedSingle";Fc.editorConfig=null;class Bc{constructor(t){this.order=ne.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=TI(this.value),e=e.next}}Bc.type="blendMode";Bc.editorConfig=null;class Lc{constructor(t){this.order=ne.Spawn,this.spacing=t.spacing*Ji,this.start=t.start*Ji,this.distance=t.distance}initParticles(t){let e=0,i=t;for(;i;){let s;this.spacing?s=this.start+this.spacing*e:s=Math.random()*Math.PI*2,i.rotation=s,this.distance&&(i.position.x=this.distance,Ss(s,i.position)),i=i.next,++e}}}Lc.type="spawnBurst";Lc.editorConfig=null;class Oc{constructor(t){this.order=ne.Normal,this.list=new Ur(!0),this.list.reset(ts.createList(t.color))}initParticles(t){let e=t;const i=this.list.first.value,s=Mo(i.r,i.g,i.b);for(;e;)e.tint=s,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}Oc.type="color";Oc.editorConfig=null;class Dc{constructor(t){this.order=ne.Normal;let e=t.color;e.charAt(0)==="#"?e=e.substr(1):e.indexOf("0x")===0&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}Dc.type="colorStatic";Dc.editorConfig=null;class Yc{constructor(t){this.order=ne.Normal,this.index=0,this.textures=t.textures.map(e=>typeof e=="string"?Dr(e):e)}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}Yc.type="textureOrdered";Yc.editorConfig=null;const Yn=new fe,X0=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],FI=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(X0).join("|"),"g");function BI(n){const t=n.match(FI);for(let e=t.length-1;e>=0;--e)X0.indexOf(t[e])>=0&&(t[e]=`Math.${t[e]}`);return n=t.join(""),new Function("x",`return ${n};`)}class Nc{constructor(t){if(this.order=ne.Late,t.path)if(typeof t.path=="function")this.path=t.path;else try{this.path=BI(t.path)}catch{this.path=null}else this.path=e=>e;this.list=new Ur(!1),this.list.reset(ts.createList(t.speed)),this.minMult=t.minMult??1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new fe(e.x,e.y),e.config.movement=0;const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=i*e,Yn.x=t.config.movement,Yn.y=this.path(Yn.x),Ss(t.config.initRotation,Yn),t.position.x=t.config.initPosition.x+Yn.x,t.position.y=t.config.initPosition.y+Yn.y}}Nc.type="movePath";Nc.editorConfig=null;class Uc{constructor(){this.order=ne.Spawn}initParticles(t){}}Uc.type="spawnPoint";Uc.editorConfig=null;class Xc{constructor(t){this.order=ne.Normal,this.textures=t.textures.map(e=>typeof e=="string"?Dr(e):e)}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[i],e=e.next}}}Xc.type="textureRandom";Xc.editorConfig=null;class Wc{constructor(t){this.order=ne.Normal,this.minStart=t.minStart*Ji,this.maxStart=t.maxStart*Ji,this.minSpeed=t.minSpeed*Ji,this.maxSpeed=t.maxSpeed*Ji,this.accel=t.accel*Ji}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const i=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+i)/2*e}else t.rotation+=t.config.rotSpeed*e}}Wc.type="rotation";Wc.editorConfig=null;class zc{constructor(t){this.order=ne.Normal,this.min=t.min*Ji,this.max=t.max*Ji}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}zc.type="rotationStatic";zc.editorConfig=null;class Gc{constructor(t){this.order=ne.Late+1,this.rotation=(t.rotation||0)*Ji}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}Gc.type="noRotation";Gc.editorConfig=null;class Vc{constructor(t){this.order=ne.Normal,this.list=new Ur(!1),this.list.reset(ts.createList(t.scale)),this.minMult=t.minMult??1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=i,e.scale.x=e.scale.y=this.list.first.value*i,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}Vc.type="scale";Vc.editorConfig=null;class $c{constructor(t){this.order=ne.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=i,e=e.next}}}$c.type="scaleStatic";$c.editorConfig=null;class Wi{static registerShape(t,e){Wi.shapes[e||t.type]=t}constructor(t){this.order=ne.Spawn;const e=Wi.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}Wi.type="spawnShape";Wi.editorConfig=null;Wi.shapes={};Wi.registerShape(Mc);Wi.registerShape(Pc);Wi.registerShape(Po);Wi.registerShape(Po,"circle");class Hc{constructor(t){this.order=ne.Normal,this.texture=typeof t.texture=="string"?Dr(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}Hc.type="textureSingle";Hc.editorConfig=null;class qc{constructor(t){this.order=ne.Late,this.list=new Ur(!1),this.list.reset(ts.createList(t.speed)),this.minMult=t.minMult??1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e.config.velocity?e.config.velocity.set(this.list.first.value*i,0):e.config.velocity=new fe(this.list.first.value*i,0),Ss(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult,s=t.config.velocity;CI(s),Y0(s,i),t.x+=s.x*e,t.y+=s.y*e}}qc.type="moveSpeed";qc.editorConfig=null;class jc{constructor(t){this.order=ne.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new fe(i,0),Ss(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity;t.x+=i.x*e,t.y+=i.y*e}}jc.type="moveSpeedStatic";jc.editorConfig=null;class Ch extends tr{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}const Th=bs.shared,rn=Symbol("Position particle per emitter position");class Jt{static registerBehavior(t){Jt.knownBehaviors[t.type]=t}constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new fe,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new fe,this._prevEmitterPos=new fe,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}get frequency(){return this._frequency}set frequency(t){typeof t=="number"&&t>0?this._frequency=t:this._frequency=1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase=typeof t.ease=="function"?t.ease:N0(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance=typeof t.spawnChance=="number"&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=t.emit===void 0?!0:!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map(i=>{const s=Jt.knownBehaviors[i.type];return s?new s(i.config):(console.error(`Unknown behavior: ${i.type}`),null)}).filter(i=>!!i);e.push(rn),e.sort((i,s)=>i===rn?s.order===ne.Spawn?1:-1:s===rn?i.order===ne.Spawn?-1:1:i.order-s.order),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter(i=>i!==rn&&i.updateParticle),this.recycleBehaviors=e.filter(i=>i!==rn&&i.recycleParticle)}getBehavior(t){return Jt.knownBehaviors[t]&&this.initBehaviors.find(e=>e instanceof Jt.knownBehaviors[t])||null}fillPool(t){for(;t>0;--t){const e=new Ch(this);e.next=this._poolFirst,this._poolFirst=e}}recycle(t,e=!1){for(let i=0;i<this.recycleBehaviors.length;++i)this.recycleBehaviors[i].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,Ss(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?Th.remove(this.update,this):!this._autoUpdate&&t&&Th.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(typeof t!="number"&&(t=t.deltaTime),this._autoUpdate&&(t=Th.elapsedMS*.001),!this._parent)return;for(let o=this._activeParticlesFirst,l;o;o=l)if(l=o.next,o.age+=t,o.age>o.maxLife||o.age<0)this.recycle(o);else{let u=o.age*o.oneOverLife;this.customEase&&(this.customEase.length===4?u=this.customEase(u,0,1,1):u=this.customEase(u)),o.agePercent=u;for(let c=0;c<this.updateBehaviors.length;++c)if(this.updateBehaviors[c].updateParticle(o,t)){this.recycle(o);break}}let e,i;this._prevPosIsValid&&(e=this._prevEmitterPos.x,i=this._prevEmitterPos.y);const s=this.ownerPos.x+this.spawnPos.x,r=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let o,l;if(this._prevPosIsValid&&this._posChanged){const f=1+this._spawnTimer/t;o=(s-e)*f+e,l=(r-i)*f+i}else o=s,l=r;let u=null,c=null;for(let f=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),d=0;d<f;++d){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let g;if(this.minLifetime===this.maxLifetime?g=this.minLifetime:g=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=g)continue;let p;this._poolFirst?(p=this._poolFirst,this._poolFirst=this._poolFirst.next,p.next=null):p=new Ch(this),p.init(g),this.addAtBack?this._parent.addChildAt(p,0):this._parent.addChild(p),u?(c.next=p,p.prev=c,c=p):c=u=p,++this.particleCount}if(u){this._activeParticlesLast?(this._activeParticlesLast.next=u,u.prev=this._activeParticlesLast,this._activeParticlesLast=c):(this._activeParticlesFirst=u,this._activeParticlesLast=c);for(let f=0;f<this.initBehaviors.length;++f){const d=this.initBehaviors[f];if(d===rn)for(let g=u,p;g;g=p){p=g.next,this.rotation!==0&&(Ss(this.rotation,g.position),g.rotation+=this.rotation),g.position.x+=o,g.position.y+=l,g.age+=-this._spawnTimer;let x=g.age*g.oneOverLife;this.customEase&&(this.customEase.length===4?x=this.customEase(x,0,1,1):x=this.customEase(x)),g.agePercent=x}else d.initParticles(u)}for(let f=u,d;f;f=d){d=f.next;for(let g=0;g<this.updateBehaviors.length;++g)if(this.updateBehaviors[g].updateParticle(f,-this._spawnTimer)){this.recycle(f);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=s,this._prevEmitterPos.y=r,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const o=this._completeCallback;this._completeCallback=null,o()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let i=null,s=null;for(let r=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),o=0;o<r;++o){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let l;this._poolFirst?(l=this._poolFirst,this._poolFirst=this._poolFirst.next,l.next=null):l=new Ch(this);let u;this.minLifetime===this.maxLifetime?u=this.minLifetime:u=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,l.init(u),this.addAtBack?this._parent.addChildAt(l,0):this._parent.addChild(l),i?(s.next=l,l.prev=s,s=l):s=i=l,++this.particleCount}if(i){this._activeParticlesLast?(this._activeParticlesLast.next=i,i.prev=this._activeParticlesLast,this._activeParticlesLast=s):(this._activeParticlesFirst=i,this._activeParticlesLast=s);for(let r=0;r<this.initBehaviors.length;++r){const o=this.initBehaviors[r];if(o===rn)for(let l=i,u;l;l=u)u=l.next,this.rotation!==0&&(Ss(this.rotation,l.position),l.rotation+=this.rotation),l.position.x+=t,l.position.y+=e;else o.initParticles(i)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){this.autoUpdate=!1,this.cleanup();let t;for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}Jt.knownBehaviors={};function vk(n,t){var i,s,r,o,l,u,c,f,d,g,p;if("behaviors"in n)return n;const e={lifetime:n.lifetime,ease:n.ease,particlesPerWave:n.particlesPerWave,frequency:n.frequency,spawnChance:n.spawnChance,emitterLifetime:n.emitterLifetime,maxParticles:n.maxParticles,addAtBack:n.addAtBack,pos:n.pos,emit:n.emit,autoUpdate:n.autoUpdate,behaviors:[]};if(n.alpha)if("start"in n.alpha)if(n.alpha.start===n.alpha.end)n.alpha.start!==1&&e.behaviors.push({type:"alphaStatic",config:{alpha:n.alpha.start}});else{const x={list:[{time:0,value:n.alpha.start},{time:1,value:n.alpha.end}]};e.behaviors.push({type:"alpha",config:{alpha:x}})}else n.alpha.list.length===1?n.alpha.list[0].value!==1&&e.behaviors.push({type:"alphaStatic",config:{alpha:n.alpha.list[0].value}}):e.behaviors.push({type:"alpha",config:{alpha:n.alpha}});if(n.acceleration&&(n.acceleration.x||n.acceleration.y)){let x,y;"start"in n.speed?(x=n.speed.start*(n.speed.minimumSpeedMultiplier??1),y=n.speed.start):(x=n.speed.list[0].value*(n.minimumSpeedMultiplier??1),y=n.speed.list[0].value),e.behaviors.push({type:"moveAcceleration",config:{accel:n.acceleration,minStart:x,maxStart:y,rotate:!n.noRotation,maxSpeed:n.maxSpeed}})}else if((i=n.extraData)!=null&&i.path){let x,y;"start"in n.speed?(y=n.speed.minimumSpeedMultiplier??1,n.speed.start===n.speed.end?x={list:[{time:0,value:n.speed.start}]}:x={list:[{time:0,value:n.speed.start},{time:1,value:n.speed.end}]}):(x=n.speed,y=n.minimumSpeedMultiplier??1),e.behaviors.push({type:"movePath",config:{path:n.extraData.path,speed:x,minMult:y}})}else if(n.speed)if("start"in n.speed)if(n.speed.start===n.speed.end)e.behaviors.push({type:"moveSpeedStatic",config:{min:n.speed.start*(n.speed.minimumSpeedMultiplier??1),max:n.speed.start}});else{const x={list:[{time:0,value:n.speed.start},{time:1,value:n.speed.end}]};e.behaviors.push({type:"moveSpeed",config:{speed:x,minMult:n.speed.minimumSpeedMultiplier}})}else n.speed.list.length===1?e.behaviors.push({type:"moveSpeedStatic",config:{min:n.speed.list[0].value*(n.minimumSpeedMultiplier??1),max:n.speed.list[0].value}}):e.behaviors.push({type:"moveSpeed",config:{speed:n.speed,minMult:n.minimumSpeedMultiplier??1}});if(n.scale)if("start"in n.scale){const x=n.scale.minimumScaleMultiplier??1;if(n.scale.start===n.scale.end)e.behaviors.push({type:"scaleStatic",config:{min:n.scale.start*x,max:n.scale.start}});else{const y={list:[{time:0,value:n.scale.start},{time:1,value:n.scale.end}]};e.behaviors.push({type:"scale",config:{scale:y,minMult:x}})}}else if(n.scale.list.length===1){const x=n.minimumScaleMultiplier??1,y=n.scale.list[0].value;e.behaviors.push({type:"scaleStatic",config:{min:y*x,max:y}})}else e.behaviors.push({type:"scale",config:{scale:n.scale,minMult:n.minimumScaleMultiplier??1}});if(n.color)if("start"in n.color)if(n.color.start===n.color.end)n.color.start!=="ffffff"&&e.behaviors.push({type:"colorStatic",config:{color:n.color.start}});else{const x={list:[{time:0,value:n.color.start},{time:1,value:n.color.end}]};e.behaviors.push({type:"color",config:{color:x}})}else n.color.list.length===1?n.color.list[0].value!=="ffffff"&&e.behaviors.push({type:"colorStatic",config:{color:n.color.list[0].value}}):e.behaviors.push({type:"color",config:{color:n.color}});if(n.rotationAcceleration||(s=n.rotationSpeed)!=null&&s.min||(r=n.rotationSpeed)!=null&&r.max?e.behaviors.push({type:"rotation",config:{accel:n.rotationAcceleration||0,minSpeed:((o=n.rotationSpeed)==null?void 0:o.min)||0,maxSpeed:((l=n.rotationSpeed)==null?void 0:l.max)||0,minStart:((u=n.startRotation)==null?void 0:u.min)||0,maxStart:((c=n.startRotation)==null?void 0:c.max)||0}}):((f=n.startRotation)!=null&&f.min||(d=n.startRotation)!=null&&d.max)&&e.behaviors.push({type:"rotationStatic",config:{min:((g=n.startRotation)==null?void 0:g.min)||0,max:((p=n.startRotation)==null?void 0:p.max)||0}}),n.noRotation&&e.behaviors.push({type:"noRotation",config:{}}),n.blendMode&&n.blendMode!=="normal"&&e.behaviors.push({type:"blendMode",config:{blendMode:n.blendMode}}),Array.isArray(t)&&typeof t[0]!="string"&&"framerate"in t[0]){for(let x=0;x<t.length;++x)t[x].framerate==="matchLife"&&(t[x].framerate=-1);e.behaviors.push({type:"animatedRandom",config:{anims:t}})}else typeof t!="string"&&"framerate"in t?(t.framerate==="matchLife"&&(t.framerate=-1),e.behaviors.push({type:"animatedSingle",config:{anim:t}})):n.orderedArt&&Array.isArray(t)?e.behaviors.push({type:"textureOrdered",config:{textures:t}}):Array.isArray(t)?e.behaviors.push({type:"textureRandom",config:{textures:t}}):e.behaviors.push({type:"textureSingle",config:{texture:t}});if(n.spawnType==="burst")e.behaviors.push({type:"spawnBurst",config:{start:n.angleStart||0,spacing:n.particleSpacing,distance:0}});else if(n.spawnType==="point")e.behaviors.push({type:"spawnPoint",config:{}});else{let x;n.spawnType==="ring"?x={type:"torus",data:{x:n.spawnCircle.x,y:n.spawnCircle.y,radius:n.spawnCircle.r,innerRadius:n.spawnCircle.minR,affectRotation:!0}}:n.spawnType==="circle"?x={type:"torus",data:{x:n.spawnCircle.x,y:n.spawnCircle.y,radius:n.spawnCircle.r,innerRadius:0,affectRotation:!1}}:n.spawnType==="rect"?x={type:"rect",data:n.spawnRect}:n.spawnType==="polygonalChain"&&(x={type:"polygonalChain",data:n.spawnPolygon}),x&&e.behaviors.push({type:"spawnShape",config:x})}return e}Jt.registerBehavior(Ic);Jt.registerBehavior(kc);Jt.registerBehavior(Ec);Jt.registerBehavior(Rc);Jt.registerBehavior(Fc);Jt.registerBehavior(Bc);Jt.registerBehavior(Lc);Jt.registerBehavior(Oc);Jt.registerBehavior(Dc);Jt.registerBehavior(Yc);Jt.registerBehavior(Nc);Jt.registerBehavior(Uc);Jt.registerBehavior(Xc);Jt.registerBehavior(Wc);Jt.registerBehavior(zc);Jt.registerBehavior(Gc);Jt.registerBehavior(Vc);Jt.registerBehavior($c);Jt.registerBehavior(Wi);Jt.registerBehavior(Hc);Jt.registerBehavior(qc);Jt.registerBehavior(jc);export{rp as $,EA as A,Re as B,sr as C,ve as D,_t as E,_g as F,vg as G,Ag as H,Tg as I,ug as J,vo as K,Ot as L,nk as M,wo as N,rg as O,fe as P,xC as Q,Wh as R,z2 as S,bs as T,Nh as U,mT as V,_s as W,Om as X,Ui as Y,qC as Z,gk as _,is as a,hk as a$,tr as a0,y2 as a1,Se as a2,Ve as a3,op as a4,ih as a5,hp as a6,ZC as a7,Be as a8,Nm as a9,tk as aA,dk as aB,Fd as aC,WI as aD,ZI as aE,JI as aF,ek as aG,tA as aH,zl as aI,fc as aJ,di as aK,Fr as aL,$p as aM,Kp as aN,wk as aO,Vn as aP,PP as aQ,hI as aR,SP as aS,ro as aT,ec as aU,Jt as aV,vk as aW,pA as aX,lk as aY,Bd as aZ,qI as a_,jt as aa,le as ab,xg as ac,wg as ad,Sg as ae,Cg as af,Mg as ag,Pg as ah,dA as ai,UI as aj,ka as ak,Qa as al,ys as am,nA as an,fk as ao,QS as ap,sk as aq,BA as ar,QA as as,mk as at,$I as au,pk as av,Ws as aw,ik as ax,KI as ay,QI as az,gm as b,ak as b0,zI as b1,GI as b2,Ra as b3,Ld as b4,ok as b5,mA as b6,ji as b7,TC as b8,MC as b9,cM as ba,Rg as bb,wp as bc,_p as bd,gC as be,gM as bf,he as bg,yC as bh,eo as bi,jh as bj,qp as bk,Lg as bl,R2 as bm,P2 as bn,rk as c,VI as d,Fe as e,XI as f,Mi as g,HI as h,ac as i,jI as j,kh as k,uk as l,U2 as m,Gh as n,gn as o,Ka as p,dc as q,EC as r,Ds as s,oA as t,jm as u,Pi as v,ge as w,hg as x,Vp as y,Vt as z};
